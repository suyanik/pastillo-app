(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function mT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Vp={exports:{}},ou={},Lp={exports:{}},Ge={};var U_;function OC(){if(U_)return Ge;U_=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.iterator;function E(z){return z===null||typeof z!="object"?null:(z=v&&z[v]||z["@@iterator"],typeof z=="function"?z:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,M={};function k(z,ne,ke){this.props=z,this.context=ne,this.refs=M,this.updater=ke||S}k.prototype.isReactComponent={},k.prototype.setState=function(z,ne){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ne,"setState")},k.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function B(){}B.prototype=k.prototype;function q(z,ne,ke){this.props=z,this.context=ne,this.refs=M,this.updater=ke||S}var H=q.prototype=new B;H.constructor=q,N(H,k.prototype),H.isPureReactComponent=!0;var ee=Array.isArray,te=Object.prototype.hasOwnProperty,j={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function R(z,ne,ke){var De,Oe={},Be=null,We=null;if(ne!=null)for(De in ne.ref!==void 0&&(We=ne.ref),ne.key!==void 0&&(Be=""+ne.key),ne)te.call(ne,De)&&!b.hasOwnProperty(De)&&(Oe[De]=ne[De]);var He=arguments.length-2;if(He===1)Oe.children=ke;else if(1<He){for(var tt=Array(He),ae=0;ae<He;ae++)tt[ae]=arguments[ae+2];Oe.children=tt}if(z&&z.defaultProps)for(De in He=z.defaultProps,He)Oe[De]===void 0&&(Oe[De]=He[De]);return{$$typeof:n,type:z,key:Be,ref:We,props:Oe,_owner:j.current}}function P(z,ne){return{$$typeof:n,type:z.type,key:ne,ref:z.ref,props:z.props,_owner:z._owner}}function L(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function F(z){var ne={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(ke){return ne[ke]})}var G=/\/+/g;function D(z,ne){return typeof z=="object"&&z!==null&&z.key!=null?F(""+z.key):ne.toString(36)}function Fe(z,ne,ke,De,Oe){var Be=typeof z;(Be==="undefined"||Be==="boolean")&&(z=null);var We=!1;if(z===null)We=!0;else switch(Be){case"string":case"number":We=!0;break;case"object":switch(z.$$typeof){case n:case e:We=!0}}if(We)return We=z,Oe=Oe(We),z=De===""?"."+D(We,0):De,ee(Oe)?(ke="",z!=null&&(ke=z.replace(G,"$&/")+"/"),Fe(Oe,ne,ke,"",function(ae){return ae})):Oe!=null&&(L(Oe)&&(Oe=P(Oe,ke+(!Oe.key||We&&We.key===Oe.key?"":(""+Oe.key).replace(G,"$&/")+"/")+z)),ne.push(Oe)),1;if(We=0,De=De===""?".":De+":",ee(z))for(var He=0;He<z.length;He++){Be=z[He];var tt=De+D(Be,He);We+=Fe(Be,ne,ke,tt,Oe)}else if(tt=E(z),typeof tt=="function")for(z=tt.call(z),He=0;!(Be=z.next()).done;)Be=Be.value,tt=De+D(Be,He++),We+=Fe(Be,ne,ke,tt,Oe);else if(Be==="object")throw ne=String(z),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return We}function Z(z,ne,ke){if(z==null)return z;var De=[],Oe=0;return Fe(z,De,"","",function(Be){return ne.call(ke,Be,Oe++)}),De}function fe(z){if(z._status===-1){var ne=z._result;ne=ne(),ne.then(function(ke){(z._status===0||z._status===-1)&&(z._status=1,z._result=ke)},function(ke){(z._status===0||z._status===-1)&&(z._status=2,z._result=ke)}),z._status===-1&&(z._status=0,z._result=ne)}if(z._status===1)return z._result.default;throw z._result}var Ie={current:null},ce={transition:null},Ce={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:ce,ReactCurrentOwner:j};function ge(){throw Error("act(...) is not supported in production builds of React.")}return Ge.Children={map:Z,forEach:function(z,ne,ke){Z(z,function(){ne.apply(this,arguments)},ke)},count:function(z){var ne=0;return Z(z,function(){ne++}),ne},toArray:function(z){return Z(z,function(ne){return ne})||[]},only:function(z){if(!L(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Ge.Component=k,Ge.Fragment=t,Ge.Profiler=i,Ge.PureComponent=q,Ge.StrictMode=r,Ge.Suspense=d,Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ce,Ge.act=ge,Ge.cloneElement=function(z,ne,ke){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var De=N({},z.props),Oe=z.key,Be=z.ref,We=z._owner;if(ne!=null){if(ne.ref!==void 0&&(Be=ne.ref,We=j.current),ne.key!==void 0&&(Oe=""+ne.key),z.type&&z.type.defaultProps)var He=z.type.defaultProps;for(tt in ne)te.call(ne,tt)&&!b.hasOwnProperty(tt)&&(De[tt]=ne[tt]===void 0&&He!==void 0?He[tt]:ne[tt])}var tt=arguments.length-2;if(tt===1)De.children=ke;else if(1<tt){He=Array(tt);for(var ae=0;ae<tt;ae++)He[ae]=arguments[ae+2];De.children=He}return{$$typeof:n,type:z.type,key:Oe,ref:Be,props:De,_owner:We}},Ge.createContext=function(z){return z={$$typeof:l,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:o,_context:z},z.Consumer=z},Ge.createElement=R,Ge.createFactory=function(z){var ne=R.bind(null,z);return ne.type=z,ne},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(z){return{$$typeof:u,render:z}},Ge.isValidElement=L,Ge.lazy=function(z){return{$$typeof:y,_payload:{_status:-1,_result:z},_init:fe}},Ge.memo=function(z,ne){return{$$typeof:f,type:z,compare:ne===void 0?null:ne}},Ge.startTransition=function(z){var ne=ce.transition;ce.transition={};try{z()}finally{ce.transition=ne}},Ge.unstable_act=ge,Ge.useCallback=function(z,ne){return Ie.current.useCallback(z,ne)},Ge.useContext=function(z){return Ie.current.useContext(z)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(z){return Ie.current.useDeferredValue(z)},Ge.useEffect=function(z,ne){return Ie.current.useEffect(z,ne)},Ge.useId=function(){return Ie.current.useId()},Ge.useImperativeHandle=function(z,ne,ke){return Ie.current.useImperativeHandle(z,ne,ke)},Ge.useInsertionEffect=function(z,ne){return Ie.current.useInsertionEffect(z,ne)},Ge.useLayoutEffect=function(z,ne){return Ie.current.useLayoutEffect(z,ne)},Ge.useMemo=function(z,ne){return Ie.current.useMemo(z,ne)},Ge.useReducer=function(z,ne,ke){return Ie.current.useReducer(z,ne,ke)},Ge.useRef=function(z){return Ie.current.useRef(z)},Ge.useState=function(z){return Ie.current.useState(z)},Ge.useSyncExternalStore=function(z,ne,ke){return Ie.current.useSyncExternalStore(z,ne,ke)},Ge.useTransition=function(){return Ie.current.useTransition()},Ge.version="18.3.1",Ge}var O_;function Xm(){return O_||(O_=1,Lp.exports=OC()),Lp.exports}var B_;function BC(){if(B_)return ou;B_=1;var n=Xm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var y,v={},E=null,S=null;f!==void 0&&(E=""+f),d.key!==void 0&&(E=""+d.key),d.ref!==void 0&&(S=d.ref);for(y in d)r.call(d,y)&&!o.hasOwnProperty(y)&&(v[y]=d[y]);if(u&&u.defaultProps)for(y in d=u.defaultProps,d)v[y]===void 0&&(v[y]=d[y]);return{$$typeof:e,type:u,key:E,ref:S,props:v,_owner:i.current}}return ou.Fragment=t,ou.jsx=l,ou.jsxs=l,ou}var G_;function GC(){return G_||(G_=1,Vp.exports=BC()),Vp.exports}var w=GC(),_e=Xm();const gT=mT(_e);var Rd={},Fp={exports:{}},Sn={},Up={exports:{}},Op={};var q_;function qC(){return q_||(q_=1,(function(n){function e(ce,Ce){var ge=ce.length;ce.push(Ce);e:for(;0<ge;){var z=ge-1>>>1,ne=ce[z];if(0<i(ne,Ce))ce[z]=Ce,ce[ge]=ne,ge=z;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Ce=ce[0],ge=ce.pop();if(ge!==Ce){ce[0]=ge;e:for(var z=0,ne=ce.length,ke=ne>>>1;z<ke;){var De=2*(z+1)-1,Oe=ce[De],Be=De+1,We=ce[Be];if(0>i(Oe,ge))Be<ne&&0>i(We,Oe)?(ce[z]=We,ce[Be]=ge,z=Be):(ce[z]=Oe,ce[De]=ge,z=De);else if(Be<ne&&0>i(We,ge))ce[z]=We,ce[Be]=ge,z=Be;else break e}}return Ce}function i(ce,Ce){var ge=ce.sortIndex-Ce.sortIndex;return ge!==0?ge:ce.id-Ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var d=[],f=[],y=1,v=null,E=3,S=!1,N=!1,M=!1,k=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(ce){for(var Ce=t(f);Ce!==null;){if(Ce.callback===null)r(f);else if(Ce.startTime<=ce)r(f),Ce.sortIndex=Ce.expirationTime,e(d,Ce);else break;Ce=t(f)}}function ee(ce){if(M=!1,H(ce),!N)if(t(d)!==null)N=!0,fe(te);else{var Ce=t(f);Ce!==null&&Ie(ee,Ce.startTime-ce)}}function te(ce,Ce){N=!1,M&&(M=!1,B(R),R=-1),S=!0;var ge=E;try{for(H(Ce),v=t(d);v!==null&&(!(v.expirationTime>Ce)||ce&&!F());){var z=v.callback;if(typeof z=="function"){v.callback=null,E=v.priorityLevel;var ne=z(v.expirationTime<=Ce);Ce=n.unstable_now(),typeof ne=="function"?v.callback=ne:v===t(d)&&r(d),H(Ce)}else r(d);v=t(d)}if(v!==null)var ke=!0;else{var De=t(f);De!==null&&Ie(ee,De.startTime-Ce),ke=!1}return ke}finally{v=null,E=ge,S=!1}}var j=!1,b=null,R=-1,P=5,L=-1;function F(){return!(n.unstable_now()-L<P)}function G(){if(b!==null){var ce=n.unstable_now();L=ce;var Ce=!0;try{Ce=b(!0,ce)}finally{Ce?D():(j=!1,b=null)}}else j=!1}var D;if(typeof q=="function")D=function(){q(G)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,Z=Fe.port2;Fe.port1.onmessage=G,D=function(){Z.postMessage(null)}}else D=function(){k(G,0)};function fe(ce){b=ce,j||(j=!0,D())}function Ie(ce,Ce){R=k(function(){ce(n.unstable_now())},Ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){N||S||(N=!0,fe(te))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ce){switch(E){case 1:case 2:case 3:var Ce=3;break;default:Ce=E}var ge=E;E=Ce;try{return ce()}finally{E=ge}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Ce){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var ge=E;E=ce;try{return Ce()}finally{E=ge}},n.unstable_scheduleCallback=function(ce,Ce,ge){var z=n.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?z+ge:z):ge=z,ce){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=ge+ne,ce={id:y++,callback:Ce,priorityLevel:ce,startTime:ge,expirationTime:ne,sortIndex:-1},ge>z?(ce.sortIndex=ge,e(f,ce),t(d)===null&&ce===t(f)&&(M?(B(R),R=-1):M=!0,Ie(ee,ge-z))):(ce.sortIndex=ne,e(d,ce),N||S||(N=!0,fe(te))),ce},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(ce){var Ce=E;return function(){var ge=E;E=Ce;try{return ce.apply(this,arguments)}finally{E=ge}}}})(Op)),Op}var z_;function zC(){return z_||(z_=1,Up.exports=qC()),Up.exports}var H_;function HC(){if(H_)return Sn;H_=1;var n=Xm(),e=zC();function t(s){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(s,a){l(s,a),l(s+"Capture",a)}function l(s,a){for(i[s]=a,s=0;s<a.length;s++)r.add(a[s])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},v={};function E(s){return d.call(v,s)?!0:d.call(y,s)?!1:f.test(s)?v[s]=!0:(y[s]=!0,!1)}function S(s,a,c,g){if(c!==null&&c.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return g?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function N(s,a,c,g){if(a===null||typeof a>"u"||S(s,a,c,g))return!0;if(g)return!1;if(c!==null)switch(c.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function M(s,a,c,g,_,T,A){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=c,this.propertyName=s,this.type=a,this.sanitizeURL=T,this.removeEmptyString=A}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new M(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var a=s[0];k[a]=new M(a,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new M(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new M(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new M(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new M(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new M(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new M(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new M(s,5,!1,s.toLowerCase(),null,!1,!1)});var B=/[\-:]([a-z])/g;function q(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var a=s.replace(B,q);k[a]=new M(a,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var a=s.replace(B,q);k[a]=new M(a,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var a=s.replace(B,q);k[a]=new M(a,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new M(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new M("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new M(s,1,!1,s.toLowerCase(),null,!0,!0)});function H(s,a,c,g){var _=k.hasOwnProperty(a)?k[a]:null;(_!==null?_.type!==0:g||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(N(a,c,_,g)&&(c=null),g||_===null?E(a)&&(c===null?s.removeAttribute(a):s.setAttribute(a,""+c)):_.mustUseProperty?s[_.propertyName]=c===null?_.type===3?!1:"":c:(a=_.attributeName,g=_.attributeNamespace,c===null?s.removeAttribute(a):(_=_.type,c=_===3||_===4&&c===!0?"":""+c,g?s.setAttributeNS(g,a,c):s.setAttribute(a,c))))}var ee=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),j=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),F=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),Fe=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),Ie=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Ce(s){return s===null||typeof s!="object"?null:(s=ce&&s[ce]||s["@@iterator"],typeof s=="function"?s:null)}var ge=Object.assign,z;function ne(s){if(z===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);z=a&&a[1]||""}return`
`+z+s}var ke=!1;function De(s,a){if(!s||ke)return"";ke=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Q){var g=Q}Reflect.construct(s,[],a)}else{try{a.call()}catch(Q){g=Q}s.call(a.prototype)}else{try{throw Error()}catch(Q){g=Q}s()}}catch(Q){if(Q&&g&&typeof Q.stack=="string"){for(var _=Q.stack.split(`
`),T=g.stack.split(`
`),A=_.length-1,V=T.length-1;1<=A&&0<=V&&_[A]!==T[V];)V--;for(;1<=A&&0<=V;A--,V--)if(_[A]!==T[V]){if(A!==1||V!==1)do if(A--,V--,0>V||_[A]!==T[V]){var U=`
`+_[A].replace(" at new "," at ");return s.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",s.displayName)),U}while(1<=A&&0<=V);break}}}finally{ke=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?ne(s):""}function Oe(s){switch(s.tag){case 5:return ne(s.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return s=De(s.type,!1),s;case 11:return s=De(s.type.render,!1),s;case 1:return s=De(s.type,!0),s;default:return""}}function Be(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case j:return"Portal";case P:return"Profiler";case R:return"StrictMode";case D:return"Suspense";case Fe:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case F:return(s.displayName||"Context")+".Consumer";case L:return(s._context.displayName||"Context")+".Provider";case G:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Z:return a=s.displayName||null,a!==null?a:Be(s.type)||"Memo";case fe:a=s._payload,s=s._init;try{return Be(s(a))}catch{}}return null}function We(s){var a=s.type;switch(s.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=a.render,s=s.displayName||s.name||"",a.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Be(a);case 8:return a===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function He(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function tt(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ae(s){var a=tt(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),g=""+s[a];if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var _=c.get,T=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return _.call(this)},set:function(A){g=""+A,T.call(this,A)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return g},setValue:function(A){g=""+A},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function je(s){s._valueTracker||(s._valueTracker=ae(s))}function Pt(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var c=a.getValue(),g="";return s&&(g=tt(s)?s.checked?"true":"false":s.value),s=g,s!==c?(a.setValue(s),!0):!1}function Bt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Nn(s,a){var c=a.checked;return ge({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function Hr(s,a){var c=a.defaultValue==null?"":a.defaultValue,g=a.checked!=null?a.checked:a.defaultChecked;c=He(a.value!=null?a.value:c),s._wrapperState={initialChecked:g,initialValue:c,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Ti(s,a){a=a.checked,a!=null&&H(s,"checked",a,!1)}function $r(s,a){Ti(s,a);var c=He(a.value),g=a.type;if(c!=null)g==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(g==="submit"||g==="reset"){s.removeAttribute("value");return}a.hasOwnProperty("value")?kt(s,a.type,c):a.hasOwnProperty("defaultValue")&&kt(s,a.type,He(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(s.defaultChecked=!!a.defaultChecked)}function Ss(s,a,c){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var g=a.type;if(!(g!=="submit"&&g!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+s._wrapperState.initialValue,c||a===s.value||(s.value=a),s.defaultValue=a}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function kt(s,a,c){(a!=="number"||Bt(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var xt=Array.isArray;function tr(s,a,c,g){if(s=s.options,a){a={};for(var _=0;_<c.length;_++)a["$"+c[_]]=!0;for(c=0;c<s.length;c++)_=a.hasOwnProperty("$"+s[c].value),s[c].selected!==_&&(s[c].selected=_),_&&g&&(s[c].defaultSelected=!0)}else{for(c=""+He(c),a=null,_=0;_<s.length;_++){if(s[_].value===c){s[_].selected=!0,g&&(s[_].defaultSelected=!0);return}a!==null||s[_].disabled||(a=s[_])}a!==null&&(a.selected=!0)}}function pl(s,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return ge({},a,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ml(s,a){var c=a.value;if(c==null){if(c=a.children,a=a.defaultValue,c!=null){if(a!=null)throw Error(t(92));if(xt(c)){if(1<c.length)throw Error(t(93));c=c[0]}a=c}a==null&&(a=""),c=a}s._wrapperState={initialValue:He(c)}}function pc(s,a){var c=He(a.value),g=He(a.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),a.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),g!=null&&(s.defaultValue=""+g)}function xi(s){var a=s.textContent;a===s._wrapperState.initialValue&&a!==""&&a!==null&&(s.value=a)}function gl(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function No(s,a){return s==null||s==="http://www.w3.org/1999/xhtml"?gl(a):s==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Ii,mc=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,g,_){MSApp.execUnsafeLocalFunction(function(){return s(a,c,g,_)})}:s})(function(s,a){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=a;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Ii.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;a.firstChild;)s.appendChild(a.firstChild)}});function As(s,a){if(a){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=a;return}}s.textContent=a}var Si={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gc=["Webkit","ms","Moz","O"];Object.keys(Si).forEach(function(s){gc.forEach(function(a){a=a+s.charAt(0).toUpperCase()+s.substring(1),Si[a]=Si[s]})});function Ai(s,a,c){return a==null||typeof a=="boolean"||a===""?"":c||typeof a!="number"||a===0||Si.hasOwnProperty(s)&&Si[s]?(""+a).trim():a+"px"}function Po(s,a){s=s.style;for(var c in a)if(a.hasOwnProperty(c)){var g=c.indexOf("--")===0,_=Ai(c,a[c],g);c==="float"&&(c="cssFloat"),g?s.setProperty(c,_):s[c]=_}}var yl=ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nr(s,a){if(a){if(yl[s]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function ko(s,a){if(s.indexOf("-")===-1)return typeof a.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ci=null;function bo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Kr=null,Wr=null,wt=null;function vl(s){if(s=$l(s)){if(typeof Kr!="function")throw Error(t(280));var a=s.stateNode;a&&(a=zc(a),Kr(s.stateNode,s.type,a))}}function Ri(s){Wr?wt?wt.push(s):wt=[s]:Wr=s}function Ni(){if(Wr){var s=Wr,a=wt;if(wt=Wr=null,vl(s),a)for(s=0;s<a.length;s++)vl(a[s])}}function yc(s,a){return s(a)}function vc(){}var yr=!1;function _c(s,a,c){if(yr)return s(a,c);yr=!0;try{return yc(s,a,c)}finally{yr=!1,(Wr!==null||wt!==null)&&(vc(),Ni())}}function Cs(s,a){var c=s.stateNode;if(c===null)return null;var g=zc(c);if(g===null)return null;c=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(t(231,a,typeof c));return c}var Pi=!1;if(u)try{var ki={};Object.defineProperty(ki,"passive",{get:function(){Pi=!0}}),window.addEventListener("test",ki,ki),window.removeEventListener("test",ki,ki)}catch{Pi=!1}function wc(s,a,c,g,_,T,A,V,U){var Q=Array.prototype.slice.call(arguments,3);try{a.apply(c,Q)}catch(oe){this.onError(oe)}}var jr=!1,vr=null,Do=!1,qn=null,Ec={onError:function(s){jr=!0,vr=s}};function Tc(s,a,c,g,_,T,A,V,U){jr=!1,vr=null,wc.apply(Ec,arguments)}function _l(s,a,c,g,_,T,A,V,U){if(Tc.apply(this,arguments),jr){if(jr){var Q=vr;jr=!1,vr=null}else throw Error(t(198));Do||(Do=!0,qn=Q)}}function rr(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function wl(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function xc(s){if(rr(s)!==s)throw Error(t(188))}function Ic(s){var a=s.alternate;if(!a){if(a=rr(s),a===null)throw Error(t(188));return a!==s?null:s}for(var c=s,g=a;;){var _=c.return;if(_===null)break;var T=_.alternate;if(T===null){if(g=_.return,g!==null){c=g;continue}break}if(_.child===T.child){for(T=_.child;T;){if(T===c)return xc(_),s;if(T===g)return xc(_),a;T=T.sibling}throw Error(t(188))}if(c.return!==g.return)c=_,g=T;else{for(var A=!1,V=_.child;V;){if(V===c){A=!0,c=_,g=T;break}if(V===g){A=!0,g=_,c=T;break}V=V.sibling}if(!A){for(V=T.child;V;){if(V===c){A=!0,c=T,g=_;break}if(V===g){A=!0,g=T,c=_;break}V=V.sibling}if(!A)throw Error(t(189))}}if(c.alternate!==g)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?s:a}function Sc(s){return s=Ic(s),s!==null?Rs(s):null}function Rs(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var a=Rs(s);if(a!==null)return a;s=s.sibling}return null}var El=e.unstable_scheduleCallback,Mo=e.unstable_cancelCallback,Ns=e.unstable_shouldYield,Jr=e.unstable_requestPaint,ct=e.unstable_now,hf=e.unstable_getCurrentPriorityLevel,Vo=e.unstable_ImmediatePriority,Tl=e.unstable_UserBlockingPriority,Ps=e.unstable_NormalPriority,xl=e.unstable_LowPriority,Lo=e.unstable_IdlePriority,ks=null,Pn=null;function Ac(s){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(ks,s,void 0,(s.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:bs,_r=Math.log,zn=Math.LN2;function bs(s){return s>>>=0,s===0?32:31-(_r(s)/zn|0)|0}var wr=64,bi=4194304;function et(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Qr(s,a){var c=s.pendingLanes;if(c===0)return 0;var g=0,_=s.suspendedLanes,T=s.pingedLanes,A=c&268435455;if(A!==0){var V=A&~_;V!==0?g=et(V):(T&=A,T!==0&&(g=et(T)))}else A=c&~_,A!==0?g=et(A):T!==0&&(g=et(T));if(g===0)return 0;if(a!==0&&a!==g&&(a&_)===0&&(_=g&-g,T=a&-a,_>=T||_===16&&(T&4194240)!==0))return a;if((g&4)!==0&&(g|=c&16),a=s.entangledLanes,a!==0)for(s=s.entanglements,a&=g;0<a;)c=31-kn(a),_=1<<c,g|=s[c],a&=~_;return g}function Ds(s,a){switch(s){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ms(s,a){for(var c=s.suspendedLanes,g=s.pingedLanes,_=s.expirationTimes,T=s.pendingLanes;0<T;){var A=31-kn(T),V=1<<A,U=_[A];U===-1?((V&c)===0||(V&g)!==0)&&(_[A]=Ds(V,a)):U<=a&&(s.expiredLanes|=V),T&=~V}}function Il(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Sl(){var s=wr;return wr<<=1,(wr&4194240)===0&&(wr=64),s}function Al(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function Vs(s,a,c){s.pendingLanes|=a,a!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,a=31-kn(a),s[a]=c}function ff(s,a){var c=s.pendingLanes&~a;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=a,s.mutableReadLanes&=a,s.entangledLanes&=a,a=s.entanglements;var g=s.eventTimes;for(s=s.expirationTimes;0<c;){var _=31-kn(c),T=1<<_;a[_]=0,g[_]=-1,s[_]=-1,c&=~T}}function Cl(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var g=31-kn(c),_=1<<g;_&a|s[g]&a&&(s[g]|=a),c&=~_}}var $e=0;function Er(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Rl,Fo,Nl,Pl,kl,Tr=!1,Uo=[],xr=null,Ir=null,Wt=null,Ls=new Map,Yr=new Map,bn=[],Cc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Di(s,a){switch(s){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Wt=null;break;case"pointerover":case"pointerout":Ls.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yr.delete(a.pointerId)}}function ir(s,a,c,g,_,T){return s===null||s.nativeEvent!==T?(s={blockedOn:a,domEventName:c,eventSystemFlags:g,nativeEvent:T,targetContainers:[_]},a!==null&&(a=$l(a),a!==null&&Fo(a)),s):(s.eventSystemFlags|=g,a=s.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),s)}function Rc(s,a,c,g,_){switch(a){case"focusin":return xr=ir(xr,s,a,c,g,_),!0;case"dragenter":return Ir=ir(Ir,s,a,c,g,_),!0;case"mouseover":return Wt=ir(Wt,s,a,c,g,_),!0;case"pointerover":var T=_.pointerId;return Ls.set(T,ir(Ls.get(T)||null,s,a,c,g,_)),!0;case"gotpointercapture":return T=_.pointerId,Yr.set(T,ir(Yr.get(T)||null,s,a,c,g,_)),!0}return!1}function Oo(s){var a=Bs(s.target);if(a!==null){var c=rr(a);if(c!==null){if(a=c.tag,a===13){if(a=wl(c),a!==null){s.blockedOn=a,kl(s.priority,function(){Nl(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ot(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var c=Bo(s.domEventName,s.eventSystemFlags,a[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var g=new c.constructor(c.type,c);Ci=g,c.target.dispatchEvent(g),Ci=null}else return a=$l(c),a!==null&&Fo(a),s.blockedOn=c,!1;a.shift()}return!0}function Nc(s,a,c){ot(s)&&c.delete(a)}function pf(){Tr=!1,xr!==null&&ot(xr)&&(xr=null),Ir!==null&&ot(Ir)&&(Ir=null),Wt!==null&&ot(Wt)&&(Wt=null),Ls.forEach(Nc),Yr.forEach(Nc)}function Mi(s,a){s.blockedOn===a&&(s.blockedOn=null,Tr||(Tr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,pf)))}function Vi(s){function a(_){return Mi(_,s)}if(0<Uo.length){Mi(Uo[0],s);for(var c=1;c<Uo.length;c++){var g=Uo[c];g.blockedOn===s&&(g.blockedOn=null)}}for(xr!==null&&Mi(xr,s),Ir!==null&&Mi(Ir,s),Wt!==null&&Mi(Wt,s),Ls.forEach(a),Yr.forEach(a),c=0;c<bn.length;c++)g=bn[c],g.blockedOn===s&&(g.blockedOn=null);for(;0<bn.length&&(c=bn[0],c.blockedOn===null);)Oo(c),c.blockedOn===null&&bn.shift()}var Xr=ee.ReactCurrentBatchConfig,Zr=!0;function Sr(s,a,c,g){var _=$e,T=Xr.transition;Xr.transition=null;try{$e=1,bl(s,a,c,g)}finally{$e=_,Xr.transition=T}}function Pc(s,a,c,g){var _=$e,T=Xr.transition;Xr.transition=null;try{$e=4,bl(s,a,c,g)}finally{$e=_,Xr.transition=T}}function bl(s,a,c,g){if(Zr){var _=Bo(s,a,c,g);if(_===null)Sf(s,a,g,Ar,c),Di(s,g);else if(Rc(_,s,a,c,g))g.stopPropagation();else if(Di(s,g),a&4&&-1<Cc.indexOf(s)){for(;_!==null;){var T=$l(_);if(T!==null&&Rl(T),T=Bo(s,a,c,g),T===null&&Sf(s,a,g,Ar,c),T===_)break;_=T}_!==null&&g.stopPropagation()}else Sf(s,a,g,null,c)}}var Ar=null;function Bo(s,a,c,g){if(Ar=null,s=bo(g),s=Bs(s),s!==null)if(a=rr(s),a===null)s=null;else if(c=a.tag,c===13){if(s=wl(a),s!==null)return s;s=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null);return Ar=s,null}function Go(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hf()){case Vo:return 1;case Tl:return 4;case Ps:case xl:return 16;case Lo:return 536870912;default:return 16}default:return 16}}var Dn=null,qo=null,ei=null;function kc(){if(ei)return ei;var s,a=qo,c=a.length,g,_="value"in Dn?Dn.value:Dn.textContent,T=_.length;for(s=0;s<c&&a[s]===_[s];s++);var A=c-s;for(g=1;g<=A&&a[c-g]===_[T-g];g++);return ei=_.slice(s,1<g?1-g:void 0)}function Fs(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Cr(){return!0}function Dl(){return!1}function en(s){function a(c,g,_,T,A){this._reactName=c,this._targetInst=_,this.type=g,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var V in s)s.hasOwnProperty(V)&&(c=s[V],this[V]=c?c(T):T[V]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Cr:Dl,this.isPropagationStopped=Dl,this}return ge(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Cr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Cr)},persist:function(){},isPersistent:Cr}),a}var Rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Us=en(Rr),Li=ge({},Rr,{view:0,detail:0}),zo=en(Li),Ho,$o,Mn,Os=ge({},Li,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Le,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Mn&&(Mn&&s.type==="mousemove"?(Ho=s.screenX-Mn.screenX,$o=s.screenY-Mn.screenY):$o=Ho=0,Mn=s),Ho)},movementY:function(s){return"movementY"in s?s.movementY:$o}}),Ml=en(Os),bc=ge({},Os,{dataTransfer:0}),Dc=en(bc),Ko=ge({},Li,{relatedTarget:0}),jt=en(Ko),Mc=ge({},Rr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vc=en(Mc),Fi=ge({},Rr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),m=en(Fi),x=ge({},Rr,{data:0}),I=en(x),C={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},X={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=X[s])?!!a[s]:!1}function Le(){return de}var It=ge({},Li,{key:function(s){if(s.key){var a=C[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Fs(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?W[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Le,charCode:function(s){return s.type==="keypress"?Fs(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Fs(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),rt=en(It),bt=ge({},Os,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vn=en(bt),ti=ge({},Li,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Le}),Nr=en(ti),Pr=ge({},Rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wo=en(Pr),Vl=ge({},Os,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),DA=en(Vl),MA=[9,13,27,32],mf=u&&"CompositionEvent"in window,Ll=null;u&&"documentMode"in document&&(Ll=document.documentMode);var VA=u&&"TextEvent"in window&&!Ll,Py=u&&(!mf||Ll&&8<Ll&&11>=Ll),ky=" ",by=!1;function Dy(s,a){switch(s){case"keyup":return MA.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function My(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var jo=!1;function LA(s,a){switch(s){case"compositionend":return My(a);case"keypress":return a.which!==32?null:(by=!0,ky);case"textInput":return s=a.data,s===ky&&by?null:s;default:return null}}function FA(s,a){if(jo)return s==="compositionend"||!mf&&Dy(s,a)?(s=kc(),ei=qo=Dn=null,jo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Py&&a.locale!=="ko"?null:a.data;default:return null}}var UA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vy(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!UA[s.type]:a==="textarea"}function Ly(s,a,c,g){Ri(g),a=Bc(a,"onChange"),0<a.length&&(c=new Us("onChange","change",null,c,g),s.push({event:c,listeners:a}))}var Fl=null,Ul=null;function OA(s){ev(s,0)}function Lc(s){var a=Zo(s);if(Pt(a))return s}function BA(s,a){if(s==="change")return a}var Fy=!1;if(u){var gf;if(u){var yf="oninput"in document;if(!yf){var Uy=document.createElement("div");Uy.setAttribute("oninput","return;"),yf=typeof Uy.oninput=="function"}gf=yf}else gf=!1;Fy=gf&&(!document.documentMode||9<document.documentMode)}function Oy(){Fl&&(Fl.detachEvent("onpropertychange",By),Ul=Fl=null)}function By(s){if(s.propertyName==="value"&&Lc(Ul)){var a=[];Ly(a,Ul,s,bo(s)),_c(OA,a)}}function GA(s,a,c){s==="focusin"?(Oy(),Fl=a,Ul=c,Fl.attachEvent("onpropertychange",By)):s==="focusout"&&Oy()}function qA(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Lc(Ul)}function zA(s,a){if(s==="click")return Lc(a)}function HA(s,a){if(s==="input"||s==="change")return Lc(a)}function $A(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var sr=typeof Object.is=="function"?Object.is:$A;function Ol(s,a){if(sr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),g=Object.keys(a);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var _=c[g];if(!d.call(a,_)||!sr(s[_],a[_]))return!1}return!0}function Gy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function qy(s,a){var c=Gy(s);s=0;for(var g;c;){if(c.nodeType===3){if(g=s+c.textContent.length,s<=a&&g>=a)return{node:c,offset:a-s};s=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Gy(c)}}function zy(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?zy(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Hy(){for(var s=window,a=Bt();a instanceof s.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)s=a.contentWindow;else break;a=Bt(s.document)}return a}function vf(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}function KA(s){var a=Hy(),c=s.focusedElem,g=s.selectionRange;if(a!==c&&c&&c.ownerDocument&&zy(c.ownerDocument.documentElement,c)){if(g!==null&&vf(c)){if(a=g.start,s=g.end,s===void 0&&(s=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(s,c.value.length);else if(s=(a=c.ownerDocument||document)&&a.defaultView||window,s.getSelection){s=s.getSelection();var _=c.textContent.length,T=Math.min(g.start,_);g=g.end===void 0?T:Math.min(g.end,_),!s.extend&&T>g&&(_=g,g=T,T=_),_=qy(c,T);var A=qy(c,g);_&&A&&(s.rangeCount!==1||s.anchorNode!==_.node||s.anchorOffset!==_.offset||s.focusNode!==A.node||s.focusOffset!==A.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),s.removeAllRanges(),T>g?(s.addRange(a),s.extend(A.node,A.offset)):(a.setEnd(A.node,A.offset),s.addRange(a)))}}for(a=[],s=c;s=s.parentNode;)s.nodeType===1&&a.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)s=a[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var WA=u&&"documentMode"in document&&11>=document.documentMode,Jo=null,_f=null,Bl=null,wf=!1;function $y(s,a,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;wf||Jo==null||Jo!==Bt(g)||(g=Jo,"selectionStart"in g&&vf(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Bl&&Ol(Bl,g)||(Bl=g,g=Bc(_f,"onSelect"),0<g.length&&(a=new Us("onSelect","select",null,a,c),s.push({event:a,listeners:g}),a.target=Jo)))}function Fc(s,a){var c={};return c[s.toLowerCase()]=a.toLowerCase(),c["Webkit"+s]="webkit"+a,c["Moz"+s]="moz"+a,c}var Qo={animationend:Fc("Animation","AnimationEnd"),animationiteration:Fc("Animation","AnimationIteration"),animationstart:Fc("Animation","AnimationStart"),transitionend:Fc("Transition","TransitionEnd")},Ef={},Ky={};u&&(Ky=document.createElement("div").style,"AnimationEvent"in window||(delete Qo.animationend.animation,delete Qo.animationiteration.animation,delete Qo.animationstart.animation),"TransitionEvent"in window||delete Qo.transitionend.transition);function Uc(s){if(Ef[s])return Ef[s];if(!Qo[s])return s;var a=Qo[s],c;for(c in a)if(a.hasOwnProperty(c)&&c in Ky)return Ef[s]=a[c];return s}var Wy=Uc("animationend"),jy=Uc("animationiteration"),Jy=Uc("animationstart"),Qy=Uc("transitionend"),Yy=new Map,Xy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ui(s,a){Yy.set(s,a),o(a,[s])}for(var Tf=0;Tf<Xy.length;Tf++){var xf=Xy[Tf],jA=xf.toLowerCase(),JA=xf[0].toUpperCase()+xf.slice(1);Ui(jA,"on"+JA)}Ui(Wy,"onAnimationEnd"),Ui(jy,"onAnimationIteration"),Ui(Jy,"onAnimationStart"),Ui("dblclick","onDoubleClick"),Ui("focusin","onFocus"),Ui("focusout","onBlur"),Ui(Qy,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gl));function Zy(s,a,c){var g=s.type||"unknown-event";s.currentTarget=c,_l(g,a,void 0,s),s.currentTarget=null}function ev(s,a){a=(a&4)!==0;for(var c=0;c<s.length;c++){var g=s[c],_=g.event;g=g.listeners;e:{var T=void 0;if(a)for(var A=g.length-1;0<=A;A--){var V=g[A],U=V.instance,Q=V.currentTarget;if(V=V.listener,U!==T&&_.isPropagationStopped())break e;Zy(_,V,Q),T=U}else for(A=0;A<g.length;A++){if(V=g[A],U=V.instance,Q=V.currentTarget,V=V.listener,U!==T&&_.isPropagationStopped())break e;Zy(_,V,Q),T=U}}}if(Do)throw s=qn,Do=!1,qn=null,s}function dt(s,a){var c=a[kf];c===void 0&&(c=a[kf]=new Set);var g=s+"__bubble";c.has(g)||(tv(a,s,2,!1),c.add(g))}function If(s,a,c){var g=0;a&&(g|=4),tv(c,s,g,a)}var Oc="_reactListening"+Math.random().toString(36).slice(2);function ql(s){if(!s[Oc]){s[Oc]=!0,r.forEach(function(c){c!=="selectionchange"&&(QA.has(c)||If(c,!1,s),If(c,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Oc]||(a[Oc]=!0,If("selectionchange",!1,a))}}function tv(s,a,c,g){switch(Go(a)){case 1:var _=Sr;break;case 4:_=Pc;break;default:_=bl}c=_.bind(null,a,c,s),_=void 0,!Pi||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),g?_!==void 0?s.addEventListener(a,c,{capture:!0,passive:_}):s.addEventListener(a,c,!0):_!==void 0?s.addEventListener(a,c,{passive:_}):s.addEventListener(a,c,!1)}function Sf(s,a,c,g,_){var T=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var A=g.tag;if(A===3||A===4){var V=g.stateNode.containerInfo;if(V===_||V.nodeType===8&&V.parentNode===_)break;if(A===4)for(A=g.return;A!==null;){var U=A.tag;if((U===3||U===4)&&(U=A.stateNode.containerInfo,U===_||U.nodeType===8&&U.parentNode===_))return;A=A.return}for(;V!==null;){if(A=Bs(V),A===null)return;if(U=A.tag,U===5||U===6){g=T=A;continue e}V=V.parentNode}}g=g.return}_c(function(){var Q=T,oe=bo(c),le=[];e:{var ie=Yy.get(s);if(ie!==void 0){var ve=Us,Ee=s;switch(s){case"keypress":if(Fs(c)===0)break e;case"keydown":case"keyup":ve=rt;break;case"focusin":Ee="focus",ve=jt;break;case"focusout":Ee="blur",ve=jt;break;case"beforeblur":case"afterblur":ve=jt;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Ml;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=Dc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=Nr;break;case Wy:case jy:case Jy:ve=Vc;break;case Qy:ve=Wo;break;case"scroll":ve=zo;break;case"wheel":ve=DA;break;case"copy":case"cut":case"paste":ve=m;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Vn}var xe=(a&4)!==0,St=!xe&&s==="scroll",K=xe?ie!==null?ie+"Capture":null:ie;xe=[];for(var O=Q,J;O!==null;){J=O;var ue=J.stateNode;if(J.tag===5&&ue!==null&&(J=ue,K!==null&&(ue=Cs(O,K),ue!=null&&xe.push(zl(O,ue,J)))),St)break;O=O.return}0<xe.length&&(ie=new ve(ie,Ee,null,c,oe),le.push({event:ie,listeners:xe}))}}if((a&7)===0){e:{if(ie=s==="mouseover"||s==="pointerover",ve=s==="mouseout"||s==="pointerout",ie&&c!==Ci&&(Ee=c.relatedTarget||c.fromElement)&&(Bs(Ee)||Ee[ni]))break e;if((ve||ie)&&(ie=oe.window===oe?oe:(ie=oe.ownerDocument)?ie.defaultView||ie.parentWindow:window,ve?(Ee=c.relatedTarget||c.toElement,ve=Q,Ee=Ee?Bs(Ee):null,Ee!==null&&(St=rr(Ee),Ee!==St||Ee.tag!==5&&Ee.tag!==6)&&(Ee=null)):(ve=null,Ee=Q),ve!==Ee)){if(xe=Ml,ue="onMouseLeave",K="onMouseEnter",O="mouse",(s==="pointerout"||s==="pointerover")&&(xe=Vn,ue="onPointerLeave",K="onPointerEnter",O="pointer"),St=ve==null?ie:Zo(ve),J=Ee==null?ie:Zo(Ee),ie=new xe(ue,O+"leave",ve,c,oe),ie.target=St,ie.relatedTarget=J,ue=null,Bs(oe)===Q&&(xe=new xe(K,O+"enter",Ee,c,oe),xe.target=J,xe.relatedTarget=St,ue=xe),St=ue,ve&&Ee)t:{for(xe=ve,K=Ee,O=0,J=xe;J;J=Yo(J))O++;for(J=0,ue=K;ue;ue=Yo(ue))J++;for(;0<O-J;)xe=Yo(xe),O--;for(;0<J-O;)K=Yo(K),J--;for(;O--;){if(xe===K||K!==null&&xe===K.alternate)break t;xe=Yo(xe),K=Yo(K)}xe=null}else xe=null;ve!==null&&nv(le,ie,ve,xe,!1),Ee!==null&&St!==null&&nv(le,St,Ee,xe,!0)}}e:{if(ie=Q?Zo(Q):window,ve=ie.nodeName&&ie.nodeName.toLowerCase(),ve==="select"||ve==="input"&&ie.type==="file")var Se=BA;else if(Vy(ie))if(Fy)Se=HA;else{Se=qA;var Ne=GA}else(ve=ie.nodeName)&&ve.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(Se=zA);if(Se&&(Se=Se(s,Q))){Ly(le,Se,c,oe);break e}Ne&&Ne(s,ie,Q),s==="focusout"&&(Ne=ie._wrapperState)&&Ne.controlled&&ie.type==="number"&&kt(ie,"number",ie.value)}switch(Ne=Q?Zo(Q):window,s){case"focusin":(Vy(Ne)||Ne.contentEditable==="true")&&(Jo=Ne,_f=Q,Bl=null);break;case"focusout":Bl=_f=Jo=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,$y(le,c,oe);break;case"selectionchange":if(WA)break;case"keydown":case"keyup":$y(le,c,oe)}var Pe;if(mf)e:{switch(s){case"compositionstart":var be="onCompositionStart";break e;case"compositionend":be="onCompositionEnd";break e;case"compositionupdate":be="onCompositionUpdate";break e}be=void 0}else jo?Dy(s,c)&&(be="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(be="onCompositionStart");be&&(Py&&c.locale!=="ko"&&(jo||be!=="onCompositionStart"?be==="onCompositionEnd"&&jo&&(Pe=kc()):(Dn=oe,qo="value"in Dn?Dn.value:Dn.textContent,jo=!0)),Ne=Bc(Q,be),0<Ne.length&&(be=new I(be,s,null,c,oe),le.push({event:be,listeners:Ne}),Pe?be.data=Pe:(Pe=My(c),Pe!==null&&(be.data=Pe)))),(Pe=VA?LA(s,c):FA(s,c))&&(Q=Bc(Q,"onBeforeInput"),0<Q.length&&(oe=new I("onBeforeInput","beforeinput",null,c,oe),le.push({event:oe,listeners:Q}),oe.data=Pe))}ev(le,a)})}function zl(s,a,c){return{instance:s,listener:a,currentTarget:c}}function Bc(s,a){for(var c=a+"Capture",g=[];s!==null;){var _=s,T=_.stateNode;_.tag===5&&T!==null&&(_=T,T=Cs(s,c),T!=null&&g.unshift(zl(s,T,_)),T=Cs(s,a),T!=null&&g.push(zl(s,T,_))),s=s.return}return g}function Yo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function nv(s,a,c,g,_){for(var T=a._reactName,A=[];c!==null&&c!==g;){var V=c,U=V.alternate,Q=V.stateNode;if(U!==null&&U===g)break;V.tag===5&&Q!==null&&(V=Q,_?(U=Cs(c,T),U!=null&&A.unshift(zl(c,U,V))):_||(U=Cs(c,T),U!=null&&A.push(zl(c,U,V)))),c=c.return}A.length!==0&&s.push({event:a,listeners:A})}var YA=/\r\n?/g,XA=/\u0000|\uFFFD/g;function rv(s){return(typeof s=="string"?s:""+s).replace(YA,`
`).replace(XA,"")}function Gc(s,a,c){if(a=rv(a),rv(s)!==a&&c)throw Error(t(425))}function qc(){}var Af=null,Cf=null;function Rf(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Nf=typeof setTimeout=="function"?setTimeout:void 0,ZA=typeof clearTimeout=="function"?clearTimeout:void 0,iv=typeof Promise=="function"?Promise:void 0,eC=typeof queueMicrotask=="function"?queueMicrotask:typeof iv<"u"?function(s){return iv.resolve(null).then(s).catch(tC)}:Nf;function tC(s){setTimeout(function(){throw s})}function Pf(s,a){var c=a,g=0;do{var _=c.nextSibling;if(s.removeChild(c),_&&_.nodeType===8)if(c=_.data,c==="/$"){if(g===0){s.removeChild(_),Vi(a);return}g--}else c!=="$"&&c!=="$?"&&c!=="$!"||g++;c=_}while(c);Vi(a)}function Oi(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return s}function sv(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return s;a--}else c==="/$"&&a++}s=s.previousSibling}return null}var Xo=Math.random().toString(36).slice(2),kr="__reactFiber$"+Xo,Hl="__reactProps$"+Xo,ni="__reactContainer$"+Xo,kf="__reactEvents$"+Xo,nC="__reactListeners$"+Xo,rC="__reactHandles$"+Xo;function Bs(s){var a=s[kr];if(a)return a;for(var c=s.parentNode;c;){if(a=c[ni]||c[kr]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(s=sv(s);s!==null;){if(c=s[kr])return c;s=sv(s)}return a}s=c,c=s.parentNode}return null}function $l(s){return s=s[kr]||s[ni],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Zo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function zc(s){return s[Hl]||null}var bf=[],ea=-1;function Bi(s){return{current:s}}function ht(s){0>ea||(s.current=bf[ea],bf[ea]=null,ea--)}function at(s,a){ea++,bf[ea]=s.current,s.current=a}var Gi={},tn=Bi(Gi),wn=Bi(!1),Gs=Gi;function ta(s,a){var c=s.type.contextTypes;if(!c)return Gi;var g=s.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var _={},T;for(T in c)_[T]=a[T];return g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=_),_}function En(s){return s=s.childContextTypes,s!=null}function Hc(){ht(wn),ht(tn)}function ov(s,a,c){if(tn.current!==Gi)throw Error(t(168));at(tn,a),at(wn,c)}function av(s,a,c){var g=s.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return c;g=g.getChildContext();for(var _ in g)if(!(_ in a))throw Error(t(108,We(s)||"Unknown",_));return ge({},c,g)}function $c(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Gi,Gs=tn.current,at(tn,s),at(wn,wn.current),!0}function lv(s,a,c){var g=s.stateNode;if(!g)throw Error(t(169));c?(s=av(s,a,Gs),g.__reactInternalMemoizedMergedChildContext=s,ht(wn),ht(tn),at(tn,s)):ht(wn),at(wn,c)}var ri=null,Kc=!1,Df=!1;function uv(s){ri===null?ri=[s]:ri.push(s)}function iC(s){Kc=!0,uv(s)}function qi(){if(!Df&&ri!==null){Df=!0;var s=0,a=$e;try{var c=ri;for($e=1;s<c.length;s++){var g=c[s];do g=g(!0);while(g!==null)}ri=null,Kc=!1}catch(_){throw ri!==null&&(ri=ri.slice(s+1)),El(Vo,qi),_}finally{$e=a,Df=!1}}return null}var na=[],ra=0,Wc=null,jc=0,Hn=[],$n=0,qs=null,ii=1,si="";function zs(s,a){na[ra++]=jc,na[ra++]=Wc,Wc=s,jc=a}function cv(s,a,c){Hn[$n++]=ii,Hn[$n++]=si,Hn[$n++]=qs,qs=s;var g=ii;s=si;var _=32-kn(g)-1;g&=~(1<<_),c+=1;var T=32-kn(a)+_;if(30<T){var A=_-_%5;T=(g&(1<<A)-1).toString(32),g>>=A,_-=A,ii=1<<32-kn(a)+_|c<<_|g,si=T+s}else ii=1<<T|c<<_|g,si=s}function Mf(s){s.return!==null&&(zs(s,1),cv(s,1,0))}function Vf(s){for(;s===Wc;)Wc=na[--ra],na[ra]=null,jc=na[--ra],na[ra]=null;for(;s===qs;)qs=Hn[--$n],Hn[$n]=null,si=Hn[--$n],Hn[$n]=null,ii=Hn[--$n],Hn[$n]=null}var Ln=null,Fn=null,pt=!1,or=null;function dv(s,a){var c=Jn(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=s,a=s.deletions,a===null?(s.deletions=[c],s.flags|=16):a.push(c)}function hv(s,a){switch(s.tag){case 5:var c=s.type;return a=a.nodeType!==1||c.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(s.stateNode=a,Ln=s,Fn=Oi(a.firstChild),!0):!1;case 6:return a=s.pendingProps===""||a.nodeType!==3?null:a,a!==null?(s.stateNode=a,Ln=s,Fn=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(c=qs!==null?{id:ii,overflow:si}:null,s.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=Jn(18,null,null,0),c.stateNode=a,c.return=s,s.child=c,Ln=s,Fn=null,!0):!1;default:return!1}}function Lf(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Ff(s){if(pt){var a=Fn;if(a){var c=a;if(!hv(s,a)){if(Lf(s))throw Error(t(418));a=Oi(c.nextSibling);var g=Ln;a&&hv(s,a)?dv(g,c):(s.flags=s.flags&-4097|2,pt=!1,Ln=s)}}else{if(Lf(s))throw Error(t(418));s.flags=s.flags&-4097|2,pt=!1,Ln=s}}}function fv(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ln=s}function Jc(s){if(s!==Ln)return!1;if(!pt)return fv(s),pt=!0,!1;var a;if((a=s.tag!==3)&&!(a=s.tag!==5)&&(a=s.type,a=a!=="head"&&a!=="body"&&!Rf(s.type,s.memoizedProps)),a&&(a=Fn)){if(Lf(s))throw pv(),Error(t(418));for(;a;)dv(s,a),a=Oi(a.nextSibling)}if(fv(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(a===0){Fn=Oi(s.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++}s=s.nextSibling}Fn=null}}else Fn=Ln?Oi(s.stateNode.nextSibling):null;return!0}function pv(){for(var s=Fn;s;)s=Oi(s.nextSibling)}function ia(){Fn=Ln=null,pt=!1}function Uf(s){or===null?or=[s]:or.push(s)}var sC=ee.ReactCurrentBatchConfig;function Kl(s,a,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var g=c.stateNode}if(!g)throw Error(t(147,s));var _=g,T=""+s;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===T?a.ref:(a=function(A){var V=_.refs;A===null?delete V[T]:V[T]=A},a._stringRef=T,a)}if(typeof s!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,s))}return s}function Qc(s,a){throw s=Object.prototype.toString.call(a),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s))}function mv(s){var a=s._init;return a(s._payload)}function gv(s){function a(K,O){if(s){var J=K.deletions;J===null?(K.deletions=[O],K.flags|=16):J.push(O)}}function c(K,O){if(!s)return null;for(;O!==null;)a(K,O),O=O.sibling;return null}function g(K,O){for(K=new Map;O!==null;)O.key!==null?K.set(O.key,O):K.set(O.index,O),O=O.sibling;return K}function _(K,O){return K=Qi(K,O),K.index=0,K.sibling=null,K}function T(K,O,J){return K.index=J,s?(J=K.alternate,J!==null?(J=J.index,J<O?(K.flags|=2,O):J):(K.flags|=2,O)):(K.flags|=1048576,O)}function A(K){return s&&K.alternate===null&&(K.flags|=2),K}function V(K,O,J,ue){return O===null||O.tag!==6?(O=Np(J,K.mode,ue),O.return=K,O):(O=_(O,J),O.return=K,O)}function U(K,O,J,ue){var Se=J.type;return Se===b?oe(K,O,J.props.children,ue,J.key):O!==null&&(O.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===fe&&mv(Se)===O.type)?(ue=_(O,J.props),ue.ref=Kl(K,O,J),ue.return=K,ue):(ue=wd(J.type,J.key,J.props,null,K.mode,ue),ue.ref=Kl(K,O,J),ue.return=K,ue)}function Q(K,O,J,ue){return O===null||O.tag!==4||O.stateNode.containerInfo!==J.containerInfo||O.stateNode.implementation!==J.implementation?(O=Pp(J,K.mode,ue),O.return=K,O):(O=_(O,J.children||[]),O.return=K,O)}function oe(K,O,J,ue,Se){return O===null||O.tag!==7?(O=Ys(J,K.mode,ue,Se),O.return=K,O):(O=_(O,J),O.return=K,O)}function le(K,O,J){if(typeof O=="string"&&O!==""||typeof O=="number")return O=Np(""+O,K.mode,J),O.return=K,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case te:return J=wd(O.type,O.key,O.props,null,K.mode,J),J.ref=Kl(K,null,O),J.return=K,J;case j:return O=Pp(O,K.mode,J),O.return=K,O;case fe:var ue=O._init;return le(K,ue(O._payload),J)}if(xt(O)||Ce(O))return O=Ys(O,K.mode,J,null),O.return=K,O;Qc(K,O)}return null}function ie(K,O,J,ue){var Se=O!==null?O.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return Se!==null?null:V(K,O,""+J,ue);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case te:return J.key===Se?U(K,O,J,ue):null;case j:return J.key===Se?Q(K,O,J,ue):null;case fe:return Se=J._init,ie(K,O,Se(J._payload),ue)}if(xt(J)||Ce(J))return Se!==null?null:oe(K,O,J,ue,null);Qc(K,J)}return null}function ve(K,O,J,ue,Se){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return K=K.get(J)||null,V(O,K,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case te:return K=K.get(ue.key===null?J:ue.key)||null,U(O,K,ue,Se);case j:return K=K.get(ue.key===null?J:ue.key)||null,Q(O,K,ue,Se);case fe:var Ne=ue._init;return ve(K,O,J,Ne(ue._payload),Se)}if(xt(ue)||Ce(ue))return K=K.get(J)||null,oe(O,K,ue,Se,null);Qc(O,ue)}return null}function Ee(K,O,J,ue){for(var Se=null,Ne=null,Pe=O,be=O=0,zt=null;Pe!==null&&be<J.length;be++){Pe.index>be?(zt=Pe,Pe=null):zt=Pe.sibling;var Ye=ie(K,Pe,J[be],ue);if(Ye===null){Pe===null&&(Pe=zt);break}s&&Pe&&Ye.alternate===null&&a(K,Pe),O=T(Ye,O,be),Ne===null?Se=Ye:Ne.sibling=Ye,Ne=Ye,Pe=zt}if(be===J.length)return c(K,Pe),pt&&zs(K,be),Se;if(Pe===null){for(;be<J.length;be++)Pe=le(K,J[be],ue),Pe!==null&&(O=T(Pe,O,be),Ne===null?Se=Pe:Ne.sibling=Pe,Ne=Pe);return pt&&zs(K,be),Se}for(Pe=g(K,Pe);be<J.length;be++)zt=ve(Pe,K,be,J[be],ue),zt!==null&&(s&&zt.alternate!==null&&Pe.delete(zt.key===null?be:zt.key),O=T(zt,O,be),Ne===null?Se=zt:Ne.sibling=zt,Ne=zt);return s&&Pe.forEach(function(Yi){return a(K,Yi)}),pt&&zs(K,be),Se}function xe(K,O,J,ue){var Se=Ce(J);if(typeof Se!="function")throw Error(t(150));if(J=Se.call(J),J==null)throw Error(t(151));for(var Ne=Se=null,Pe=O,be=O=0,zt=null,Ye=J.next();Pe!==null&&!Ye.done;be++,Ye=J.next()){Pe.index>be?(zt=Pe,Pe=null):zt=Pe.sibling;var Yi=ie(K,Pe,Ye.value,ue);if(Yi===null){Pe===null&&(Pe=zt);break}s&&Pe&&Yi.alternate===null&&a(K,Pe),O=T(Yi,O,be),Ne===null?Se=Yi:Ne.sibling=Yi,Ne=Yi,Pe=zt}if(Ye.done)return c(K,Pe),pt&&zs(K,be),Se;if(Pe===null){for(;!Ye.done;be++,Ye=J.next())Ye=le(K,Ye.value,ue),Ye!==null&&(O=T(Ye,O,be),Ne===null?Se=Ye:Ne.sibling=Ye,Ne=Ye);return pt&&zs(K,be),Se}for(Pe=g(K,Pe);!Ye.done;be++,Ye=J.next())Ye=ve(Pe,K,be,Ye.value,ue),Ye!==null&&(s&&Ye.alternate!==null&&Pe.delete(Ye.key===null?be:Ye.key),O=T(Ye,O,be),Ne===null?Se=Ye:Ne.sibling=Ye,Ne=Ye);return s&&Pe.forEach(function(UC){return a(K,UC)}),pt&&zs(K,be),Se}function St(K,O,J,ue){if(typeof J=="object"&&J!==null&&J.type===b&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case te:e:{for(var Se=J.key,Ne=O;Ne!==null;){if(Ne.key===Se){if(Se=J.type,Se===b){if(Ne.tag===7){c(K,Ne.sibling),O=_(Ne,J.props.children),O.return=K,K=O;break e}}else if(Ne.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===fe&&mv(Se)===Ne.type){c(K,Ne.sibling),O=_(Ne,J.props),O.ref=Kl(K,Ne,J),O.return=K,K=O;break e}c(K,Ne);break}else a(K,Ne);Ne=Ne.sibling}J.type===b?(O=Ys(J.props.children,K.mode,ue,J.key),O.return=K,K=O):(ue=wd(J.type,J.key,J.props,null,K.mode,ue),ue.ref=Kl(K,O,J),ue.return=K,K=ue)}return A(K);case j:e:{for(Ne=J.key;O!==null;){if(O.key===Ne)if(O.tag===4&&O.stateNode.containerInfo===J.containerInfo&&O.stateNode.implementation===J.implementation){c(K,O.sibling),O=_(O,J.children||[]),O.return=K,K=O;break e}else{c(K,O);break}else a(K,O);O=O.sibling}O=Pp(J,K.mode,ue),O.return=K,K=O}return A(K);case fe:return Ne=J._init,St(K,O,Ne(J._payload),ue)}if(xt(J))return Ee(K,O,J,ue);if(Ce(J))return xe(K,O,J,ue);Qc(K,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,O!==null&&O.tag===6?(c(K,O.sibling),O=_(O,J),O.return=K,K=O):(c(K,O),O=Np(J,K.mode,ue),O.return=K,K=O),A(K)):c(K,O)}return St}var sa=gv(!0),yv=gv(!1),Yc=Bi(null),Xc=null,oa=null,Of=null;function Bf(){Of=oa=Xc=null}function Gf(s){var a=Yc.current;ht(Yc),s._currentValue=a}function qf(s,a,c){for(;s!==null;){var g=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),s===c)break;s=s.return}}function aa(s,a){Xc=s,Of=oa=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&a)!==0&&(Tn=!0),s.firstContext=null)}function Kn(s){var a=s._currentValue;if(Of!==s)if(s={context:s,memoizedValue:a,next:null},oa===null){if(Xc===null)throw Error(t(308));oa=s,Xc.dependencies={lanes:0,firstContext:s}}else oa=oa.next=s;return a}var Hs=null;function zf(s){Hs===null?Hs=[s]:Hs.push(s)}function vv(s,a,c,g){var _=a.interleaved;return _===null?(c.next=c,zf(a)):(c.next=_.next,_.next=c),a.interleaved=c,oi(s,g)}function oi(s,a){s.lanes|=a;var c=s.alternate;for(c!==null&&(c.lanes|=a),c=s,s=s.return;s!==null;)s.childLanes|=a,c=s.alternate,c!==null&&(c.childLanes|=a),c=s,s=s.return;return c.tag===3?c.stateNode:null}var zi=!1;function Hf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _v(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ai(s,a){return{eventTime:s,lane:a,tag:0,payload:null,callback:null,next:null}}function Hi(s,a,c){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Qe&2)!==0){var _=g.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),g.pending=a,oi(s,c)}return _=g.interleaved,_===null?(a.next=a,zf(g)):(a.next=_.next,_.next=a),g.interleaved=a,oi(s,c)}function Zc(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var g=a.lanes;g&=s.pendingLanes,c|=g,a.lanes=c,Cl(s,c)}}function wv(s,a){var c=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var _=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var A={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};T===null?_=T=A:T=T.next=A,c=c.next}while(c!==null);T===null?_=T=a:T=T.next=a}else _=T=a;c={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:T,shared:g.shared,effects:g.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}function ed(s,a,c,g){var _=s.updateQueue;zi=!1;var T=_.firstBaseUpdate,A=_.lastBaseUpdate,V=_.shared.pending;if(V!==null){_.shared.pending=null;var U=V,Q=U.next;U.next=null,A===null?T=Q:A.next=Q,A=U;var oe=s.alternate;oe!==null&&(oe=oe.updateQueue,V=oe.lastBaseUpdate,V!==A&&(V===null?oe.firstBaseUpdate=Q:V.next=Q,oe.lastBaseUpdate=U))}if(T!==null){var le=_.baseState;A=0,oe=Q=U=null,V=T;do{var ie=V.lane,ve=V.eventTime;if((g&ie)===ie){oe!==null&&(oe=oe.next={eventTime:ve,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var Ee=s,xe=V;switch(ie=a,ve=c,xe.tag){case 1:if(Ee=xe.payload,typeof Ee=="function"){le=Ee.call(ve,le,ie);break e}le=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=xe.payload,ie=typeof Ee=="function"?Ee.call(ve,le,ie):Ee,ie==null)break e;le=ge({},le,ie);break e;case 2:zi=!0}}V.callback!==null&&V.lane!==0&&(s.flags|=64,ie=_.effects,ie===null?_.effects=[V]:ie.push(V))}else ve={eventTime:ve,lane:ie,tag:V.tag,payload:V.payload,callback:V.callback,next:null},oe===null?(Q=oe=ve,U=le):oe=oe.next=ve,A|=ie;if(V=V.next,V===null){if(V=_.shared.pending,V===null)break;ie=V,V=ie.next,ie.next=null,_.lastBaseUpdate=ie,_.shared.pending=null}}while(!0);if(oe===null&&(U=le),_.baseState=U,_.firstBaseUpdate=Q,_.lastBaseUpdate=oe,a=_.shared.interleaved,a!==null){_=a;do A|=_.lane,_=_.next;while(_!==a)}else T===null&&(_.shared.lanes=0);Ws|=A,s.lanes=A,s.memoizedState=le}}function Ev(s,a,c){if(s=a.effects,a.effects=null,s!==null)for(a=0;a<s.length;a++){var g=s[a],_=g.callback;if(_!==null){if(g.callback=null,g=c,typeof _!="function")throw Error(t(191,_));_.call(g)}}}var Wl={},br=Bi(Wl),jl=Bi(Wl),Jl=Bi(Wl);function $s(s){if(s===Wl)throw Error(t(174));return s}function $f(s,a){switch(at(Jl,a),at(jl,s),at(br,Wl),s=a.nodeType,s){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:No(null,"");break;default:s=s===8?a.parentNode:a,a=s.namespaceURI||null,s=s.tagName,a=No(a,s)}ht(br),at(br,a)}function la(){ht(br),ht(jl),ht(Jl)}function Tv(s){$s(Jl.current);var a=$s(br.current),c=No(a,s.type);a!==c&&(at(jl,s),at(br,c))}function Kf(s){jl.current===s&&(ht(br),ht(jl))}var vt=Bi(0);function td(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Wf=[];function jf(){for(var s=0;s<Wf.length;s++)Wf[s]._workInProgressVersionPrimary=null;Wf.length=0}var nd=ee.ReactCurrentDispatcher,Jf=ee.ReactCurrentBatchConfig,Ks=0,_t=null,Ft=null,Gt=null,rd=!1,Ql=!1,Yl=0,oC=0;function nn(){throw Error(t(321))}function Qf(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!sr(s[c],a[c]))return!1;return!0}function Yf(s,a,c,g,_,T){if(Ks=T,_t=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,nd.current=s===null||s.memoizedState===null?cC:dC,s=c(g,_),Ql){T=0;do{if(Ql=!1,Yl=0,25<=T)throw Error(t(301));T+=1,Gt=Ft=null,a.updateQueue=null,nd.current=hC,s=c(g,_)}while(Ql)}if(nd.current=od,a=Ft!==null&&Ft.next!==null,Ks=0,Gt=Ft=_t=null,rd=!1,a)throw Error(t(300));return s}function Xf(){var s=Yl!==0;return Yl=0,s}function Dr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?_t.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function Wn(){if(Ft===null){var s=_t.alternate;s=s!==null?s.memoizedState:null}else s=Ft.next;var a=Gt===null?_t.memoizedState:Gt.next;if(a!==null)Gt=a,Ft=s;else{if(s===null)throw Error(t(310));Ft=s,s={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Gt===null?_t.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function Xl(s,a){return typeof a=="function"?a(s):a}function Zf(s){var a=Wn(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var g=Ft,_=g.baseQueue,T=c.pending;if(T!==null){if(_!==null){var A=_.next;_.next=T.next,T.next=A}g.baseQueue=_=T,c.pending=null}if(_!==null){T=_.next,g=g.baseState;var V=A=null,U=null,Q=T;do{var oe=Q.lane;if((Ks&oe)===oe)U!==null&&(U=U.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),g=Q.hasEagerState?Q.eagerState:s(g,Q.action);else{var le={lane:oe,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};U===null?(V=U=le,A=g):U=U.next=le,_t.lanes|=oe,Ws|=oe}Q=Q.next}while(Q!==null&&Q!==T);U===null?A=g:U.next=V,sr(g,a.memoizedState)||(Tn=!0),a.memoizedState=g,a.baseState=A,a.baseQueue=U,c.lastRenderedState=g}if(s=c.interleaved,s!==null){_=s;do T=_.lane,_t.lanes|=T,Ws|=T,_=_.next;while(_!==s)}else _===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function ep(s){var a=Wn(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var g=c.dispatch,_=c.pending,T=a.memoizedState;if(_!==null){c.pending=null;var A=_=_.next;do T=s(T,A.action),A=A.next;while(A!==_);sr(T,a.memoizedState)||(Tn=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),c.lastRenderedState=T}return[T,g]}function xv(){}function Iv(s,a){var c=_t,g=Wn(),_=a(),T=!sr(g.memoizedState,_);if(T&&(g.memoizedState=_,Tn=!0),g=g.queue,tp(Cv.bind(null,c,g,s),[s]),g.getSnapshot!==a||T||Gt!==null&&Gt.memoizedState.tag&1){if(c.flags|=2048,Zl(9,Av.bind(null,c,g,_,a),void 0,null),qt===null)throw Error(t(349));(Ks&30)!==0||Sv(c,a,_)}return _}function Sv(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=_t.updateQueue,a===null?(a={lastEffect:null,stores:null},_t.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function Av(s,a,c,g){a.value=c,a.getSnapshot=g,Rv(a)&&Nv(s)}function Cv(s,a,c){return c(function(){Rv(a)&&Nv(s)})}function Rv(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!sr(s,c)}catch{return!0}}function Nv(s){var a=oi(s,1);a!==null&&cr(a,s,1,-1)}function Pv(s){var a=Dr();return typeof s=="function"&&(s=s()),a.memoizedState=a.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xl,lastRenderedState:s},a.queue=s,s=s.dispatch=uC.bind(null,_t,s),[a.memoizedState,s]}function Zl(s,a,c,g){return s={tag:s,create:a,destroy:c,deps:g,next:null},a=_t.updateQueue,a===null?(a={lastEffect:null,stores:null},_t.updateQueue=a,a.lastEffect=s.next=s):(c=a.lastEffect,c===null?a.lastEffect=s.next=s:(g=c.next,c.next=s,s.next=g,a.lastEffect=s)),s}function kv(){return Wn().memoizedState}function id(s,a,c,g){var _=Dr();_t.flags|=s,_.memoizedState=Zl(1|a,c,void 0,g===void 0?null:g)}function sd(s,a,c,g){var _=Wn();g=g===void 0?null:g;var T=void 0;if(Ft!==null){var A=Ft.memoizedState;if(T=A.destroy,g!==null&&Qf(g,A.deps)){_.memoizedState=Zl(a,c,T,g);return}}_t.flags|=s,_.memoizedState=Zl(1|a,c,T,g)}function bv(s,a){return id(8390656,8,s,a)}function tp(s,a){return sd(2048,8,s,a)}function Dv(s,a){return sd(4,2,s,a)}function Mv(s,a){return sd(4,4,s,a)}function Vv(s,a){if(typeof a=="function")return s=s(),a(s),function(){a(null)};if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function Lv(s,a,c){return c=c!=null?c.concat([s]):null,sd(4,4,Vv.bind(null,a,s),c)}function np(){}function Fv(s,a){var c=Wn();a=a===void 0?null:a;var g=c.memoizedState;return g!==null&&a!==null&&Qf(a,g[1])?g[0]:(c.memoizedState=[s,a],s)}function Uv(s,a){var c=Wn();a=a===void 0?null:a;var g=c.memoizedState;return g!==null&&a!==null&&Qf(a,g[1])?g[0]:(s=s(),c.memoizedState=[s,a],s)}function Ov(s,a,c){return(Ks&21)===0?(s.baseState&&(s.baseState=!1,Tn=!0),s.memoizedState=c):(sr(c,a)||(c=Sl(),_t.lanes|=c,Ws|=c,s.baseState=!0),a)}function aC(s,a){var c=$e;$e=c!==0&&4>c?c:4,s(!0);var g=Jf.transition;Jf.transition={};try{s(!1),a()}finally{$e=c,Jf.transition=g}}function Bv(){return Wn().memoizedState}function lC(s,a,c){var g=ji(s);if(c={lane:g,action:c,hasEagerState:!1,eagerState:null,next:null},Gv(s))qv(a,c);else if(c=vv(s,a,c,g),c!==null){var _=fn();cr(c,s,g,_),zv(c,a,g)}}function uC(s,a,c){var g=ji(s),_={lane:g,action:c,hasEagerState:!1,eagerState:null,next:null};if(Gv(s))qv(a,_);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var A=a.lastRenderedState,V=T(A,c);if(_.hasEagerState=!0,_.eagerState=V,sr(V,A)){var U=a.interleaved;U===null?(_.next=_,zf(a)):(_.next=U.next,U.next=_),a.interleaved=_;return}}catch{}c=vv(s,a,_,g),c!==null&&(_=fn(),cr(c,s,g,_),zv(c,a,g))}}function Gv(s){var a=s.alternate;return s===_t||a!==null&&a===_t}function qv(s,a){Ql=rd=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function zv(s,a,c){if((c&4194240)!==0){var g=a.lanes;g&=s.pendingLanes,c|=g,a.lanes=c,Cl(s,c)}}var od={readContext:Kn,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},cC={readContext:Kn,useCallback:function(s,a){return Dr().memoizedState=[s,a===void 0?null:a],s},useContext:Kn,useEffect:bv,useImperativeHandle:function(s,a,c){return c=c!=null?c.concat([s]):null,id(4194308,4,Vv.bind(null,a,s),c)},useLayoutEffect:function(s,a){return id(4194308,4,s,a)},useInsertionEffect:function(s,a){return id(4,2,s,a)},useMemo:function(s,a){var c=Dr();return a=a===void 0?null:a,s=s(),c.memoizedState=[s,a],s},useReducer:function(s,a,c){var g=Dr();return a=c!==void 0?c(a):a,g.memoizedState=g.baseState=a,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:a},g.queue=s,s=s.dispatch=lC.bind(null,_t,s),[g.memoizedState,s]},useRef:function(s){var a=Dr();return s={current:s},a.memoizedState=s},useState:Pv,useDebugValue:np,useDeferredValue:function(s){return Dr().memoizedState=s},useTransition:function(){var s=Pv(!1),a=s[0];return s=aC.bind(null,s[1]),Dr().memoizedState=s,[a,s]},useMutableSource:function(){},useSyncExternalStore:function(s,a,c){var g=_t,_=Dr();if(pt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=a(),qt===null)throw Error(t(349));(Ks&30)!==0||Sv(g,a,c)}_.memoizedState=c;var T={value:c,getSnapshot:a};return _.queue=T,bv(Cv.bind(null,g,T,s),[s]),g.flags|=2048,Zl(9,Av.bind(null,g,T,c,a),void 0,null),c},useId:function(){var s=Dr(),a=qt.identifierPrefix;if(pt){var c=si,g=ii;c=(g&~(1<<32-kn(g)-1)).toString(32)+c,a=":"+a+"R"+c,c=Yl++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=oC++,a=":"+a+"r"+c.toString(32)+":";return s.memoizedState=a},unstable_isNewReconciler:!1},dC={readContext:Kn,useCallback:Fv,useContext:Kn,useEffect:tp,useImperativeHandle:Lv,useInsertionEffect:Dv,useLayoutEffect:Mv,useMemo:Uv,useReducer:Zf,useRef:kv,useState:function(){return Zf(Xl)},useDebugValue:np,useDeferredValue:function(s){var a=Wn();return Ov(a,Ft.memoizedState,s)},useTransition:function(){var s=Zf(Xl)[0],a=Wn().memoizedState;return[s,a]},useMutableSource:xv,useSyncExternalStore:Iv,useId:Bv,unstable_isNewReconciler:!1},hC={readContext:Kn,useCallback:Fv,useContext:Kn,useEffect:tp,useImperativeHandle:Lv,useInsertionEffect:Dv,useLayoutEffect:Mv,useMemo:Uv,useReducer:ep,useRef:kv,useState:function(){return ep(Xl)},useDebugValue:np,useDeferredValue:function(s){var a=Wn();return Ft===null?a.memoizedState=s:Ov(a,Ft.memoizedState,s)},useTransition:function(){var s=ep(Xl)[0],a=Wn().memoizedState;return[s,a]},useMutableSource:xv,useSyncExternalStore:Iv,useId:Bv,unstable_isNewReconciler:!1};function ar(s,a){if(s&&s.defaultProps){a=ge({},a),s=s.defaultProps;for(var c in s)a[c]===void 0&&(a[c]=s[c]);return a}return a}function rp(s,a,c,g){a=s.memoizedState,c=c(g,a),c=c==null?a:ge({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var ad={isMounted:function(s){return(s=s._reactInternals)?rr(s)===s:!1},enqueueSetState:function(s,a,c){s=s._reactInternals;var g=fn(),_=ji(s),T=ai(g,_);T.payload=a,c!=null&&(T.callback=c),a=Hi(s,T,_),a!==null&&(cr(a,s,_,g),Zc(a,s,_))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var g=fn(),_=ji(s),T=ai(g,_);T.tag=1,T.payload=a,c!=null&&(T.callback=c),a=Hi(s,T,_),a!==null&&(cr(a,s,_,g),Zc(a,s,_))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=fn(),g=ji(s),_=ai(c,g);_.tag=2,a!=null&&(_.callback=a),a=Hi(s,_,g),a!==null&&(cr(a,s,g,c),Zc(a,s,g))}};function Hv(s,a,c,g,_,T,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,T,A):a.prototype&&a.prototype.isPureReactComponent?!Ol(c,g)||!Ol(_,T):!0}function $v(s,a,c){var g=!1,_=Gi,T=a.contextType;return typeof T=="object"&&T!==null?T=Kn(T):(_=En(a)?Gs:tn.current,g=a.contextTypes,T=(g=g!=null)?ta(s,_):Gi),a=new a(c,T),s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=ad,s.stateNode=a,a._reactInternals=s,g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=_,s.__reactInternalMemoizedMaskedChildContext=T),a}function Kv(s,a,c,g){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,g),a.state!==s&&ad.enqueueReplaceState(a,a.state,null)}function ip(s,a,c,g){var _=s.stateNode;_.props=c,_.state=s.memoizedState,_.refs={},Hf(s);var T=a.contextType;typeof T=="object"&&T!==null?_.context=Kn(T):(T=En(a)?Gs:tn.current,_.context=ta(s,T)),_.state=s.memoizedState,T=a.getDerivedStateFromProps,typeof T=="function"&&(rp(s,a,T,c),_.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&ad.enqueueReplaceState(_,_.state,null),ed(s,c,_,g),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308)}function ua(s,a){try{var c="",g=a;do c+=Oe(g),g=g.return;while(g);var _=c}catch(T){_=`
Error generating stack: `+T.message+`
`+T.stack}return{value:s,source:a,stack:_,digest:null}}function sp(s,a,c){return{value:s,source:null,stack:c??null,digest:a??null}}function op(s,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function Wv(s,a,c){c=ai(-1,c),c.tag=3,c.payload={element:null};var g=a.value;return c.callback=function(){pd||(pd=!0,Ep=g),op(s,a)},c}function jv(s,a,c){c=ai(-1,c),c.tag=3;var g=s.type.getDerivedStateFromError;if(typeof g=="function"){var _=a.value;c.payload=function(){return g(_)},c.callback=function(){op(s,a)}}var T=s.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(c.callback=function(){op(s,a),typeof g!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var A=a.stack;this.componentDidCatch(a.value,{componentStack:A!==null?A:""})}),c}function Jv(s,a,c){var g=s.pingCache;if(g===null){g=s.pingCache=new fC;var _=new Set;g.set(a,_)}else _=g.get(a),_===void 0&&(_=new Set,g.set(a,_));_.has(c)||(_.add(c),s=CC.bind(null,s,a,c),a.then(s,s))}function Qv(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function Yv(s,a,c,g,_){return(s.mode&1)===0?(s===a?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=ai(-1,1),a.tag=2,Hi(c,a,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=_,s)}var pC=ee.ReactCurrentOwner,Tn=!1;function hn(s,a,c,g){a.child=s===null?yv(a,null,c,g):sa(a,s.child,c,g)}function Xv(s,a,c,g,_){c=c.render;var T=a.ref;return aa(a,_),g=Yf(s,a,c,g,T,_),c=Xf(),s!==null&&!Tn?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~_,li(s,a,_)):(pt&&c&&Mf(a),a.flags|=1,hn(s,a,g,_),a.child)}function Zv(s,a,c,g,_){if(s===null){var T=c.type;return typeof T=="function"&&!Rp(T)&&T.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=T,e_(s,a,T,g,_)):(s=wd(c.type,null,g,a,a.mode,_),s.ref=a.ref,s.return=a,a.child=s)}if(T=s.child,(s.lanes&_)===0){var A=T.memoizedProps;if(c=c.compare,c=c!==null?c:Ol,c(A,g)&&s.ref===a.ref)return li(s,a,_)}return a.flags|=1,s=Qi(T,g),s.ref=a.ref,s.return=a,a.child=s}function e_(s,a,c,g,_){if(s!==null){var T=s.memoizedProps;if(Ol(T,g)&&s.ref===a.ref)if(Tn=!1,a.pendingProps=g=T,(s.lanes&_)!==0)(s.flags&131072)!==0&&(Tn=!0);else return a.lanes=s.lanes,li(s,a,_)}return ap(s,a,c,g,_)}function t_(s,a,c){var g=a.pendingProps,_=g.children,T=s!==null?s.memoizedState:null;if(g.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(da,Un),Un|=c;else{if((c&1073741824)===0)return s=T!==null?T.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,at(da,Un),Un|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:c,at(da,Un),Un|=g}else T!==null?(g=T.baseLanes|c,a.memoizedState=null):g=c,at(da,Un),Un|=g;return hn(s,a,_,c),a.child}function n_(s,a){var c=a.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function ap(s,a,c,g,_){var T=En(c)?Gs:tn.current;return T=ta(a,T),aa(a,_),c=Yf(s,a,c,g,T,_),g=Xf(),s!==null&&!Tn?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~_,li(s,a,_)):(pt&&g&&Mf(a),a.flags|=1,hn(s,a,c,_),a.child)}function r_(s,a,c,g,_){if(En(c)){var T=!0;$c(a)}else T=!1;if(aa(a,_),a.stateNode===null)ud(s,a),$v(a,c,g),ip(a,c,g,_),g=!0;else if(s===null){var A=a.stateNode,V=a.memoizedProps;A.props=V;var U=A.context,Q=c.contextType;typeof Q=="object"&&Q!==null?Q=Kn(Q):(Q=En(c)?Gs:tn.current,Q=ta(a,Q));var oe=c.getDerivedStateFromProps,le=typeof oe=="function"||typeof A.getSnapshotBeforeUpdate=="function";le||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V!==g||U!==Q)&&Kv(a,A,g,Q),zi=!1;var ie=a.memoizedState;A.state=ie,ed(a,g,A,_),U=a.memoizedState,V!==g||ie!==U||wn.current||zi?(typeof oe=="function"&&(rp(a,c,oe,g),U=a.memoizedState),(V=zi||Hv(a,c,V,g,ie,U,Q))?(le||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(a.flags|=4194308)):(typeof A.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=U),A.props=g,A.state=U,A.context=Q,g=V):(typeof A.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{A=a.stateNode,_v(s,a),V=a.memoizedProps,Q=a.type===a.elementType?V:ar(a.type,V),A.props=Q,le=a.pendingProps,ie=A.context,U=c.contextType,typeof U=="object"&&U!==null?U=Kn(U):(U=En(c)?Gs:tn.current,U=ta(a,U));var ve=c.getDerivedStateFromProps;(oe=typeof ve=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V!==le||ie!==U)&&Kv(a,A,g,U),zi=!1,ie=a.memoizedState,A.state=ie,ed(a,g,A,_);var Ee=a.memoizedState;V!==le||ie!==Ee||wn.current||zi?(typeof ve=="function"&&(rp(a,c,ve,g),Ee=a.memoizedState),(Q=zi||Hv(a,c,Q,g,ie,Ee,U)||!1)?(oe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,Ee,U),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,Ee,U)),typeof A.componentDidUpdate=="function"&&(a.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&ie===s.memoizedState||(a.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&ie===s.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=Ee),A.props=g,A.state=Ee,A.context=U,g=Q):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&ie===s.memoizedState||(a.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&ie===s.memoizedState||(a.flags|=1024),g=!1)}return lp(s,a,c,g,T,_)}function lp(s,a,c,g,_,T){n_(s,a);var A=(a.flags&128)!==0;if(!g&&!A)return _&&lv(a,c,!1),li(s,a,T);g=a.stateNode,pC.current=a;var V=A&&typeof c.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,s!==null&&A?(a.child=sa(a,s.child,null,T),a.child=sa(a,null,V,T)):hn(s,a,V,T),a.memoizedState=g.state,_&&lv(a,c,!0),a.child}function i_(s){var a=s.stateNode;a.pendingContext?ov(s,a.pendingContext,a.pendingContext!==a.context):a.context&&ov(s,a.context,!1),$f(s,a.containerInfo)}function s_(s,a,c,g,_){return ia(),Uf(_),a.flags|=256,hn(s,a,c,g),a.child}var up={dehydrated:null,treeContext:null,retryLane:0};function cp(s){return{baseLanes:s,cachePool:null,transitions:null}}function o_(s,a,c){var g=a.pendingProps,_=vt.current,T=!1,A=(a.flags&128)!==0,V;if((V=A)||(V=s!==null&&s.memoizedState===null?!1:(_&2)!==0),V?(T=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(_|=1),at(vt,_&1),s===null)return Ff(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((a.mode&1)===0?a.lanes=1:s.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(A=g.children,s=g.fallback,T?(g=a.mode,T=a.child,A={mode:"hidden",children:A},(g&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=A):T=Ed(A,g,0,null),s=Ys(s,g,c,null),T.return=a,s.return=a,T.sibling=s,a.child=T,a.child.memoizedState=cp(c),a.memoizedState=up,s):dp(a,A));if(_=s.memoizedState,_!==null&&(V=_.dehydrated,V!==null))return mC(s,a,A,g,V,_,c);if(T){T=g.fallback,A=a.mode,_=s.child,V=_.sibling;var U={mode:"hidden",children:g.children};return(A&1)===0&&a.child!==_?(g=a.child,g.childLanes=0,g.pendingProps=U,a.deletions=null):(g=Qi(_,U),g.subtreeFlags=_.subtreeFlags&14680064),V!==null?T=Qi(V,T):(T=Ys(T,A,c,null),T.flags|=2),T.return=a,g.return=a,g.sibling=T,a.child=g,g=T,T=a.child,A=s.child.memoizedState,A=A===null?cp(c):{baseLanes:A.baseLanes|c,cachePool:null,transitions:A.transitions},T.memoizedState=A,T.childLanes=s.childLanes&~c,a.memoizedState=up,g}return T=s.child,s=T.sibling,g=Qi(T,{mode:"visible",children:g.children}),(a.mode&1)===0&&(g.lanes=c),g.return=a,g.sibling=null,s!==null&&(c=a.deletions,c===null?(a.deletions=[s],a.flags|=16):c.push(s)),a.child=g,a.memoizedState=null,g}function dp(s,a){return a=Ed({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function ld(s,a,c,g){return g!==null&&Uf(g),sa(a,s.child,null,c),s=dp(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function mC(s,a,c,g,_,T,A){if(c)return a.flags&256?(a.flags&=-257,g=sp(Error(t(422))),ld(s,a,A,g)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(T=g.fallback,_=a.mode,g=Ed({mode:"visible",children:g.children},_,0,null),T=Ys(T,_,A,null),T.flags|=2,g.return=a,T.return=a,g.sibling=T,a.child=g,(a.mode&1)!==0&&sa(a,s.child,null,A),a.child.memoizedState=cp(A),a.memoizedState=up,T);if((a.mode&1)===0)return ld(s,a,A,null);if(_.data==="$!"){if(g=_.nextSibling&&_.nextSibling.dataset,g)var V=g.dgst;return g=V,T=Error(t(419)),g=sp(T,g,void 0),ld(s,a,A,g)}if(V=(A&s.childLanes)!==0,Tn||V){if(g=qt,g!==null){switch(A&-A){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(g.suspendedLanes|A))!==0?0:_,_!==0&&_!==T.retryLane&&(T.retryLane=_,oi(s,_),cr(g,s,_,-1))}return Cp(),g=sp(Error(t(421))),ld(s,a,A,g)}return _.data==="$?"?(a.flags|=128,a.child=s.child,a=RC.bind(null,s),_._reactRetry=a,null):(s=T.treeContext,Fn=Oi(_.nextSibling),Ln=a,pt=!0,or=null,s!==null&&(Hn[$n++]=ii,Hn[$n++]=si,Hn[$n++]=qs,ii=s.id,si=s.overflow,qs=a),a=dp(a,g.children),a.flags|=4096,a)}function a_(s,a,c){s.lanes|=a;var g=s.alternate;g!==null&&(g.lanes|=a),qf(s.return,a,c)}function hp(s,a,c,g,_){var T=s.memoizedState;T===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:_}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=c,T.tailMode=_)}function l_(s,a,c){var g=a.pendingProps,_=g.revealOrder,T=g.tail;if(hn(s,a,g.children,c),g=vt.current,(g&2)!==0)g=g&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&a_(s,c,a);else if(s.tag===19)a_(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}g&=1}if(at(vt,g),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(c=a.child,_=null;c!==null;)s=c.alternate,s!==null&&td(s)===null&&(_=c),c=c.sibling;c=_,c===null?(_=a.child,a.child=null):(_=c.sibling,c.sibling=null),hp(a,!1,_,c,T);break;case"backwards":for(c=null,_=a.child,a.child=null;_!==null;){if(s=_.alternate,s!==null&&td(s)===null){a.child=_;break}s=_.sibling,_.sibling=c,c=_,_=s}hp(a,!0,c,null,T);break;case"together":hp(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ud(s,a){(a.mode&1)===0&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function li(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),Ws|=a.lanes,(c&a.childLanes)===0)return null;if(s!==null&&a.child!==s.child)throw Error(t(153));if(a.child!==null){for(s=a.child,c=Qi(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=Qi(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function gC(s,a,c){switch(a.tag){case 3:i_(a),ia();break;case 5:Tv(a);break;case 1:En(a.type)&&$c(a);break;case 4:$f(a,a.stateNode.containerInfo);break;case 10:var g=a.type._context,_=a.memoizedProps.value;at(Yc,g._currentValue),g._currentValue=_;break;case 13:if(g=a.memoizedState,g!==null)return g.dehydrated!==null?(at(vt,vt.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?o_(s,a,c):(at(vt,vt.current&1),s=li(s,a,c),s!==null?s.sibling:null);at(vt,vt.current&1);break;case 19:if(g=(c&a.childLanes)!==0,(s.flags&128)!==0){if(g)return l_(s,a,c);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),at(vt,vt.current),g)break;return null;case 22:case 23:return a.lanes=0,t_(s,a,c)}return li(s,a,c)}var u_,fp,c_,d_;u_=function(s,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},fp=function(){},c_=function(s,a,c,g){var _=s.memoizedProps;if(_!==g){s=a.stateNode,$s(br.current);var T=null;switch(c){case"input":_=Nn(s,_),g=Nn(s,g),T=[];break;case"select":_=ge({},_,{value:void 0}),g=ge({},g,{value:void 0}),T=[];break;case"textarea":_=pl(s,_),g=pl(s,g),T=[];break;default:typeof _.onClick!="function"&&typeof g.onClick=="function"&&(s.onclick=qc)}nr(c,g);var A;c=null;for(Q in _)if(!g.hasOwnProperty(Q)&&_.hasOwnProperty(Q)&&_[Q]!=null)if(Q==="style"){var V=_[Q];for(A in V)V.hasOwnProperty(A)&&(c||(c={}),c[A]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(i.hasOwnProperty(Q)?T||(T=[]):(T=T||[]).push(Q,null));for(Q in g){var U=g[Q];if(V=_?.[Q],g.hasOwnProperty(Q)&&U!==V&&(U!=null||V!=null))if(Q==="style")if(V){for(A in V)!V.hasOwnProperty(A)||U&&U.hasOwnProperty(A)||(c||(c={}),c[A]="");for(A in U)U.hasOwnProperty(A)&&V[A]!==U[A]&&(c||(c={}),c[A]=U[A])}else c||(T||(T=[]),T.push(Q,c)),c=U;else Q==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,V=V?V.__html:void 0,U!=null&&V!==U&&(T=T||[]).push(Q,U)):Q==="children"?typeof U!="string"&&typeof U!="number"||(T=T||[]).push(Q,""+U):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(i.hasOwnProperty(Q)?(U!=null&&Q==="onScroll"&&dt("scroll",s),T||V===U||(T=[])):(T=T||[]).push(Q,U))}c&&(T=T||[]).push("style",c);var Q=T;(a.updateQueue=Q)&&(a.flags|=4)}},d_=function(s,a,c,g){c!==g&&(a.flags|=4)};function eu(s,a){if(!pt)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function rn(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,g=0;if(a)for(var _=s.child;_!==null;)c|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)c|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=g,s.childLanes=c,a}function yC(s,a,c){var g=a.pendingProps;switch(Vf(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(a),null;case 1:return En(a.type)&&Hc(),rn(a),null;case 3:return g=a.stateNode,la(),ht(wn),ht(tn),jf(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(s===null||s.child===null)&&(Jc(a)?a.flags|=4:s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,or!==null&&(Ip(or),or=null))),fp(s,a),rn(a),null;case 5:Kf(a);var _=$s(Jl.current);if(c=a.type,s!==null&&a.stateNode!=null)c_(s,a,c,g,_),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(t(166));return rn(a),null}if(s=$s(br.current),Jc(a)){g=a.stateNode,c=a.type;var T=a.memoizedProps;switch(g[kr]=a,g[Hl]=T,s=(a.mode&1)!==0,c){case"dialog":dt("cancel",g),dt("close",g);break;case"iframe":case"object":case"embed":dt("load",g);break;case"video":case"audio":for(_=0;_<Gl.length;_++)dt(Gl[_],g);break;case"source":dt("error",g);break;case"img":case"image":case"link":dt("error",g),dt("load",g);break;case"details":dt("toggle",g);break;case"input":Hr(g,T),dt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!T.multiple},dt("invalid",g);break;case"textarea":ml(g,T),dt("invalid",g)}nr(c,T),_=null;for(var A in T)if(T.hasOwnProperty(A)){var V=T[A];A==="children"?typeof V=="string"?g.textContent!==V&&(T.suppressHydrationWarning!==!0&&Gc(g.textContent,V,s),_=["children",V]):typeof V=="number"&&g.textContent!==""+V&&(T.suppressHydrationWarning!==!0&&Gc(g.textContent,V,s),_=["children",""+V]):i.hasOwnProperty(A)&&V!=null&&A==="onScroll"&&dt("scroll",g)}switch(c){case"input":je(g),Ss(g,T,!0);break;case"textarea":je(g),xi(g);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(g.onclick=qc)}g=_,a.updateQueue=g,g!==null&&(a.flags|=4)}else{A=_.nodeType===9?_:_.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=gl(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=A.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof g.is=="string"?s=A.createElement(c,{is:g.is}):(s=A.createElement(c),c==="select"&&(A=s,g.multiple?A.multiple=!0:g.size&&(A.size=g.size))):s=A.createElementNS(s,c),s[kr]=a,s[Hl]=g,u_(s,a,!1,!1),a.stateNode=s;e:{switch(A=ko(c,g),c){case"dialog":dt("cancel",s),dt("close",s),_=g;break;case"iframe":case"object":case"embed":dt("load",s),_=g;break;case"video":case"audio":for(_=0;_<Gl.length;_++)dt(Gl[_],s);_=g;break;case"source":dt("error",s),_=g;break;case"img":case"image":case"link":dt("error",s),dt("load",s),_=g;break;case"details":dt("toggle",s),_=g;break;case"input":Hr(s,g),_=Nn(s,g),dt("invalid",s);break;case"option":_=g;break;case"select":s._wrapperState={wasMultiple:!!g.multiple},_=ge({},g,{value:void 0}),dt("invalid",s);break;case"textarea":ml(s,g),_=pl(s,g),dt("invalid",s);break;default:_=g}nr(c,_),V=_;for(T in V)if(V.hasOwnProperty(T)){var U=V[T];T==="style"?Po(s,U):T==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&mc(s,U)):T==="children"?typeof U=="string"?(c!=="textarea"||U!=="")&&As(s,U):typeof U=="number"&&As(s,""+U):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(i.hasOwnProperty(T)?U!=null&&T==="onScroll"&&dt("scroll",s):U!=null&&H(s,T,U,A))}switch(c){case"input":je(s),Ss(s,g,!1);break;case"textarea":je(s),xi(s);break;case"option":g.value!=null&&s.setAttribute("value",""+He(g.value));break;case"select":s.multiple=!!g.multiple,T=g.value,T!=null?tr(s,!!g.multiple,T,!1):g.defaultValue!=null&&tr(s,!!g.multiple,g.defaultValue,!0);break;default:typeof _.onClick=="function"&&(s.onclick=qc)}switch(c){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return rn(a),null;case 6:if(s&&a.stateNode!=null)d_(s,a,s.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(t(166));if(c=$s(Jl.current),$s(br.current),Jc(a)){if(g=a.stateNode,c=a.memoizedProps,g[kr]=a,(T=g.nodeValue!==c)&&(s=Ln,s!==null))switch(s.tag){case 3:Gc(g.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Gc(g.nodeValue,c,(s.mode&1)!==0)}T&&(a.flags|=4)}else g=(c.nodeType===9?c:c.ownerDocument).createTextNode(g),g[kr]=a,a.stateNode=g}return rn(a),null;case 13:if(ht(vt),g=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(pt&&Fn!==null&&(a.mode&1)!==0&&(a.flags&128)===0)pv(),ia(),a.flags|=98560,T=!1;else if(T=Jc(a),g!==null&&g.dehydrated!==null){if(s===null){if(!T)throw Error(t(318));if(T=a.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[kr]=a}else ia(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;rn(a),T=!1}else or!==null&&(Ip(or),or=null),T=!0;if(!T)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(g=g!==null,g!==(s!==null&&s.memoizedState!==null)&&g&&(a.child.flags|=8192,(a.mode&1)!==0&&(s===null||(vt.current&1)!==0?Ut===0&&(Ut=3):Cp())),a.updateQueue!==null&&(a.flags|=4),rn(a),null);case 4:return la(),fp(s,a),s===null&&ql(a.stateNode.containerInfo),rn(a),null;case 10:return Gf(a.type._context),rn(a),null;case 17:return En(a.type)&&Hc(),rn(a),null;case 19:if(ht(vt),T=a.memoizedState,T===null)return rn(a),null;if(g=(a.flags&128)!==0,A=T.rendering,A===null)if(g)eu(T,!1);else{if(Ut!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(A=td(s),A!==null){for(a.flags|=128,eu(T,!1),g=A.updateQueue,g!==null&&(a.updateQueue=g,a.flags|=4),a.subtreeFlags=0,g=c,c=a.child;c!==null;)T=c,s=g,T.flags&=14680066,A=T.alternate,A===null?(T.childLanes=0,T.lanes=s,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=A.childLanes,T.lanes=A.lanes,T.child=A.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=A.memoizedProps,T.memoizedState=A.memoizedState,T.updateQueue=A.updateQueue,T.type=A.type,s=A.dependencies,T.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return at(vt,vt.current&1|2),a.child}s=s.sibling}T.tail!==null&&ct()>ha&&(a.flags|=128,g=!0,eu(T,!1),a.lanes=4194304)}else{if(!g)if(s=td(A),s!==null){if(a.flags|=128,g=!0,c=s.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),eu(T,!0),T.tail===null&&T.tailMode==="hidden"&&!A.alternate&&!pt)return rn(a),null}else 2*ct()-T.renderingStartTime>ha&&c!==1073741824&&(a.flags|=128,g=!0,eu(T,!1),a.lanes=4194304);T.isBackwards?(A.sibling=a.child,a.child=A):(c=T.last,c!==null?c.sibling=A:a.child=A,T.last=A)}return T.tail!==null?(a=T.tail,T.rendering=a,T.tail=a.sibling,T.renderingStartTime=ct(),a.sibling=null,c=vt.current,at(vt,g?c&1|2:c&1),a):(rn(a),null);case 22:case 23:return Ap(),g=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==g&&(a.flags|=8192),g&&(a.mode&1)!==0?(Un&1073741824)!==0&&(rn(a),a.subtreeFlags&6&&(a.flags|=8192)):rn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function vC(s,a){switch(Vf(a),a.tag){case 1:return En(a.type)&&Hc(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return la(),ht(wn),ht(tn),jf(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 5:return Kf(a),null;case 13:if(ht(vt),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(t(340));ia()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ht(vt),null;case 4:return la(),null;case 10:return Gf(a.type._context),null;case 22:case 23:return Ap(),null;case 24:return null;default:return null}}var cd=!1,sn=!1,_C=typeof WeakSet=="function"?WeakSet:Set,we=null;function ca(s,a){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(g){Et(s,a,g)}else c.current=null}function pp(s,a,c){try{c()}catch(g){Et(s,a,g)}}var h_=!1;function wC(s,a){if(Af=Zr,s=Hy(),vf(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var _=g.anchorOffset,T=g.focusNode;g=g.focusOffset;try{c.nodeType,T.nodeType}catch{c=null;break e}var A=0,V=-1,U=-1,Q=0,oe=0,le=s,ie=null;t:for(;;){for(var ve;le!==c||_!==0&&le.nodeType!==3||(V=A+_),le!==T||g!==0&&le.nodeType!==3||(U=A+g),le.nodeType===3&&(A+=le.nodeValue.length),(ve=le.firstChild)!==null;)ie=le,le=ve;for(;;){if(le===s)break t;if(ie===c&&++Q===_&&(V=A),ie===T&&++oe===g&&(U=A),(ve=le.nextSibling)!==null)break;le=ie,ie=le.parentNode}le=ve}c=V===-1||U===-1?null:{start:V,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(Cf={focusedElem:s,selectionRange:c},Zr=!1,we=a;we!==null;)if(a=we,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,we=s;else for(;we!==null;){a=we;try{var Ee=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Ee!==null){var xe=Ee.memoizedProps,St=Ee.memoizedState,K=a.stateNode,O=K.getSnapshotBeforeUpdate(a.elementType===a.type?xe:ar(a.type,xe),St);K.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var J=a.stateNode.containerInfo;J.nodeType===1?J.textContent="":J.nodeType===9&&J.documentElement&&J.removeChild(J.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ue){Et(a,a.return,ue)}if(s=a.sibling,s!==null){s.return=a.return,we=s;break}we=a.return}return Ee=h_,h_=!1,Ee}function tu(s,a,c){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&s)===s){var T=_.destroy;_.destroy=void 0,T!==void 0&&pp(a,c,T)}_=_.next}while(_!==g)}}function dd(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&s)===s){var g=c.create;c.destroy=g()}c=c.next}while(c!==a)}}function mp(s){var a=s.ref;if(a!==null){var c=s.stateNode;s.tag,s=c,typeof a=="function"?a(s):a.current=s}}function f_(s){var a=s.alternate;a!==null&&(s.alternate=null,f_(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&(delete a[kr],delete a[Hl],delete a[kf],delete a[nC],delete a[rC])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function p_(s){return s.tag===5||s.tag===3||s.tag===4}function m_(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||p_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gp(s,a,c){var g=s.tag;if(g===5||g===6)s=s.stateNode,a?c.nodeType===8?c.parentNode.insertBefore(s,a):c.insertBefore(s,a):(c.nodeType===8?(a=c.parentNode,a.insertBefore(s,c)):(a=c,a.appendChild(s)),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=qc));else if(g!==4&&(s=s.child,s!==null))for(gp(s,a,c),s=s.sibling;s!==null;)gp(s,a,c),s=s.sibling}function yp(s,a,c){var g=s.tag;if(g===5||g===6)s=s.stateNode,a?c.insertBefore(s,a):c.appendChild(s);else if(g!==4&&(s=s.child,s!==null))for(yp(s,a,c),s=s.sibling;s!==null;)yp(s,a,c),s=s.sibling}var Jt=null,lr=!1;function $i(s,a,c){for(c=c.child;c!==null;)g_(s,a,c),c=c.sibling}function g_(s,a,c){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(ks,c)}catch{}switch(c.tag){case 5:sn||ca(c,a);case 6:var g=Jt,_=lr;Jt=null,$i(s,a,c),Jt=g,lr=_,Jt!==null&&(lr?(s=Jt,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):Jt.removeChild(c.stateNode));break;case 18:Jt!==null&&(lr?(s=Jt,c=c.stateNode,s.nodeType===8?Pf(s.parentNode,c):s.nodeType===1&&Pf(s,c),Vi(s)):Pf(Jt,c.stateNode));break;case 4:g=Jt,_=lr,Jt=c.stateNode.containerInfo,lr=!0,$i(s,a,c),Jt=g,lr=_;break;case 0:case 11:case 14:case 15:if(!sn&&(g=c.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var T=_,A=T.destroy;T=T.tag,A!==void 0&&((T&2)!==0||(T&4)!==0)&&pp(c,a,A),_=_.next}while(_!==g)}$i(s,a,c);break;case 1:if(!sn&&(ca(c,a),g=c.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=c.memoizedProps,g.state=c.memoizedState,g.componentWillUnmount()}catch(V){Et(c,a,V)}$i(s,a,c);break;case 21:$i(s,a,c);break;case 22:c.mode&1?(sn=(g=sn)||c.memoizedState!==null,$i(s,a,c),sn=g):$i(s,a,c);break;default:$i(s,a,c)}}function y_(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new _C),a.forEach(function(g){var _=NC.bind(null,s,g);c.has(g)||(c.add(g),g.then(_,_))})}}function ur(s,a){var c=a.deletions;if(c!==null)for(var g=0;g<c.length;g++){var _=c[g];try{var T=s,A=a,V=A;e:for(;V!==null;){switch(V.tag){case 5:Jt=V.stateNode,lr=!1;break e;case 3:Jt=V.stateNode.containerInfo,lr=!0;break e;case 4:Jt=V.stateNode.containerInfo,lr=!0;break e}V=V.return}if(Jt===null)throw Error(t(160));g_(T,A,_),Jt=null,lr=!1;var U=_.alternate;U!==null&&(U.return=null),_.return=null}catch(Q){Et(_,a,Q)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)v_(a,s),a=a.sibling}function v_(s,a){var c=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ur(a,s),Mr(s),g&4){try{tu(3,s,s.return),dd(3,s)}catch(xe){Et(s,s.return,xe)}try{tu(5,s,s.return)}catch(xe){Et(s,s.return,xe)}}break;case 1:ur(a,s),Mr(s),g&512&&c!==null&&ca(c,c.return);break;case 5:if(ur(a,s),Mr(s),g&512&&c!==null&&ca(c,c.return),s.flags&32){var _=s.stateNode;try{As(_,"")}catch(xe){Et(s,s.return,xe)}}if(g&4&&(_=s.stateNode,_!=null)){var T=s.memoizedProps,A=c!==null?c.memoizedProps:T,V=s.type,U=s.updateQueue;if(s.updateQueue=null,U!==null)try{V==="input"&&T.type==="radio"&&T.name!=null&&Ti(_,T),ko(V,A);var Q=ko(V,T);for(A=0;A<U.length;A+=2){var oe=U[A],le=U[A+1];oe==="style"?Po(_,le):oe==="dangerouslySetInnerHTML"?mc(_,le):oe==="children"?As(_,le):H(_,oe,le,Q)}switch(V){case"input":$r(_,T);break;case"textarea":pc(_,T);break;case"select":var ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!T.multiple;var ve=T.value;ve!=null?tr(_,!!T.multiple,ve,!1):ie!==!!T.multiple&&(T.defaultValue!=null?tr(_,!!T.multiple,T.defaultValue,!0):tr(_,!!T.multiple,T.multiple?[]:"",!1))}_[Hl]=T}catch(xe){Et(s,s.return,xe)}}break;case 6:if(ur(a,s),Mr(s),g&4){if(s.stateNode===null)throw Error(t(162));_=s.stateNode,T=s.memoizedProps;try{_.nodeValue=T}catch(xe){Et(s,s.return,xe)}}break;case 3:if(ur(a,s),Mr(s),g&4&&c!==null&&c.memoizedState.isDehydrated)try{Vi(a.containerInfo)}catch(xe){Et(s,s.return,xe)}break;case 4:ur(a,s),Mr(s);break;case 13:ur(a,s),Mr(s),_=s.child,_.flags&8192&&(T=_.memoizedState!==null,_.stateNode.isHidden=T,!T||_.alternate!==null&&_.alternate.memoizedState!==null||(wp=ct())),g&4&&y_(s);break;case 22:if(oe=c!==null&&c.memoizedState!==null,s.mode&1?(sn=(Q=sn)||oe,ur(a,s),sn=Q):ur(a,s),Mr(s),g&8192){if(Q=s.memoizedState!==null,(s.stateNode.isHidden=Q)&&!oe&&(s.mode&1)!==0)for(we=s,oe=s.child;oe!==null;){for(le=we=oe;we!==null;){switch(ie=we,ve=ie.child,ie.tag){case 0:case 11:case 14:case 15:tu(4,ie,ie.return);break;case 1:ca(ie,ie.return);var Ee=ie.stateNode;if(typeof Ee.componentWillUnmount=="function"){g=ie,c=ie.return;try{a=g,Ee.props=a.memoizedProps,Ee.state=a.memoizedState,Ee.componentWillUnmount()}catch(xe){Et(g,c,xe)}}break;case 5:ca(ie,ie.return);break;case 22:if(ie.memoizedState!==null){E_(le);continue}}ve!==null?(ve.return=ie,we=ve):E_(le)}oe=oe.sibling}e:for(oe=null,le=s;;){if(le.tag===5){if(oe===null){oe=le;try{_=le.stateNode,Q?(T=_.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(V=le.stateNode,U=le.memoizedProps.style,A=U!=null&&U.hasOwnProperty("display")?U.display:null,V.style.display=Ai("display",A))}catch(xe){Et(s,s.return,xe)}}}else if(le.tag===6){if(oe===null)try{le.stateNode.nodeValue=Q?"":le.memoizedProps}catch(xe){Et(s,s.return,xe)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===s)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===s)break e;for(;le.sibling===null;){if(le.return===null||le.return===s)break e;oe===le&&(oe=null),le=le.return}oe===le&&(oe=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:ur(a,s),Mr(s),g&4&&y_(s);break;case 21:break;default:ur(a,s),Mr(s)}}function Mr(s){var a=s.flags;if(a&2){try{e:{for(var c=s.return;c!==null;){if(p_(c)){var g=c;break e}c=c.return}throw Error(t(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(As(_,""),g.flags&=-33);var T=m_(s);yp(s,T,_);break;case 3:case 4:var A=g.stateNode.containerInfo,V=m_(s);gp(s,V,A);break;default:throw Error(t(161))}}catch(U){Et(s,s.return,U)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function EC(s,a,c){we=s,__(s)}function __(s,a,c){for(var g=(s.mode&1)!==0;we!==null;){var _=we,T=_.child;if(_.tag===22&&g){var A=_.memoizedState!==null||cd;if(!A){var V=_.alternate,U=V!==null&&V.memoizedState!==null||sn;V=cd;var Q=sn;if(cd=A,(sn=U)&&!Q)for(we=_;we!==null;)A=we,U=A.child,A.tag===22&&A.memoizedState!==null?T_(_):U!==null?(U.return=A,we=U):T_(_);for(;T!==null;)we=T,__(T),T=T.sibling;we=_,cd=V,sn=Q}w_(s)}else(_.subtreeFlags&8772)!==0&&T!==null?(T.return=_,we=T):w_(s)}}function w_(s){for(;we!==null;){var a=we;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:sn||dd(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!sn)if(c===null)g.componentDidMount();else{var _=a.elementType===a.type?c.memoizedProps:ar(a.type,c.memoizedProps);g.componentDidUpdate(_,c.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=a.updateQueue;T!==null&&Ev(a,T,g);break;case 3:var A=a.updateQueue;if(A!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=a.child.stateNode;break;case 1:c=a.child.stateNode}Ev(a,A,c)}break;case 5:var V=a.stateNode;if(c===null&&a.flags&4){c=V;var U=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&c.focus();break;case"img":U.src&&(c.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Q=a.alternate;if(Q!==null){var oe=Q.memoizedState;if(oe!==null){var le=oe.dehydrated;le!==null&&Vi(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}sn||a.flags&512&&mp(a)}catch(ie){Et(a,a.return,ie)}}if(a===s){we=null;break}if(c=a.sibling,c!==null){c.return=a.return,we=c;break}we=a.return}}function E_(s){for(;we!==null;){var a=we;if(a===s){we=null;break}var c=a.sibling;if(c!==null){c.return=a.return,we=c;break}we=a.return}}function T_(s){for(;we!==null;){var a=we;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{dd(4,a)}catch(U){Et(a,c,U)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var _=a.return;try{g.componentDidMount()}catch(U){Et(a,_,U)}}var T=a.return;try{mp(a)}catch(U){Et(a,T,U)}break;case 5:var A=a.return;try{mp(a)}catch(U){Et(a,A,U)}}}catch(U){Et(a,a.return,U)}if(a===s){we=null;break}var V=a.sibling;if(V!==null){V.return=a.return,we=V;break}we=a.return}}var TC=Math.ceil,hd=ee.ReactCurrentDispatcher,vp=ee.ReactCurrentOwner,jn=ee.ReactCurrentBatchConfig,Qe=0,qt=null,Dt=null,Qt=0,Un=0,da=Bi(0),Ut=0,nu=null,Ws=0,fd=0,_p=0,ru=null,xn=null,wp=0,ha=1/0,ui=null,pd=!1,Ep=null,Ki=null,md=!1,Wi=null,gd=0,iu=0,Tp=null,yd=-1,vd=0;function fn(){return(Qe&6)!==0?ct():yd!==-1?yd:yd=ct()}function ji(s){return(s.mode&1)===0?1:(Qe&2)!==0&&Qt!==0?Qt&-Qt:sC.transition!==null?(vd===0&&(vd=Sl()),vd):(s=$e,s!==0||(s=window.event,s=s===void 0?16:Go(s.type)),s)}function cr(s,a,c,g){if(50<iu)throw iu=0,Tp=null,Error(t(185));Vs(s,c,g),((Qe&2)===0||s!==qt)&&(s===qt&&((Qe&2)===0&&(fd|=c),Ut===4&&Ji(s,Qt)),In(s,g),c===1&&Qe===0&&(a.mode&1)===0&&(ha=ct()+500,Kc&&qi()))}function In(s,a){var c=s.callbackNode;Ms(s,a);var g=Qr(s,s===qt?Qt:0);if(g===0)c!==null&&Mo(c),s.callbackNode=null,s.callbackPriority=0;else if(a=g&-g,s.callbackPriority!==a){if(c!=null&&Mo(c),a===1)s.tag===0?iC(I_.bind(null,s)):uv(I_.bind(null,s)),eC(function(){(Qe&6)===0&&qi()}),c=null;else{switch(Er(g)){case 1:c=Vo;break;case 4:c=Tl;break;case 16:c=Ps;break;case 536870912:c=Lo;break;default:c=Ps}c=b_(c,x_.bind(null,s))}s.callbackPriority=a,s.callbackNode=c}}function x_(s,a){if(yd=-1,vd=0,(Qe&6)!==0)throw Error(t(327));var c=s.callbackNode;if(fa()&&s.callbackNode!==c)return null;var g=Qr(s,s===qt?Qt:0);if(g===0)return null;if((g&30)!==0||(g&s.expiredLanes)!==0||a)a=_d(s,g);else{a=g;var _=Qe;Qe|=2;var T=A_();(qt!==s||Qt!==a)&&(ui=null,ha=ct()+500,Js(s,a));do try{SC();break}catch(V){S_(s,V)}while(!0);Bf(),hd.current=T,Qe=_,Dt!==null?a=0:(qt=null,Qt=0,a=Ut)}if(a!==0){if(a===2&&(_=Il(s),_!==0&&(g=_,a=xp(s,_))),a===1)throw c=nu,Js(s,0),Ji(s,g),In(s,ct()),c;if(a===6)Ji(s,g);else{if(_=s.current.alternate,(g&30)===0&&!xC(_)&&(a=_d(s,g),a===2&&(T=Il(s),T!==0&&(g=T,a=xp(s,T))),a===1))throw c=nu,Js(s,0),Ji(s,g),In(s,ct()),c;switch(s.finishedWork=_,s.finishedLanes=g,a){case 0:case 1:throw Error(t(345));case 2:Qs(s,xn,ui);break;case 3:if(Ji(s,g),(g&130023424)===g&&(a=wp+500-ct(),10<a)){if(Qr(s,0)!==0)break;if(_=s.suspendedLanes,(_&g)!==g){fn(),s.pingedLanes|=s.suspendedLanes&_;break}s.timeoutHandle=Nf(Qs.bind(null,s,xn,ui),a);break}Qs(s,xn,ui);break;case 4:if(Ji(s,g),(g&4194240)===g)break;for(a=s.eventTimes,_=-1;0<g;){var A=31-kn(g);T=1<<A,A=a[A],A>_&&(_=A),g&=~T}if(g=_,g=ct()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*TC(g/1960))-g,10<g){s.timeoutHandle=Nf(Qs.bind(null,s,xn,ui),g);break}Qs(s,xn,ui);break;case 5:Qs(s,xn,ui);break;default:throw Error(t(329))}}}return In(s,ct()),s.callbackNode===c?x_.bind(null,s):null}function xp(s,a){var c=ru;return s.current.memoizedState.isDehydrated&&(Js(s,a).flags|=256),s=_d(s,a),s!==2&&(a=xn,xn=c,a!==null&&Ip(a)),s}function Ip(s){xn===null?xn=s:xn.push.apply(xn,s)}function xC(s){for(var a=s;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var g=0;g<c.length;g++){var _=c[g],T=_.getSnapshot;_=_.value;try{if(!sr(T(),_))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ji(s,a){for(a&=~_p,a&=~fd,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var c=31-kn(a),g=1<<c;s[c]=-1,a&=~g}}function I_(s){if((Qe&6)!==0)throw Error(t(327));fa();var a=Qr(s,0);if((a&1)===0)return In(s,ct()),null;var c=_d(s,a);if(s.tag!==0&&c===2){var g=Il(s);g!==0&&(a=g,c=xp(s,g))}if(c===1)throw c=nu,Js(s,0),Ji(s,a),In(s,ct()),c;if(c===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,Qs(s,xn,ui),In(s,ct()),null}function Sp(s,a){var c=Qe;Qe|=1;try{return s(a)}finally{Qe=c,Qe===0&&(ha=ct()+500,Kc&&qi())}}function js(s){Wi!==null&&Wi.tag===0&&(Qe&6)===0&&fa();var a=Qe;Qe|=1;var c=jn.transition,g=$e;try{if(jn.transition=null,$e=1,s)return s()}finally{$e=g,jn.transition=c,Qe=a,(Qe&6)===0&&qi()}}function Ap(){Un=da.current,ht(da)}function Js(s,a){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,ZA(c)),Dt!==null)for(c=Dt.return;c!==null;){var g=c;switch(Vf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Hc();break;case 3:la(),ht(wn),ht(tn),jf();break;case 5:Kf(g);break;case 4:la();break;case 13:ht(vt);break;case 19:ht(vt);break;case 10:Gf(g.type._context);break;case 22:case 23:Ap()}c=c.return}if(qt=s,Dt=s=Qi(s.current,null),Qt=Un=a,Ut=0,nu=null,_p=fd=Ws=0,xn=ru=null,Hs!==null){for(a=0;a<Hs.length;a++)if(c=Hs[a],g=c.interleaved,g!==null){c.interleaved=null;var _=g.next,T=c.pending;if(T!==null){var A=T.next;T.next=_,g.next=A}c.pending=g}Hs=null}return s}function S_(s,a){do{var c=Dt;try{if(Bf(),nd.current=od,rd){for(var g=_t.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}rd=!1}if(Ks=0,Gt=Ft=_t=null,Ql=!1,Yl=0,vp.current=null,c===null||c.return===null){Ut=1,nu=a,Dt=null;break}e:{var T=s,A=c.return,V=c,U=a;if(a=Qt,V.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var Q=U,oe=V,le=oe.tag;if((oe.mode&1)===0&&(le===0||le===11||le===15)){var ie=oe.alternate;ie?(oe.updateQueue=ie.updateQueue,oe.memoizedState=ie.memoizedState,oe.lanes=ie.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ve=Qv(A);if(ve!==null){ve.flags&=-257,Yv(ve,A,V,T,a),ve.mode&1&&Jv(T,Q,a),a=ve,U=Q;var Ee=a.updateQueue;if(Ee===null){var xe=new Set;xe.add(U),a.updateQueue=xe}else Ee.add(U);break e}else{if((a&1)===0){Jv(T,Q,a),Cp();break e}U=Error(t(426))}}else if(pt&&V.mode&1){var St=Qv(A);if(St!==null){(St.flags&65536)===0&&(St.flags|=256),Yv(St,A,V,T,a),Uf(ua(U,V));break e}}T=U=ua(U,V),Ut!==4&&(Ut=2),ru===null?ru=[T]:ru.push(T),T=A;do{switch(T.tag){case 3:T.flags|=65536,a&=-a,T.lanes|=a;var K=Wv(T,U,a);wv(T,K);break e;case 1:V=U;var O=T.type,J=T.stateNode;if((T.flags&128)===0&&(typeof O.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ki===null||!Ki.has(J)))){T.flags|=65536,a&=-a,T.lanes|=a;var ue=jv(T,V,a);wv(T,ue);break e}}T=T.return}while(T!==null)}R_(c)}catch(Se){a=Se,Dt===c&&c!==null&&(Dt=c=c.return);continue}break}while(!0)}function A_(){var s=hd.current;return hd.current=od,s===null?od:s}function Cp(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),qt===null||(Ws&268435455)===0&&(fd&268435455)===0||Ji(qt,Qt)}function _d(s,a){var c=Qe;Qe|=2;var g=A_();(qt!==s||Qt!==a)&&(ui=null,Js(s,a));do try{IC();break}catch(_){S_(s,_)}while(!0);if(Bf(),Qe=c,hd.current=g,Dt!==null)throw Error(t(261));return qt=null,Qt=0,Ut}function IC(){for(;Dt!==null;)C_(Dt)}function SC(){for(;Dt!==null&&!Ns();)C_(Dt)}function C_(s){var a=k_(s.alternate,s,Un);s.memoizedProps=s.pendingProps,a===null?R_(s):Dt=a,vp.current=null}function R_(s){var a=s;do{var c=a.alternate;if(s=a.return,(a.flags&32768)===0){if(c=yC(c,a,Un),c!==null){Dt=c;return}}else{if(c=vC(c,a),c!==null){c.flags&=32767,Dt=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Ut=6,Dt=null;return}}if(a=a.sibling,a!==null){Dt=a;return}Dt=a=s}while(a!==null);Ut===0&&(Ut=5)}function Qs(s,a,c){var g=$e,_=jn.transition;try{jn.transition=null,$e=1,AC(s,a,c,g)}finally{jn.transition=_,$e=g}return null}function AC(s,a,c,g){do fa();while(Wi!==null);if((Qe&6)!==0)throw Error(t(327));c=s.finishedWork;var _=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var T=c.lanes|c.childLanes;if(ff(s,T),s===qt&&(Dt=qt=null,Qt=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||md||(md=!0,b_(Ps,function(){return fa(),null})),T=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||T){T=jn.transition,jn.transition=null;var A=$e;$e=1;var V=Qe;Qe|=4,vp.current=null,wC(s,c),v_(c,s),KA(Cf),Zr=!!Af,Cf=Af=null,s.current=c,EC(c),Jr(),Qe=V,$e=A,jn.transition=T}else s.current=c;if(md&&(md=!1,Wi=s,gd=_),T=s.pendingLanes,T===0&&(Ki=null),Ac(c.stateNode),In(s,ct()),a!==null)for(g=s.onRecoverableError,c=0;c<a.length;c++)_=a[c],g(_.value,{componentStack:_.stack,digest:_.digest});if(pd)throw pd=!1,s=Ep,Ep=null,s;return(gd&1)!==0&&s.tag!==0&&fa(),T=s.pendingLanes,(T&1)!==0?s===Tp?iu++:(iu=0,Tp=s):iu=0,qi(),null}function fa(){if(Wi!==null){var s=Er(gd),a=jn.transition,c=$e;try{if(jn.transition=null,$e=16>s?16:s,Wi===null)var g=!1;else{if(s=Wi,Wi=null,gd=0,(Qe&6)!==0)throw Error(t(331));var _=Qe;for(Qe|=4,we=s.current;we!==null;){var T=we,A=T.child;if((we.flags&16)!==0){var V=T.deletions;if(V!==null){for(var U=0;U<V.length;U++){var Q=V[U];for(we=Q;we!==null;){var oe=we;switch(oe.tag){case 0:case 11:case 15:tu(8,oe,T)}var le=oe.child;if(le!==null)le.return=oe,we=le;else for(;we!==null;){oe=we;var ie=oe.sibling,ve=oe.return;if(f_(oe),oe===Q){we=null;break}if(ie!==null){ie.return=ve,we=ie;break}we=ve}}}var Ee=T.alternate;if(Ee!==null){var xe=Ee.child;if(xe!==null){Ee.child=null;do{var St=xe.sibling;xe.sibling=null,xe=St}while(xe!==null)}}we=T}}if((T.subtreeFlags&2064)!==0&&A!==null)A.return=T,we=A;else e:for(;we!==null;){if(T=we,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:tu(9,T,T.return)}var K=T.sibling;if(K!==null){K.return=T.return,we=K;break e}we=T.return}}var O=s.current;for(we=O;we!==null;){A=we;var J=A.child;if((A.subtreeFlags&2064)!==0&&J!==null)J.return=A,we=J;else e:for(A=O;we!==null;){if(V=we,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:dd(9,V)}}catch(Se){Et(V,V.return,Se)}if(V===A){we=null;break e}var ue=V.sibling;if(ue!==null){ue.return=V.return,we=ue;break e}we=V.return}}if(Qe=_,qi(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(ks,s)}catch{}g=!0}return g}finally{$e=c,jn.transition=a}}return!1}function N_(s,a,c){a=ua(c,a),a=Wv(s,a,1),s=Hi(s,a,1),a=fn(),s!==null&&(Vs(s,1,a),In(s,a))}function Et(s,a,c){if(s.tag===3)N_(s,s,c);else for(;a!==null;){if(a.tag===3){N_(a,s,c);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ki===null||!Ki.has(g))){s=ua(c,s),s=jv(a,s,1),a=Hi(a,s,1),s=fn(),a!==null&&(Vs(a,1,s),In(a,s));break}}a=a.return}}function CC(s,a,c){var g=s.pingCache;g!==null&&g.delete(a),a=fn(),s.pingedLanes|=s.suspendedLanes&c,qt===s&&(Qt&c)===c&&(Ut===4||Ut===3&&(Qt&130023424)===Qt&&500>ct()-wp?Js(s,0):_p|=c),In(s,a)}function P_(s,a){a===0&&((s.mode&1)===0?a=1:(a=bi,bi<<=1,(bi&130023424)===0&&(bi=4194304)));var c=fn();s=oi(s,a),s!==null&&(Vs(s,a,c),In(s,c))}function RC(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),P_(s,c)}function NC(s,a){var c=0;switch(s.tag){case 13:var g=s.stateNode,_=s.memoizedState;_!==null&&(c=_.retryLane);break;case 19:g=s.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(a),P_(s,c)}var k_;k_=function(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps||wn.current)Tn=!0;else{if((s.lanes&c)===0&&(a.flags&128)===0)return Tn=!1,gC(s,a,c);Tn=(s.flags&131072)!==0}else Tn=!1,pt&&(a.flags&1048576)!==0&&cv(a,jc,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;ud(s,a),s=a.pendingProps;var _=ta(a,tn.current);aa(a,c),_=Yf(null,a,g,s,_,c);var T=Xf();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,En(g)?(T=!0,$c(a)):T=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Hf(a),_.updater=ad,a.stateNode=_,_._reactInternals=a,ip(a,g,s,c),a=lp(null,a,g,!0,T,c)):(a.tag=0,pt&&T&&Mf(a),hn(null,a,_,c),a=a.child),a;case 16:g=a.elementType;e:{switch(ud(s,a),s=a.pendingProps,_=g._init,g=_(g._payload),a.type=g,_=a.tag=kC(g),s=ar(g,s),_){case 0:a=ap(null,a,g,s,c);break e;case 1:a=r_(null,a,g,s,c);break e;case 11:a=Xv(null,a,g,s,c);break e;case 14:a=Zv(null,a,g,ar(g.type,s),c);break e}throw Error(t(306,g,""))}return a;case 0:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ar(g,_),ap(s,a,g,_,c);case 1:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ar(g,_),r_(s,a,g,_,c);case 3:e:{if(i_(a),s===null)throw Error(t(387));g=a.pendingProps,T=a.memoizedState,_=T.element,_v(s,a),ed(a,g,null,c);var A=a.memoizedState;if(g=A.element,T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){_=ua(Error(t(423)),a),a=s_(s,a,g,c,_);break e}else if(g!==_){_=ua(Error(t(424)),a),a=s_(s,a,g,c,_);break e}else for(Fn=Oi(a.stateNode.containerInfo.firstChild),Ln=a,pt=!0,or=null,c=yv(a,null,g,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ia(),g===_){a=li(s,a,c);break e}hn(s,a,g,c)}a=a.child}return a;case 5:return Tv(a),s===null&&Ff(a),g=a.type,_=a.pendingProps,T=s!==null?s.memoizedProps:null,A=_.children,Rf(g,_)?A=null:T!==null&&Rf(g,T)&&(a.flags|=32),n_(s,a),hn(s,a,A,c),a.child;case 6:return s===null&&Ff(a),null;case 13:return o_(s,a,c);case 4:return $f(a,a.stateNode.containerInfo),g=a.pendingProps,s===null?a.child=sa(a,null,g,c):hn(s,a,g,c),a.child;case 11:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ar(g,_),Xv(s,a,g,_,c);case 7:return hn(s,a,a.pendingProps,c),a.child;case 8:return hn(s,a,a.pendingProps.children,c),a.child;case 12:return hn(s,a,a.pendingProps.children,c),a.child;case 10:e:{if(g=a.type._context,_=a.pendingProps,T=a.memoizedProps,A=_.value,at(Yc,g._currentValue),g._currentValue=A,T!==null)if(sr(T.value,A)){if(T.children===_.children&&!wn.current){a=li(s,a,c);break e}}else for(T=a.child,T!==null&&(T.return=a);T!==null;){var V=T.dependencies;if(V!==null){A=T.child;for(var U=V.firstContext;U!==null;){if(U.context===g){if(T.tag===1){U=ai(-1,c&-c),U.tag=2;var Q=T.updateQueue;if(Q!==null){Q=Q.shared;var oe=Q.pending;oe===null?U.next=U:(U.next=oe.next,oe.next=U),Q.pending=U}}T.lanes|=c,U=T.alternate,U!==null&&(U.lanes|=c),qf(T.return,c,a),V.lanes|=c;break}U=U.next}}else if(T.tag===10)A=T.type===a.type?null:T.child;else if(T.tag===18){if(A=T.return,A===null)throw Error(t(341));A.lanes|=c,V=A.alternate,V!==null&&(V.lanes|=c),qf(A,c,a),A=T.sibling}else A=T.child;if(A!==null)A.return=T;else for(A=T;A!==null;){if(A===a){A=null;break}if(T=A.sibling,T!==null){T.return=A.return,A=T;break}A=A.return}T=A}hn(s,a,_.children,c),a=a.child}return a;case 9:return _=a.type,g=a.pendingProps.children,aa(a,c),_=Kn(_),g=g(_),a.flags|=1,hn(s,a,g,c),a.child;case 14:return g=a.type,_=ar(g,a.pendingProps),_=ar(g.type,_),Zv(s,a,g,_,c);case 15:return e_(s,a,a.type,a.pendingProps,c);case 17:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ar(g,_),ud(s,a),a.tag=1,En(g)?(s=!0,$c(a)):s=!1,aa(a,c),$v(a,g,_),ip(a,g,_,c),lp(null,a,g,!0,s,c);case 19:return l_(s,a,c);case 22:return t_(s,a,c)}throw Error(t(156,a.tag))};function b_(s,a){return El(s,a)}function PC(s,a,c,g){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(s,a,c,g){return new PC(s,a,c,g)}function Rp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function kC(s){if(typeof s=="function")return Rp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===G)return 11;if(s===Z)return 14}return 2}function Qi(s,a){var c=s.alternate;return c===null?(c=Jn(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function wd(s,a,c,g,_,T){var A=2;if(g=s,typeof s=="function")Rp(s)&&(A=1);else if(typeof s=="string")A=5;else e:switch(s){case b:return Ys(c.children,_,T,a);case R:A=8,_|=8;break;case P:return s=Jn(12,c,a,_|2),s.elementType=P,s.lanes=T,s;case D:return s=Jn(13,c,a,_),s.elementType=D,s.lanes=T,s;case Fe:return s=Jn(19,c,a,_),s.elementType=Fe,s.lanes=T,s;case Ie:return Ed(c,_,T,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:A=10;break e;case F:A=9;break e;case G:A=11;break e;case Z:A=14;break e;case fe:A=16,g=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return a=Jn(A,c,a,_),a.elementType=s,a.type=g,a.lanes=T,a}function Ys(s,a,c,g){return s=Jn(7,s,g,a),s.lanes=c,s}function Ed(s,a,c,g){return s=Jn(22,s,g,a),s.elementType=Ie,s.lanes=c,s.stateNode={isHidden:!1},s}function Np(s,a,c){return s=Jn(6,s,null,a),s.lanes=c,s}function Pp(s,a,c){return a=Jn(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function bC(s,a,c,g,_){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Al(0),this.expirationTimes=Al(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Al(0),this.identifierPrefix=g,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function kp(s,a,c,g,_,T,A,V,U){return s=new bC(s,a,c,V,U),a===1?(a=1,T===!0&&(a|=8)):a=0,T=Jn(3,null,null,a),s.current=T,T.stateNode=s,T.memoizedState={element:g,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(T),s}function DC(s,a,c){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:g==null?null:""+g,children:s,containerInfo:a,implementation:c}}function D_(s){if(!s)return Gi;s=s._reactInternals;e:{if(rr(s)!==s||s.tag!==1)throw Error(t(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(En(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(s.tag===1){var c=s.type;if(En(c))return av(s,c,a)}return a}function M_(s,a,c,g,_,T,A,V,U){return s=kp(c,g,!0,s,_,T,A,V,U),s.context=D_(null),c=s.current,g=fn(),_=ji(c),T=ai(g,_),T.callback=a??null,Hi(c,T,_),s.current.lanes=_,Vs(s,_,g),In(s,g),s}function Td(s,a,c,g){var _=a.current,T=fn(),A=ji(_);return c=D_(c),a.context===null?a.context=c:a.pendingContext=c,a=ai(T,A),a.payload={element:s},g=g===void 0?null:g,g!==null&&(a.callback=g),s=Hi(_,a,A),s!==null&&(cr(s,_,A,T),Zc(s,_,A)),A}function xd(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function V_(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function bp(s,a){V_(s,a),(s=s.alternate)&&V_(s,a)}function MC(){return null}var L_=typeof reportError=="function"?reportError:function(s){console.error(s)};function Dp(s){this._internalRoot=s}Id.prototype.render=Dp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(t(409));Td(s,a,null,null)},Id.prototype.unmount=Dp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;js(function(){Td(null,s,null,null)}),a[ni]=null}};function Id(s){this._internalRoot=s}Id.prototype.unstable_scheduleHydration=function(s){if(s){var a=Pl();s={blockedOn:null,target:s,priority:a};for(var c=0;c<bn.length&&a!==0&&a<bn[c].priority;c++);bn.splice(c,0,s),c===0&&Oo(s)}};function Mp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Sd(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function F_(){}function VC(s,a,c,g,_){if(_){if(typeof g=="function"){var T=g;g=function(){var Q=xd(A);T.call(Q)}}var A=M_(a,g,s,0,null,!1,!1,"",F_);return s._reactRootContainer=A,s[ni]=A.current,ql(s.nodeType===8?s.parentNode:s),js(),A}for(;_=s.lastChild;)s.removeChild(_);if(typeof g=="function"){var V=g;g=function(){var Q=xd(U);V.call(Q)}}var U=kp(s,0,!1,null,null,!1,!1,"",F_);return s._reactRootContainer=U,s[ni]=U.current,ql(s.nodeType===8?s.parentNode:s),js(function(){Td(a,U,c,g)}),U}function Ad(s,a,c,g,_){var T=c._reactRootContainer;if(T){var A=T;if(typeof _=="function"){var V=_;_=function(){var U=xd(A);V.call(U)}}Td(a,A,s,_)}else A=VC(c,a,s,_,g);return xd(A)}Rl=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var c=et(a.pendingLanes);c!==0&&(Cl(a,c|1),In(a,ct()),(Qe&6)===0&&(ha=ct()+500,qi()))}break;case 13:js(function(){var g=oi(s,1);if(g!==null){var _=fn();cr(g,s,1,_)}}),bp(s,1)}},Fo=function(s){if(s.tag===13){var a=oi(s,134217728);if(a!==null){var c=fn();cr(a,s,134217728,c)}bp(s,134217728)}},Nl=function(s){if(s.tag===13){var a=ji(s),c=oi(s,a);if(c!==null){var g=fn();cr(c,s,a,g)}bp(s,a)}},Pl=function(){return $e},kl=function(s,a){var c=$e;try{return $e=s,a()}finally{$e=c}},Kr=function(s,a,c){switch(a){case"input":if($r(s,c),a=c.name,c.type==="radio"&&a!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<c.length;a++){var g=c[a];if(g!==s&&g.form===s.form){var _=zc(g);if(!_)throw Error(t(90));Pt(g),$r(g,_)}}}break;case"textarea":pc(s,c);break;case"select":a=c.value,a!=null&&tr(s,!!c.multiple,a,!1)}},yc=Sp,vc=js;var LC={usingClientEntryPoint:!1,Events:[$l,Zo,zc,Ri,Ni,Sp]},su={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FC={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ee.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Sc(s),s===null?null:s.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||MC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cd.isDisabled&&Cd.supportsFiber)try{ks=Cd.inject(FC),Pn=Cd}catch{}}return Sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LC,Sn.createPortal=function(s,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mp(a))throw Error(t(200));return DC(s,a,null,c)},Sn.createRoot=function(s,a){if(!Mp(s))throw Error(t(299));var c=!1,g="",_=L_;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=kp(s,1,!1,null,null,c,!1,g,_),s[ni]=a.current,ql(s.nodeType===8?s.parentNode:s),new Dp(a)},Sn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Sc(a),s=s===null?null:s.stateNode,s},Sn.flushSync=function(s){return js(s)},Sn.hydrate=function(s,a,c){if(!Sd(a))throw Error(t(200));return Ad(null,s,a,!0,c)},Sn.hydrateRoot=function(s,a,c){if(!Mp(s))throw Error(t(405));var g=c!=null&&c.hydratedSources||null,_=!1,T="",A=L_;if(c!=null&&(c.unstable_strictMode===!0&&(_=!0),c.identifierPrefix!==void 0&&(T=c.identifierPrefix),c.onRecoverableError!==void 0&&(A=c.onRecoverableError)),a=M_(a,null,s,1,c??null,_,!1,T,A),s[ni]=a.current,ql(s),g)for(s=0;s<g.length;s++)c=g[s],_=c._getVersion,_=_(c._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[c,_]:a.mutableSourceEagerHydrationData.push(c,_);return new Id(a)},Sn.render=function(s,a,c){if(!Sd(a))throw Error(t(200));return Ad(null,s,a,!1,c)},Sn.unmountComponentAtNode=function(s){if(!Sd(s))throw Error(t(40));return s._reactRootContainer?(js(function(){Ad(null,null,s,!1,function(){s._reactRootContainer=null,s[ni]=null})}),!0):!1},Sn.unstable_batchedUpdates=Sp,Sn.unstable_renderSubtreeIntoContainer=function(s,a,c,g){if(!Sd(c))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Ad(s,a,c,!1,g)},Sn.version="18.3.1-next-f1338f8080-20240426",Sn}var $_;function $C(){if($_)return Fp.exports;$_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fp.exports=HC(),Fp.exports}var K_;function KC(){if(K_)return Rd;K_=1;var n=$C();return Rd.createRoot=n.createRoot,Rd.hydrateRoot=n.hydrateRoot,Rd}var WC=KC();const jC=mT(WC);var JC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const QC=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(n,e)=>{const t=_e.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:u="",children:d,...f},y)=>_e.createElement("svg",{ref:y,...JC,width:i,height:i,stroke:r,strokeWidth:l?Number(o)*24/Number(i):o,className:["lucide",`lucide-${QC(n)}`,u].join(" "),...f},[...e.map(([v,E])=>_e.createElement(v,E)),...Array.isArray(d)?d:[d]]));return t.displayName=`${n}`,t};const YC=Ae("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);const XC=Ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const ZC=Ae("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);const e1=Ae("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);const t1=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const n1=Ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);const r1=Ae("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);const i1=Ae("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const s1=Ae("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);const W_=Ae("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);const bu=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const Zm=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const o1=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const a1=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const yT=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const vT=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const _T=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const l1=Ae("Delete",[["path",{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z",key:"1oy587"}],["line",{x1:"18",x2:"12",y1:"9",y2:"15",key:"1olkx5"}],["line",{x1:"12",x2:"18",y1:"9",y2:"15",key:"1n50pc"}]]);const u1=Ae("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);const c1=Ae("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);const d1=Ae("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);const h1=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const f1=Ae("FilterX",[["path",{d:"M13.013 3H2l8 9.46V19l4 2v-8.54l.9-1.055",key:"1fi1da"}],["path",{d:"m22 3-5 5",key:"12jva0"}],["path",{d:"m17 3 5 5",key:"k36vhe"}]]);const p1=Ae("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const m1=Ae("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);const wT=Ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const g1=Ae("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);const y1=Ae("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);const j_=Ae("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);const v1=Ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const wu=Ae("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const _1=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const w1=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const ET=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const E1=Ae("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);const T1=Ae("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);const Nh=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const x1=Ae("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);const I1=Ae("PlusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);const TT=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const S1=Ae("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);const A1=Ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);const C1=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const R1=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const N1=Ae("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);const nm=Ae("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const P1=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const xT=Ae("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);const k1=Ae("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);const IT=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const b1=Ae("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);const th=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const D1=Ae("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const M1=Ae("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);const V1=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Du=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const ba=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const eg=Ae("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);const Mu=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const ST=Ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),L1=({onLogin:n,onCancel:e,lang:t,settings:r})=>{const[i,o]=_e.useState("select"),[l,u]=_e.useState(""),[d,f]=_e.useState(""),[y,v]=_e.useState(""),[E,S]=_e.useState(!1),N={tr:{title:"Giri Yap",staff:"Personel Girii",admin:"Ynetici Girii",user:"Kullanc Ad",pass:"ifre",pin:"PIN Kodunu Girin",login:"GR YAP",cancel:"Vazge",wrong:"Hatal bilgiler!",back:"Geri"},de:{title:"Anmeldung",staff:"Personal-Login",admin:"Manager-Login",user:"Benutzername",pass:"Passwort",pin:"PIN-Code eingeben",login:"ANMELDEN",cancel:"Abbrechen",wrong:"Falsche Daten!",back:"Zurck"},en:{title:"Login",staff:"Staff Login",admin:"Manager Login",user:"Username",pass:"Password",pin:"Enter PIN Code",login:"LOGIN",cancel:"Cancel",wrong:"Invalid credentials!",back:"Back"},es:{title:"Iniciar Sesin",staff:"Acceso Personal",admin:"Acceso Gerente",user:"Usuario",pass:"Contrasea",pin:"Ingrese el PIN",login:"ENTRAR",cancel:"Cancelar",wrong:"Credenciales invlidas!",back:"Volver"}},M=N[t]||N.de,k=q=>{if(l.length<4){const H=l+q;u(H),S(!1),H.length===4&&(H===(r?.adminPin||"2027")?(navigator.vibrate&&navigator.vibrate([50,30,50]),n("admin")):(S(!0),navigator.vibrate&&navigator.vibrate(200),setTimeout(()=>u(""),500)))}},B=()=>{d.toLowerCase()==="pastillo"&&y==="0000"?(navigator.vibrate&&navigator.vibrate(50),n("staff")):(S(!0),navigator.vibrate&&navigator.vibrate(200),setTimeout(()=>S(!1),2e3))};return i==="select"?w.jsx("div",{className:"fixed inset-0 bg-[#0a0a0a]/95 backdrop-blur-2xl z-50 flex items-center justify-center p-6 animate-in fade-in duration-500",children:w.jsxs("div",{className:"w-full max-w-sm space-y-8 text-center",children:[w.jsxs("div",{className:"space-y-3",children:[w.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter",children:M.title}),w.jsx("p",{className:"text-white/30 text-[10px] font-black uppercase tracking-[0.3em]",children:"Pastillo Management Suite"})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[w.jsxs("button",{onClick:()=>o("staff"),className:"glass group p-8 rounded-[2.5rem] flex flex-col items-center gap-4 hover:bg-white/10 active:scale-95 transition-all border border-white/5",children:[w.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-3xl flex items-center justify-center text-white/40 group-hover:text-primary group-hover:bg-primary/10 transition-all",children:w.jsx(ba,{size:32})}),w.jsx("span",{className:"text-sm font-black text-white uppercase tracking-widest",children:M.staff})]}),w.jsxs("button",{onClick:()=>o("admin"),className:"glass group p-8 rounded-[2.5rem] flex flex-col items-center gap-4 hover:bg-white/10 active:scale-95 transition-all border border-white/5",children:[w.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-3xl flex items-center justify-center text-white/40 group-hover:text-primary group-hover:bg-primary/10 transition-all",children:w.jsx(nm,{size:32})}),w.jsx("span",{className:"text-sm font-black text-white uppercase tracking-widest",children:M.admin})]})]}),w.jsx("button",{onClick:e,className:"text-white/30 font-black text-[10px] uppercase tracking-widest hover:text-white transition-colors",children:M.cancel})]})}):w.jsx("div",{className:"fixed inset-0 bg-[#0a0a0a]/95 backdrop-blur-2xl z-50 flex flex-col items-center justify-center p-8 animate-in slide-in-from-bottom duration-500",children:w.jsxs("div",{className:"w-full max-w-xs space-y-10 text-center",children:[w.jsxs("div",{className:"relative",children:[w.jsxs("button",{onClick:()=>{o("select"),u(""),v(""),S(!1)},className:"absolute -top-12 -left-4 p-2 text-white/30 flex items-center gap-1 font-black text-[10px] uppercase tracking-widest",children:[w.jsx(a1,{size:16})," ",M.back]}),w.jsx("div",{className:`w-20 h-20 bg-white/5 rounded-[2rem] flex items-center justify-center mx-auto mb-6 border border-white/10 transition-colors ${E?"border-red-500/50 text-red-500":"text-primary"}`,children:i==="admin"?w.jsx(_1,{size:32}):w.jsx(Du,{size:32})}),w.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:i==="admin"?M.admin:M.staff}),E&&w.jsx("p",{className:"text-red-500 text-[10px] font-black uppercase tracking-widest mt-2 animate-bounce",children:M.wrong})]}),i==="admin"?w.jsxs("div",{className:"space-y-10",children:[w.jsx("div",{className:"flex justify-center gap-5 h-4",children:[0,1,2,3].map(q=>w.jsx("div",{className:`w-3.5 h-3.5 rounded-full transition-all duration-300 ${l.length>q?E?"bg-red-500":"bg-primary scale-125 shadow-[0_0_15px_rgba(255,193,7,0.5)]":"bg-white/10 shadow-inner"}`},q))}),w.jsxs("div",{className:"grid grid-cols-3 gap-y-6 gap-x-8",children:[[1,2,3,4,5,6,7,8,9].map(q=>w.jsx("button",{onClick:()=>k(q.toString()),className:"w-16 h-16 rounded-full bg-white/5 text-2xl font-black text-white border border-white/5 active:bg-primary active:text-black transition-all mx-auto flex items-center justify-center shadow-lg",children:q},q)),w.jsx("div",{className:"w-16 h-16"}),w.jsx("button",{onClick:()=>k("0"),className:"w-16 h-16 rounded-full bg-white/5 text-2xl font-black text-white border border-white/5 active:bg-primary active:text-black transition-all mx-auto flex items-center justify-center shadow-lg",children:"0"}),w.jsx("button",{onClick:()=>u(q=>q.slice(0,-1)),className:"w-16 h-16 flex items-center justify-center text-white/30 active:text-white mx-auto",children:w.jsx(l1,{size:24})})]})]}):w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"relative group",children:[w.jsx(Du,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-primary transition-colors",size:18}),w.jsx("input",{type:"text",placeholder:M.user,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-5 pl-14 pr-6 text-white font-bold focus:outline-none focus:border-primary/50 transition-all shadow-inner",value:d,onChange:q=>f(q.target.value)})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(y1,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-primary transition-colors",size:18}),w.jsx("input",{type:"password",placeholder:M.pass,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-5 pl-14 pr-6 text-white font-bold focus:outline-none focus:border-primary/50 transition-all shadow-inner",value:y,onChange:q=>v(q.target.value)})]})]}),w.jsx("button",{onClick:B,className:"w-full bg-primary text-black py-5 rounded-2xl font-black text-sm tracking-widest active:scale-95 transition-all shadow-xl shadow-primary/20",children:M.login})]})]})})};var F1={};let U1,O1;function B1(){return{geminiUrl:U1,vertexUrl:O1}}function G1(n,e,t,r){var i,o;if(!n?.baseUrl){const l=B1();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:t:(o=l.geminiUrl)!==null&&o!==void 0?o:r}return n.baseUrl}class gi{}function me(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function p(n,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[u])){const d=n[u];if(Array.isArray(t))for(let f=0;f<d.length;f++){const y=d[f];p(y,e.slice(o+1),t[f])}else for(const f of d)p(f,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in n||(n[u]=[{}]);const d=n[u];p(d[0],e.slice(o+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[r]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let r=0;r<e.length;r++){if(typeof n!="object"||n===null)return t;const i=e[r];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in n){const l=n[o];return Array.isArray(l)?l.map(u=>h(u,e.slice(r+1),t)):t}else return t}else n=n[i]}return n}catch(r){if(r instanceof TypeError)return t;throw r}}function q1(n,e){for(const[t,r]of Object.entries(e)){const i=t.split("."),o=r.split("."),l=new Set;let u=-1;for(let d=0;d<i.length;d++)if(i[d]==="*"){u=d;break}if(u!==-1&&o.length>u)for(let d=u;d<o.length;d++){const f=o[d];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}rm(n,i,o,0,l)}}function rm(n,e,t,r,i){if(r>=e.length||typeof n!="object"||n===null)return;const o=e[r];if(o.endsWith("[]")){const l=o.slice(0,-2),u=n;if(l in u&&Array.isArray(u[l]))for(const d of u[l])rm(d,e,t,r+1,i)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,u=Object.keys(l).filter(f=>!f.startsWith("_")&&!i.has(f)),d={};for(const f of u)d[f]=l[f];for(const[f,y]of Object.entries(d)){const v=[];for(const E of t.slice(r))E==="*"?v.push(f):v.push(E);p(l,v,y)}for(const f of u)delete l[f]}}else{const l=n;o in l&&rm(l[o],e,t,r+1,i)}}function tg(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function z1(n){const e={},t=h(n,["operationName"]);t!=null&&p(e,["operationName"],t);const r=h(n,["resourceName"]);return r!=null&&p(e,["_url","resourceName"],r),e}function H1(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response","generateVideoResponse"]);return l!=null&&p(e,["response"],K1(l)),e}function $1(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response"]);return l!=null&&p(e,["response"],W1(l)),e}function K1(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>j1(l))),p(e,["generatedVideos"],o)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&p(e,["raiMediaFilteredCount"],r);const i=h(n,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function W1(n){const e={},t=h(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>J1(l))),p(e,["generatedVideos"],o)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&p(e,["raiMediaFilteredCount"],r);const i=h(n,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function j1(n){const e={},t=h(n,["video"]);return t!=null&&p(e,["video"],tR(t)),e}function J1(n){const e={},t=h(n,["_self"]);return t!=null&&p(e,["video"],nR(t)),e}function Q1(n){const e={},t=h(n,["operationName"]);return t!=null&&p(e,["_url","operationName"],t),e}function Y1(n){const e={},t=h(n,["operationName"]);return t!=null&&p(e,["_url","operationName"],t),e}function X1(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response"]);return l!=null&&p(e,["response"],Z1(l)),e}function Z1(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["parent"]);r!=null&&p(e,["parent"],r);const i=h(n,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function AT(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response"]);return l!=null&&p(e,["response"],eR(l)),e}function eR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["parent"]);r!=null&&p(e,["parent"],r);const i=h(n,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function tR(n){const e={},t=h(n,["uri"]);t!=null&&p(e,["uri"],t);const r=h(n,["encodedVideo"]);r!=null&&p(e,["videoBytes"],tg(r));const i=h(n,["encoding"]);return i!=null&&p(e,["mimeType"],i),e}function nR(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["uri"],t);const r=h(n,["bytesBase64Encoded"]);r!=null&&p(e,["videoBytes"],tg(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}var J_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(J_||(J_={}));var Q_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Q_||(Q_={}));var Y_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Y_||(Y_={}));var Qn;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Qn||(Qn={}));var X_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(X_||(X_={}));var Z_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Z_||(Z_={}));var e0;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(e0||(e0={}));var t0;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(t0||(t0={}));var n0;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(n0||(n0={}));var r0;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(r0||(r0={}));var i0;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(i0||(i0={}));var s0;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(s0||(s0={}));var o0;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(o0||(o0={}));var a0;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(a0||(a0={}));var l0;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(l0||(l0={}));var u0;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(u0||(u0={}));var c0;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(c0||(c0={}));var d0;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(d0||(d0={}));var h0;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(h0||(h0={}));var nh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(nh||(nh={}));var f0;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(f0||(f0={}));var p0;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(p0||(p0={}));var m0;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(m0||(m0={}));var im;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(im||(im={}));var g0;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(g0||(g0={}));var y0;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(y0||(y0={}));var v0;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(v0||(v0={}));var _0;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(_0||(_0={}));var w0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(w0||(w0={}));var E0;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(E0||(E0={}));var T0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(T0||(T0={}));var x0;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(x0||(x0={}));var I0;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(I0||(I0={}));var S0;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(S0||(S0={}));var A0;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(A0||(A0={}));var C0;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(C0||(C0={}));var R0;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(R0||(R0={}));var N0;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(N0||(N0={}));var P0;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(P0||(P0={}));var k0;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(k0||(k0={}));var b0;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(b0||(b0={}));var D0;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(D0||(D0={}));var M0;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(M0||(M0={}));var V0;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(V0||(V0={}));var L0;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(L0||(L0={}));var F0;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(F0||(F0={}));var U0;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(U0||(U0={}));var O0;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(O0||(O0={}));var B0;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(B0||(B0={}));var G0;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(G0||(G0={}));var q0;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(q0||(q0={}));var z0;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(z0||(z0={}));var H0;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(H0||(H0={}));var $0;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})($0||($0={}));var K0;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(K0||(K0={}));var Aa;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Aa||(Aa={}));class sm{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class au{get text(){var e,t,r,i,o,l,u,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",y=!1;const v=[];for(const E of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[S,N]of Object.entries(E))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(N!==null||N!==void 0)&&v.push(S);if(typeof E.text=="string"){if(typeof E.thought=="boolean"&&E.thought)continue;y=!0,f+=E.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?f:void 0}get data(){var e,t,r,i,o,l,u,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const y=[];for(const v of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[E,S]of Object.entries(v))E!=="inlineData"&&(S!==null||S!==void 0)&&y.push(E);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,r,i,o,l,u,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if(f?.length!==0)return f}get executableCode(){var e,t,r,i,o,l,u,d,f;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if(y?.length!==0)return(f=y?.[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,r,i,o,l,u,d,f;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if(y?.length!==0)return(f=y?.[0])===null||f===void 0?void 0:f.output}}class W0{}class j0{}class rR{}class iR{}class sR{}class oR{}class J0{}class Q0{}class Y0{}class aR{}class rh{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new rh;let i;const o=e;return t?i=$1(o):i=H1(o),Object.assign(r,i),r}}class X0{}class Z0{}class ew{}class tw{}class lR{}class uR{}class cR{}class ng{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new ng,o=X1(e);return Object.assign(r,o),r}}class dR{}class hR{}class fR{}class nw{}class pR{get text(){var e,t,r;let i="",o=!1;const l=[];for(const u of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(u))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,t,r;let i="";const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&o.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class mR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class rg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new rg,o=AT(e);return Object.assign(r,o),r}}function Ze(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function CT(n,e){const t=Ze(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function RT(n){return Array.isArray(n)?n.map(e=>ih(e)):[ih(n)]}function ih(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function NT(n){const e=ih(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function PT(n){const e=ih(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function rw(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function kT(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>rw(e)):[rw(n)]}function om(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function iw(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function sw(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function un(n){if(n==null)throw new Error("ContentUnion is required");return om(n)?n:{role:"user",parts:kT(n)}}function ig(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=un(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=un(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>un(t)):[un(e)]}function Xn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(iw(n)||sw(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[un(n)]}const e=[],t=[],r=om(n[0]);for(const i of n){const o=om(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(i);else{if(iw(i)||sw(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return r||e.push({role:"user",parts:kT(t)}),e}function gR(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.values(Qn).includes(t[0].toUpperCase())?t[0].toUpperCase():Qn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.values(Qn).includes(r.toUpperCase())?r.toUpperCase():Qn.TYPE_UNSPECIFIED})}}function Ra(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&gR(n.type,e);for(const[l,u]of Object.entries(n))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Qn).includes(u.toUpperCase())?u.toUpperCase():Qn.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Ra(u);else if(r.includes(l)){const d=[];for(const f of u){if(f.type=="null"){e.nullable=!0;continue}d.push(Ra(f))}e[l]=d}else if(i.includes(l)){const d={};for(const[f,y]of Object.entries(u))d[f]=Ra(y);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function sg(n){return Ra(n)}function og(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function ag(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function rl(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ra(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ra(e.response));return n}function il(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function yR(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function yi(n,e){if(typeof e!="string")throw new Error("name must be a string");return yR(n,e,"cachedContents")}function bT(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function _s(n){return tg(n)}function vR(n){return n!=null&&typeof n=="object"&&"name"in n}function _R(n){return n!=null&&typeof n=="object"&&"video"in n}function wR(n){return n!=null&&typeof n=="object"&&"uri"in n}function DT(n){var e;let t;if(vR(n)&&(t=n.name),!(wR(n)&&(t=n.uri,t===void 0))&&!(_R(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function MT(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function VT(n){for(const e of["models","tunedModels","publisherModels"])if(ER(n,e))return n[e];return[]}function ER(n,e){return n!==null&&typeof n=="object"&&e in n}function TR(n,e={}){const t=n,r={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(r.responseJsonSchema=t.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function xR(n,e={}){const t=[],r=new Set;for(const i of n){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const l=TR(i,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function LT(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const r=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function IR(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function FT(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let o=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function sl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function UT(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function SR(n){const e={},t=h(n,["responsesFile"]);t!=null&&p(e,["fileName"],t);const r=h(n,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>sN(l))),p(e,["inlinedResponses"],o)}const i=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["inlinedEmbedContentResponses"],o)}return e}function AR(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&p(e,["format"],t);const r=h(n,["gcsDestination","outputUriPrefix"]);r!=null&&p(e,["gcsUri"],r);const i=h(n,["bigqueryDestination","outputUri"]);return i!=null&&p(e,["bigqueryUri"],i),e}function CR(n){const e={},t=h(n,["format"]);t!=null&&p(e,["predictionsFormat"],t);const r=h(n,["gcsUri"]);r!=null&&p(e,["gcsDestination","outputUriPrefix"],r);const i=h(n,["bigqueryUri"]);if(i!=null&&p(e,["bigqueryDestination","outputUri"],i),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Gd(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata","displayName"]);r!=null&&p(e,["displayName"],r);const i=h(n,["metadata","state"]);i!=null&&p(e,["state"],UT(i));const o=h(n,["metadata","createTime"]);o!=null&&p(e,["createTime"],o);const l=h(n,["metadata","endTime"]);l!=null&&p(e,["endTime"],l);const u=h(n,["metadata","updateTime"]);u!=null&&p(e,["updateTime"],u);const d=h(n,["metadata","model"]);d!=null&&p(e,["model"],d);const f=h(n,["metadata","output"]);return f!=null&&p(e,["dest"],SR(FT(f))),e}function am(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["displayName"]);r!=null&&p(e,["displayName"],r);const i=h(n,["state"]);i!=null&&p(e,["state"],UT(i));const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["createTime"]);l!=null&&p(e,["createTime"],l);const u=h(n,["startTime"]);u!=null&&p(e,["startTime"],u);const d=h(n,["endTime"]);d!=null&&p(e,["endTime"],d);const f=h(n,["updateTime"]);f!=null&&p(e,["updateTime"],f);const y=h(n,["model"]);y!=null&&p(e,["model"],y);const v=h(n,["inputConfig"]);v!=null&&p(e,["src"],RR(v));const E=h(n,["outputConfig"]);E!=null&&p(e,["dest"],AR(FT(E)));const S=h(n,["completionStats"]);return S!=null&&p(e,["completionStats"],S),e}function RR(n){const e={},t=h(n,["instancesFormat"]);t!=null&&p(e,["format"],t);const r=h(n,["gcsSource","uris"]);r!=null&&p(e,["gcsUri"],r);const i=h(n,["bigquerySource","inputUri"]);return i!=null&&p(e,["bigqueryUri"],i),e}function NR(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&p(t,["fileName"],r);const i=h(e,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>iN(n,l))),p(t,["requests","requests"],o)}return t}function PR(n){const e={},t=h(n,["format"]);t!=null&&p(e,["instancesFormat"],t);const r=h(n,["gcsUri"]);r!=null&&p(e,["gcsSource","uris"],r);const i=h(n,["bigqueryUri"]);if(i!=null&&p(e,["bigquerySource","inputUri"],i),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function kR(n){const e={},t=h(n,["data"]);if(t!=null&&p(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function bR(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function DR(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function MR(n){const e={},t=h(n,["content"]);t!=null&&p(e,["content"],t);const r=h(n,["citationMetadata"]);r!=null&&p(e,["citationMetadata"],VR(r));const i=h(n,["tokenCount"]);i!=null&&p(e,["tokenCount"],i);const o=h(n,["finishReason"]);o!=null&&p(e,["finishReason"],o);const l=h(n,["avgLogprobs"]);l!=null&&p(e,["avgLogprobs"],l);const u=h(n,["groundingMetadata"]);u!=null&&p(e,["groundingMetadata"],u);const d=h(n,["index"]);d!=null&&p(e,["index"],d);const f=h(n,["logprobsResult"]);f!=null&&p(e,["logprobsResult"],f);const y=h(n,["safetyRatings"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(S=>S)),p(e,["safetyRatings"],E)}const v=h(n,["urlContextMetadata"]);return v!=null&&p(e,["urlContextMetadata"],v),e}function VR(n){const e={},t=h(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),p(e,["citations"],r)}return e}function OT(n){const e={},t=h(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>hN(o))),p(e,["parts"],i)}const r=h(n,["role"]);return r!=null&&p(e,["role"],r),e}function LR(n,e){const t={},r=h(n,["displayName"]);if(e!==void 0&&r!=null&&p(e,["batch","displayName"],r),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function FR(n,e){const t={},r=h(n,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const i=h(n,["dest"]);return e!==void 0&&i!=null&&p(e,["outputConfig"],CR(IR(i))),t}function ow(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["src"]);i!=null&&p(t,["batch","inputConfig"],NR(n,LT(n,i)));const o=h(e,["config"]);return o!=null&&LR(o,t),t}function UR(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["model"],Ze(n,r));const i=h(e,["src"]);i!=null&&p(t,["inputConfig"],PR(LT(n,i)));const o=h(e,["config"]);return o!=null&&FR(o,t),t}function OR(n,e){const t={},r=h(n,["displayName"]);return e!==void 0&&r!=null&&p(e,["batch","displayName"],r),t}function BR(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["src"]);i!=null&&p(t,["batch","inputConfig"],WR(n,i));const o=h(e,["config"]);return o!=null&&OR(o,t),t}function GR(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function qR(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function zR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);return o!=null&&p(e,["error"],o),e}function HR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);return o!=null&&p(e,["error"],o),e}function $R(n,e){const t={},r=h(e,["contents"]);if(r!=null){let o=ig(n,r);Array.isArray(o)&&(o=o.map(l=>l)),p(t,["requests[]","request","content"],o)}const i=h(e,["config"]);return i!=null&&(p(t,["_self"],KR(i,t)),q1(t,{"requests[].*":"requests[].request.*"})),t}function KR(n,e){const t={},r=h(n,["taskType"]);e!==void 0&&r!=null&&p(e,["requests[]","taskType"],r);const i=h(n,["title"]);e!==void 0&&i!=null&&p(e,["requests[]","title"],i);const o=h(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&p(e,["requests[]","outputDimensionality"],o),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function WR(n,e){const t={},r=h(e,["fileName"]);r!=null&&p(t,["file_name"],r);const i=h(e,["inlinedRequests"]);return i!=null&&p(t,["requests"],$R(n,i)),t}function jR(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function JR(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const r=h(n,["args"]);r!=null&&p(e,["args"],r);const i=h(n,["name"]);if(i!=null&&p(e,["name"],i),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function QR(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const r=h(n,["allowedFunctionNames"]);if(r!=null&&p(e,["allowedFunctionNames"],r),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function YR(n,e,t){const r={},i=h(e,["systemInstruction"]);t!==void 0&&i!=null&&p(t,["systemInstruction"],OT(un(i)));const o=h(e,["temperature"]);o!=null&&p(r,["temperature"],o);const l=h(e,["topP"]);l!=null&&p(r,["topP"],l);const u=h(e,["topK"]);u!=null&&p(r,["topK"],u);const d=h(e,["candidateCount"]);d!=null&&p(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&p(r,["maxOutputTokens"],f);const y=h(e,["stopSequences"]);y!=null&&p(r,["stopSequences"],y);const v=h(e,["responseLogprobs"]);v!=null&&p(r,["responseLogprobs"],v);const E=h(e,["logprobs"]);E!=null&&p(r,["logprobs"],E);const S=h(e,["presencePenalty"]);S!=null&&p(r,["presencePenalty"],S);const N=h(e,["frequencyPenalty"]);N!=null&&p(r,["frequencyPenalty"],N);const M=h(e,["seed"]);M!=null&&p(r,["seed"],M);const k=h(e,["responseMimeType"]);k!=null&&p(r,["responseMimeType"],k);const B=h(e,["responseSchema"]);B!=null&&p(r,["responseSchema"],sg(B));const q=h(e,["responseJsonSchema"]);if(q!=null&&p(r,["responseJsonSchema"],q),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const H=h(e,["safetySettings"]);if(t!==void 0&&H!=null){let D=H;Array.isArray(D)&&(D=D.map(Fe=>fN(Fe))),p(t,["safetySettings"],D)}const ee=h(e,["tools"]);if(t!==void 0&&ee!=null){let D=il(ee);Array.isArray(D)&&(D=D.map(Fe=>mN(rl(Fe)))),p(t,["tools"],D)}const te=h(e,["toolConfig"]);if(t!==void 0&&te!=null&&p(t,["toolConfig"],pN(te)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);t!==void 0&&j!=null&&p(t,["cachedContent"],yi(n,j));const b=h(e,["responseModalities"]);b!=null&&p(r,["responseModalities"],b);const R=h(e,["mediaResolution"]);R!=null&&p(r,["mediaResolution"],R);const P=h(e,["speechConfig"]);if(P!=null&&p(r,["speechConfig"],og(P)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&p(r,["thinkingConfig"],L);const F=h(e,["imageConfig"]);F!=null&&p(r,["imageConfig"],rN(F));const G=h(e,["enableEnhancedCivicAnswers"]);return G!=null&&p(r,["enableEnhancedCivicAnswers"],G),r}function XR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>MR(f))),p(e,["candidates"],d)}const i=h(n,["modelVersion"]);i!=null&&p(e,["modelVersion"],i);const o=h(n,["promptFeedback"]);o!=null&&p(e,["promptFeedback"],o);const l=h(n,["responseId"]);l!=null&&p(e,["responseId"],l);const u=h(n,["usageMetadata"]);return u!=null&&p(e,["usageMetadata"],u),e}function ZR(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function eN(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],sl(n,r)),t}function tN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function nN(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function rN(n){const e={},t=h(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);const r=h(n,["imageSize"]);if(r!=null&&p(e,["imageSize"],r),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function iN(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["request","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let u=Xn(i);Array.isArray(u)&&(u=u.map(d=>OT(d))),p(t,["request","contents"],u)}const o=h(e,["metadata"]);o!=null&&p(t,["metadata"],o);const l=h(e,["config"]);return l!=null&&p(t,["request","generationConfig"],YR(n,l,h(t,["request"],{}))),t}function sN(n){const e={},t=h(n,["response"]);t!=null&&p(e,["response"],XR(t));const r=h(n,["error"]);return r!=null&&p(e,["error"],r),e}function oN(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);if(e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function aN(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);e!==void 0&&i!=null&&p(e,["_query","pageToken"],i);const o=h(n,["filter"]);return e!==void 0&&o!=null&&p(e,["_query","filter"],o),t}function lN(n){const e={},t=h(n,["config"]);return t!=null&&oN(t,e),e}function uN(n){const e={},t=h(n,["config"]);return t!=null&&aN(t,e),e}function cN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Gd(l))),p(e,["batchJobs"],o)}return e}function dN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>am(l))),p(e,["batchJobs"],o)}return e}function hN(n){const e={},t=h(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);const r=h(n,["codeExecutionResult"]);r!=null&&p(e,["codeExecutionResult"],r);const i=h(n,["executableCode"]);i!=null&&p(e,["executableCode"],i);const o=h(n,["fileData"]);o!=null&&p(e,["fileData"],jR(o));const l=h(n,["functionCall"]);l!=null&&p(e,["functionCall"],JR(l));const u=h(n,["functionResponse"]);u!=null&&p(e,["functionResponse"],u);const d=h(n,["inlineData"]);d!=null&&p(e,["inlineData"],kR(d));const f=h(n,["text"]);f!=null&&p(e,["text"],f);const y=h(n,["thought"]);y!=null&&p(e,["thought"],y);const v=h(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const E=h(n,["videoMetadata"]);return E!=null&&p(e,["videoMetadata"],E),e}function fN(n){const e={},t=h(n,["category"]);if(t!=null&&p(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=h(n,["threshold"]);return r!=null&&p(e,["threshold"],r),e}function pN(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],QR(t));const r=h(n,["retrievalConfig"]);return r!=null&&p(e,["retrievalConfig"],r),e}function mN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let y=t;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["functionDeclarations"],y)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const i=h(n,["computerUse"]);i!=null&&p(e,["computerUse"],i);const o=h(n,["fileSearch"]);o!=null&&p(e,["fileSearch"],o);const l=h(n,["codeExecution"]);if(l!=null&&p(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=h(n,["googleMaps"]);u!=null&&p(e,["googleMaps"],tN(u));const d=h(n,["googleSearch"]);d!=null&&p(e,["googleSearch"],nN(d));const f=h(n,["urlContext"]);return f!=null&&p(e,["urlContext"],f),e}var hi;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(hi||(hi={}));class xo{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!r||Object.keys(r).length===0?l={config:{}}:typeof r=="object"?l=Object.assign({},r):l=r,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class gN extends gi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new xo(hi.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=ow(this.apiClient,e),r=t._url,i=me("{model}:batchGenerateContent",r),u=t.batch.inputConfig.requests,d=u.requests,f=[];for(const y of d){const v=Object.assign({},y);if(v.systemInstruction){const E=v.systemInstruction;delete v.systemInstruction;const S=v.request;S.systemInstruction=E,v.request=S}f.push(v)}return u.requests=f,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const r=t?Object.assign({},t):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(l)r.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=UR(this.apiClient,e);return u=me("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>am(y))}else{const f=ow(this.apiClient,e);return u=me("{model}:batchGenerateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>Gd(y))}}async createEmbeddingsInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=BR(this.apiClient,e);return o=me("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>Gd(d))}}async get(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=eN(this.apiClient,e);return u=me("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>am(y))}else{const f=ZR(this.apiClient,e);return u=me("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>Gd(y))}}async cancel(e){var t,r,i,o;let l="",u={};if(this.apiClient.isVertexAI()){const d=DR(this.apiClient,e);l=me("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=bR(this.apiClient,e);l=me("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=uN(e);return u=me("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=dN(y),E=new nw;return Object.assign(E,v),E})}else{const f=lN(e);return u=me("batches",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=cN(y),E=new nw;return Object.assign(E,v),E})}}async delete(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=qR(this.apiClient,e);return u=me("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>HR(y))}else{const f=GR(this.apiClient,e);return u=me("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>zR(y))}}}function yN(n){const e={},t=h(n,["data"]);if(t!=null&&p(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function aw(n){const e={},t=h(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>BN(o))),p(e,["parts"],i)}const r=h(n,["role"]);return r!=null&&p(e,["role"],r),e}function vN(n,e){const t={},r=h(n,["ttl"]);e!==void 0&&r!=null&&p(e,["ttl"],r);const i=h(n,["expireTime"]);e!==void 0&&i!=null&&p(e,["expireTime"],i);const o=h(n,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let y=Xn(l);Array.isArray(y)&&(y=y.map(v=>aw(v))),p(e,["contents"],y)}const u=h(n,["systemInstruction"]);e!==void 0&&u!=null&&p(e,["systemInstruction"],aw(un(u)));const d=h(n,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(v=>qN(v))),p(e,["tools"],y)}const f=h(n,["toolConfig"]);if(e!==void 0&&f!=null&&p(e,["toolConfig"],GN(f)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function _N(n,e){const t={},r=h(n,["ttl"]);e!==void 0&&r!=null&&p(e,["ttl"],r);const i=h(n,["expireTime"]);e!==void 0&&i!=null&&p(e,["expireTime"],i);const o=h(n,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let v=Xn(l);Array.isArray(v)&&(v=v.map(E=>E)),p(e,["contents"],v)}const u=h(n,["systemInstruction"]);e!==void 0&&u!=null&&p(e,["systemInstruction"],un(u));const d=h(n,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(E=>zN(E))),p(e,["tools"],v)}const f=h(n,["toolConfig"]);e!==void 0&&f!=null&&p(e,["toolConfig"],f);const y=h(n,["kmsKeyName"]);return e!==void 0&&y!=null&&p(e,["encryption_spec","kmsKeyName"],y),t}function wN(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["model"],CT(n,r));const i=h(e,["config"]);return i!=null&&vN(i,t),t}function EN(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["model"],CT(n,r));const i=h(e,["config"]);return i!=null&&_N(i,t),t}function TN(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],yi(n,r)),t}function xN(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],yi(n,r)),t}function IN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function SN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function AN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function CN(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const r=h(n,["args"]);r!=null&&p(e,["args"],r);const i=h(n,["name"]);if(i!=null&&p(e,["name"],i),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function RN(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const r=h(n,["allowedFunctionNames"]);if(r!=null&&p(e,["allowedFunctionNames"],r),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function NN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const i=h(n,["parameters"]);i!=null&&p(e,["parameters"],i);const o=h(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const u=h(n,["responseJsonSchema"]);return u!=null&&p(e,["responseJsonSchema"],u),e}function PN(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],yi(n,r)),t}function kN(n,e){const t={},r=h(e,["name"]);return r!=null&&p(t,["_url","name"],yi(n,r)),t}function bN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function DN(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function MN(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),t}function VN(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),t}function LN(n){const e={},t=h(n,["config"]);return t!=null&&MN(t,e),e}function FN(n){const e={},t=h(n,["config"]);return t!=null&&VN(t,e),e}function UN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["cachedContents"],o)}return e}function ON(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["cachedContents"],o)}return e}function BN(n){const e={},t=h(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);const r=h(n,["codeExecutionResult"]);r!=null&&p(e,["codeExecutionResult"],r);const i=h(n,["executableCode"]);i!=null&&p(e,["executableCode"],i);const o=h(n,["fileData"]);o!=null&&p(e,["fileData"],AN(o));const l=h(n,["functionCall"]);l!=null&&p(e,["functionCall"],CN(l));const u=h(n,["functionResponse"]);u!=null&&p(e,["functionResponse"],u);const d=h(n,["inlineData"]);d!=null&&p(e,["inlineData"],yN(d));const f=h(n,["text"]);f!=null&&p(e,["text"],f);const y=h(n,["thought"]);y!=null&&p(e,["thought"],y);const v=h(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const E=h(n,["videoMetadata"]);return E!=null&&p(e,["videoMetadata"],E),e}function GN(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],RN(t));const r=h(n,["retrievalConfig"]);return r!=null&&p(e,["retrievalConfig"],r),e}function qN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let y=t;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["functionDeclarations"],y)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const i=h(n,["computerUse"]);i!=null&&p(e,["computerUse"],i);const o=h(n,["fileSearch"]);o!=null&&p(e,["fileSearch"],o);const l=h(n,["codeExecution"]);if(l!=null&&p(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=h(n,["googleMaps"]);u!=null&&p(e,["googleMaps"],bN(u));const d=h(n,["googleSearch"]);d!=null&&p(e,["googleSearch"],DN(d));const f=h(n,["urlContext"]);return f!=null&&p(e,["urlContext"],f),e}function zN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(E=>NN(E))),p(e,["functionDeclarations"],v)}const r=h(n,["retrieval"]);r!=null&&p(e,["retrieval"],r);const i=h(n,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);if(o!=null&&p(e,["computerUse"],o),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&p(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&p(e,["googleMaps"],d);const f=h(n,["googleSearch"]);f!=null&&p(e,["googleSearch"],f);const y=h(n,["urlContext"]);return y!=null&&p(e,["urlContext"],y),e}function HN(n,e){const t={},r=h(n,["ttl"]);e!==void 0&&r!=null&&p(e,["ttl"],r);const i=h(n,["expireTime"]);return e!==void 0&&i!=null&&p(e,["expireTime"],i),t}function $N(n,e){const t={},r=h(n,["ttl"]);e!==void 0&&r!=null&&p(e,["ttl"],r);const i=h(n,["expireTime"]);return e!==void 0&&i!=null&&p(e,["expireTime"],i),t}function KN(n,e){const t={},r=h(e,["name"]);r!=null&&p(t,["_url","name"],yi(n,r));const i=h(e,["config"]);return i!=null&&HN(i,t),t}function WN(n,e){const t={},r=h(e,["name"]);r!=null&&p(t,["_url","name"],yi(n,r));const i=h(e,["config"]);return i!=null&&$N(i,t),t}class jN extends gi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new xo(hi.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=EN(this.apiClient,e);return u=me("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>y)}else{const f=wN(this.apiClient,e);return u=me("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>y)}}async get(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=kN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>y)}else{const f=PN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>y)}}async delete(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=xN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=SN(y),E=new ew;return Object.assign(E,v),E})}else{const f=TN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=IN(y),E=new ew;return Object.assign(E,v),E})}}async update(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=WN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>y)}else{const f=KN(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>y)}}async listInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=FN(e);return u=me("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=ON(y),E=new tw;return Object.assign(E,v),E})}else{const f=LN(e);return u=me("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=UN(y),E=new tw;return Object.assign(E,v),E})}}}function sh(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function lw(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ve(n){return this instanceof Ve?(this.v=n,this):new Ve(n)}function hr(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(S){return function(N){return Promise.resolve(N).then(S,v)}}function u(S,N){r[S]&&(i[S]=function(M){return new Promise(function(k,B){o.push([S,M,k,B])>1||d(S,M)})},N&&(i[S]=N(i[S])))}function d(S,N){try{f(r[S](N))}catch(M){E(o[0][3],M)}}function f(S){S.value instanceof Ve?Promise.resolve(S.value.v).then(y,v):E(o[0][2],S)}function y(S){d("next",S)}function v(S){d("throw",S)}function E(S,N){S(N),o.shift(),o.length&&d(o[0][0],o[0][1])}}function fr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof lw=="function"?lw(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(l){return new Promise(function(u,d){l=n[o](l),i(u,d,l.done,l.value)})}}function i(o,l,u,d){Promise.resolve(d).then(function(f){o({value:f,done:u})},l)}}function JN(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:BT(t)}function BT(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function QN(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function uw(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let o=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),o&&!BT(n[r])&&(o=!1),r++;o?e.push(...i):e.pop()}return e}class YN{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new XN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class XN{constructor(e,t,r,i={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),QN(o)}async sendMessage(e){var t;await this.sendPromise;const r=un(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,u;const d=await i,f=(l=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,y=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let E=[];y!=null&&(E=(u=y.slice(v))!==null&&u!==void 0?u:[]);const S=f?[f]:[];this.recordHistory(r,S,E)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const r=un(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){const t=e?uw(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return hr(this,arguments,function*(){var i,o,l,u,d,f;const y=[];try{for(var v=!0,E=fr(e),S;S=yield Ve(E.next()),i=S.done,!i;v=!0){u=S.value,v=!1;const N=u;if(JN(N)){const M=(f=(d=N.candidates)===null||d===void 0?void 0:d[0])===null||f===void 0?void 0:f.content;M!==void 0&&y.push(M)}yield yield Ve(N)}}catch(N){o={error:N}}finally{try{!v&&!i&&(l=E.return)&&(yield Ve(l.call(E)))}finally{if(o)throw o.error}}this.recordHistory(t,y)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(o=>o.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...uw(r)):this.history.push(e),this.history.push(...i)}}class Ph extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ph.prototype)}}function ZN(n){const e={},t=h(n,["file"]);return t!=null&&p(e,["file"],t),e}function eP(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function tP(n){const e={},t=h(n,["name"]);return t!=null&&p(e,["_url","file"],DT(t)),e}function nP(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function rP(n){const e={},t=h(n,["name"]);return t!=null&&p(e,["_url","file"],DT(t)),e}function iP(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),t}function sP(n){const e={},t=h(n,["config"]);return t!=null&&iP(t,e),e}function oP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["files"],o)}return e}class aP extends gi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new xo(hi.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=sP(e);return o=me("files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>{const f=oP(d),y=new dR;return Object.assign(y,f),y})}}async createInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ZN(e);return o=me("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=eP(d),y=new hR;return Object.assign(y,f),y})}}async get(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=rP(e);return o=me("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=tP(e);return o=me("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>{const f=nP(d),y=new fR;return Object.assign(y,f),y})}}}function qd(n){const e={},t=h(n,["data"]);if(t!=null&&p(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function lP(n){const e={},t=h(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>IP(o))),p(e,["parts"],i)}const r=h(n,["role"]);return r!=null&&p(e,["role"],r),e}function uP(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function cP(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const r=h(n,["args"]);r!=null&&p(e,["args"],r);const i=h(n,["name"]);if(i!=null&&p(e,["name"],i),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function dP(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const i=h(n,["parameters"]);i!=null&&p(e,["parameters"],i);const o=h(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const u=h(n,["responseJsonSchema"]);return u!=null&&p(e,["responseJsonSchema"],u),e}function hP(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&p(e,["modelConfig"],t);const r=h(n,["responseJsonSchema"]);r!=null&&p(e,["responseJsonSchema"],r);const i=h(n,["audioTimestamp"]);i!=null&&p(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&p(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&p(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&p(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&p(e,["logprobs"],d);const f=h(n,["maxOutputTokens"]);f!=null&&p(e,["maxOutputTokens"],f);const y=h(n,["mediaResolution"]);y!=null&&p(e,["mediaResolution"],y);const v=h(n,["presencePenalty"]);v!=null&&p(e,["presencePenalty"],v);const E=h(n,["responseLogprobs"]);E!=null&&p(e,["responseLogprobs"],E);const S=h(n,["responseMimeType"]);S!=null&&p(e,["responseMimeType"],S);const N=h(n,["responseModalities"]);N!=null&&p(e,["responseModalities"],N);const M=h(n,["responseSchema"]);M!=null&&p(e,["responseSchema"],M);const k=h(n,["routingConfig"]);k!=null&&p(e,["routingConfig"],k);const B=h(n,["seed"]);B!=null&&p(e,["seed"],B);const q=h(n,["speechConfig"]);q!=null&&p(e,["speechConfig"],q);const H=h(n,["stopSequences"]);H!=null&&p(e,["stopSequences"],H);const ee=h(n,["temperature"]);ee!=null&&p(e,["temperature"],ee);const te=h(n,["thinkingConfig"]);te!=null&&p(e,["thinkingConfig"],te);const j=h(n,["topK"]);j!=null&&p(e,["topK"],j);const b=h(n,["topP"]);if(b!=null&&p(e,["topP"],b),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function fP(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function pP(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function mP(n,e){const t={},r=h(n,["generationConfig"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig"],r);const i=h(n,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const o=h(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const u=h(n,["topK"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topK"],u);const d=h(n,["maxOutputTokens"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(n,["mediaResolution"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","mediaResolution"],f);const y=h(n,["seed"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","seed"],y);const v=h(n,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],ag(v));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&p(e,["setup","generationConfig","thinkingConfig"],E);const S=h(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],S);const N=h(n,["systemInstruction"]);e!==void 0&&N!=null&&p(e,["setup","systemInstruction"],lP(un(N)));const M=h(n,["tools"]);if(e!==void 0&&M!=null){let j=il(M);Array.isArray(j)&&(j=j.map(b=>AP(rl(b)))),p(e,["setup","tools"],j)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&p(e,["setup","sessionResumption"],SP(k));const B=h(n,["inputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","inputAudioTranscription"],B);const q=h(n,["outputAudioTranscription"]);e!==void 0&&q!=null&&p(e,["setup","outputAudioTranscription"],q);const H=h(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&p(e,["setup","realtimeInputConfig"],H);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&p(e,["setup","contextWindowCompression"],ee);const te=h(n,["proactivity"]);if(e!==void 0&&te!=null&&p(e,["setup","proactivity"],te),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function gP(n,e){const t={},r=h(n,["generationConfig"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig"],hP(r));const i=h(n,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const o=h(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const u=h(n,["topK"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topK"],u);const d=h(n,["maxOutputTokens"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(n,["mediaResolution"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","mediaResolution"],f);const y=h(n,["seed"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","seed"],y);const v=h(n,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],ag(v));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&p(e,["setup","generationConfig","thinkingConfig"],E);const S=h(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],S);const N=h(n,["systemInstruction"]);e!==void 0&&N!=null&&p(e,["setup","systemInstruction"],un(N));const M=h(n,["tools"]);if(e!==void 0&&M!=null){let b=il(M);Array.isArray(b)&&(b=b.map(R=>CP(rl(R)))),p(e,["setup","tools"],b)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&p(e,["setup","sessionResumption"],k);const B=h(n,["inputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","inputAudioTranscription"],B);const q=h(n,["outputAudioTranscription"]);e!==void 0&&q!=null&&p(e,["setup","outputAudioTranscription"],q);const H=h(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&p(e,["setup","realtimeInputConfig"],H);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&p(e,["setup","contextWindowCompression"],ee);const te=h(n,["proactivity"]);e!==void 0&&te!=null&&p(e,["setup","proactivity"],te);const j=h(n,["explicitVadSignal"]);return e!==void 0&&j!=null&&p(e,["setup","explicitVadSignal"],j),t}function yP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["setup","model"],Ze(n,r));const i=h(e,["config"]);return i!=null&&p(t,["config"],mP(i,t)),t}function vP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["setup","model"],Ze(n,r));const i=h(e,["config"]);return i!=null&&p(t,["config"],gP(i,t)),t}function _P(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&p(e,["musicGenerationConfig"],t),e}function wP(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),p(e,["weightedPrompts"],r)}return e}function EP(n){const e={},t=h(n,["media"]);if(t!=null){let f=RT(t);Array.isArray(f)&&(f=f.map(y=>qd(y))),p(e,["mediaChunks"],f)}const r=h(n,["audio"]);r!=null&&p(e,["audio"],qd(PT(r)));const i=h(n,["audioStreamEnd"]);i!=null&&p(e,["audioStreamEnd"],i);const o=h(n,["video"]);o!=null&&p(e,["video"],qd(NT(o)));const l=h(n,["text"]);l!=null&&p(e,["text"],l);const u=h(n,["activityStart"]);u!=null&&p(e,["activityStart"],u);const d=h(n,["activityEnd"]);return d!=null&&p(e,["activityEnd"],d),e}function TP(n){const e={},t=h(n,["media"]);if(t!=null){let f=RT(t);Array.isArray(f)&&(f=f.map(y=>y)),p(e,["mediaChunks"],f)}const r=h(n,["audio"]);r!=null&&p(e,["audio"],PT(r));const i=h(n,["audioStreamEnd"]);i!=null&&p(e,["audioStreamEnd"],i);const o=h(n,["video"]);o!=null&&p(e,["video"],NT(o));const l=h(n,["text"]);l!=null&&p(e,["text"],l);const u=h(n,["activityStart"]);u!=null&&p(e,["activityStart"],u);const d=h(n,["activityEnd"]);return d!=null&&p(e,["activityEnd"],d),e}function xP(n){const e={},t=h(n,["setupComplete"]);t!=null&&p(e,["setupComplete"],t);const r=h(n,["serverContent"]);r!=null&&p(e,["serverContent"],r);const i=h(n,["toolCall"]);i!=null&&p(e,["toolCall"],i);const o=h(n,["toolCallCancellation"]);o!=null&&p(e,["toolCallCancellation"],o);const l=h(n,["usageMetadata"]);l!=null&&p(e,["usageMetadata"],RP(l));const u=h(n,["goAway"]);u!=null&&p(e,["goAway"],u);const d=h(n,["sessionResumptionUpdate"]);d!=null&&p(e,["sessionResumptionUpdate"],d);const f=h(n,["voiceActivityDetectionSignal"]);return f!=null&&p(e,["voiceActivityDetectionSignal"],f),e}function IP(n){const e={},t=h(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);const r=h(n,["codeExecutionResult"]);r!=null&&p(e,["codeExecutionResult"],r);const i=h(n,["executableCode"]);i!=null&&p(e,["executableCode"],i);const o=h(n,["fileData"]);o!=null&&p(e,["fileData"],uP(o));const l=h(n,["functionCall"]);l!=null&&p(e,["functionCall"],cP(l));const u=h(n,["functionResponse"]);u!=null&&p(e,["functionResponse"],u);const d=h(n,["inlineData"]);d!=null&&p(e,["inlineData"],qd(d));const f=h(n,["text"]);f!=null&&p(e,["text"],f);const y=h(n,["thought"]);y!=null&&p(e,["thought"],y);const v=h(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const E=h(n,["videoMetadata"]);return E!=null&&p(e,["videoMetadata"],E),e}function SP(n){const e={},t=h(n,["handle"]);if(t!=null&&p(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function AP(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let y=t;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["functionDeclarations"],y)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const i=h(n,["computerUse"]);i!=null&&p(e,["computerUse"],i);const o=h(n,["fileSearch"]);o!=null&&p(e,["fileSearch"],o);const l=h(n,["codeExecution"]);if(l!=null&&p(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=h(n,["googleMaps"]);u!=null&&p(e,["googleMaps"],fP(u));const d=h(n,["googleSearch"]);d!=null&&p(e,["googleSearch"],pP(d));const f=h(n,["urlContext"]);return f!=null&&p(e,["urlContext"],f),e}function CP(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(E=>dP(E))),p(e,["functionDeclarations"],v)}const r=h(n,["retrieval"]);r!=null&&p(e,["retrieval"],r);const i=h(n,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);if(o!=null&&p(e,["computerUse"],o),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&p(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&p(e,["googleMaps"],d);const f=h(n,["googleSearch"]);f!=null&&p(e,["googleSearch"],f);const y=h(n,["urlContext"]);return y!=null&&p(e,["urlContext"],y),e}function RP(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);const r=h(n,["cachedContentTokenCount"]);r!=null&&p(e,["cachedContentTokenCount"],r);const i=h(n,["candidatesTokenCount"]);i!=null&&p(e,["responseTokenCount"],i);const o=h(n,["toolUsePromptTokenCount"]);o!=null&&p(e,["toolUsePromptTokenCount"],o);const l=h(n,["thoughtsTokenCount"]);l!=null&&p(e,["thoughtsTokenCount"],l);const u=h(n,["totalTokenCount"]);u!=null&&p(e,["totalTokenCount"],u);const d=h(n,["promptTokensDetails"]);if(d!=null){let S=d;Array.isArray(S)&&(S=S.map(N=>N)),p(e,["promptTokensDetails"],S)}const f=h(n,["cacheTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(N=>N)),p(e,["cacheTokensDetails"],S)}const y=h(n,["candidatesTokensDetails"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(N=>N)),p(e,["responseTokensDetails"],S)}const v=h(n,["toolUsePromptTokensDetails"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(N=>N)),p(e,["toolUsePromptTokensDetails"],S)}const E=h(n,["trafficType"]);return E!=null&&p(e,["trafficType"],E),e}function NP(n){const e={},t=h(n,["data"]);if(t!=null&&p(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function PP(n){const e={},t=h(n,["content"]);t!=null&&p(e,["content"],t);const r=h(n,["citationMetadata"]);r!=null&&p(e,["citationMetadata"],kP(r));const i=h(n,["tokenCount"]);i!=null&&p(e,["tokenCount"],i);const o=h(n,["finishReason"]);o!=null&&p(e,["finishReason"],o);const l=h(n,["avgLogprobs"]);l!=null&&p(e,["avgLogprobs"],l);const u=h(n,["groundingMetadata"]);u!=null&&p(e,["groundingMetadata"],u);const d=h(n,["index"]);d!=null&&p(e,["index"],d);const f=h(n,["logprobsResult"]);f!=null&&p(e,["logprobsResult"],f);const y=h(n,["safetyRatings"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(S=>S)),p(e,["safetyRatings"],E)}const v=h(n,["urlContextMetadata"]);return v!=null&&p(e,["urlContextMetadata"],v),e}function kP(n){const e={},t=h(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),p(e,["citations"],r)}return e}function bP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let o=Xn(i);Array.isArray(o)&&(o=o.map(l=>l)),p(t,["contents"],o)}return t}function DP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),p(e,["tokensInfo"],i)}return e}function MP(n){const e={},t=h(n,["values"]);t!=null&&p(e,["values"],t);const r=h(n,["statistics"]);return r!=null&&p(e,["statistics"],VP(r)),e}function VP(n){const e={},t=h(n,["truncated"]);t!=null&&p(e,["truncated"],t);const r=h(n,["token_count"]);return r!=null&&p(e,["tokenCount"],r),e}function kh(n){const e={},t=h(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>Hk(o))),p(e,["parts"],i)}const r=h(n,["role"]);return r!=null&&p(e,["role"],r),e}function LP(n){const e={},t=h(n,["controlType"]);t!=null&&p(e,["controlType"],t);const r=h(n,["enableControlImageComputation"]);return r!=null&&p(e,["computeControl"],r),e}function FP(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function UP(n,e){const t={},r=h(n,["systemInstruction"]);e!==void 0&&r!=null&&p(e,["systemInstruction"],un(r));const i=h(n,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>HT(u))),p(e,["tools"],l)}const o=h(n,["generationConfig"]);return e!==void 0&&o!=null&&p(e,["generationConfig"],Nk(o)),t}function OP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let l=Xn(i);Array.isArray(l)&&(l=l.map(u=>kh(u))),p(t,["contents"],l)}const o=h(e,["config"]);return o!=null&&FP(o),t}function BP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let l=Xn(i);Array.isArray(l)&&(l=l.map(u=>u)),p(t,["contents"],l)}const o=h(e,["config"]);return o!=null&&UP(o,t),t}function GP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["totalTokens"]);r!=null&&p(e,["totalTokens"],r);const i=h(n,["cachedContentTokenCount"]);return i!=null&&p(e,["cachedContentTokenCount"],i),e}function qP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["totalTokens"]);return r!=null&&p(e,["totalTokens"],r),e}function zP(n,e){const t={},r=h(e,["model"]);return r!=null&&p(t,["_url","name"],Ze(n,r)),t}function HP(n,e){const t={},r=h(e,["model"]);return r!=null&&p(t,["_url","name"],Ze(n,r)),t}function $P(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function KP(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function WP(n,e){const t={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);const i=h(n,["negativePrompt"]);e!==void 0&&i!=null&&p(e,["parameters","negativePrompt"],i);const o=h(n,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const u=h(n,["guidanceScale"]);e!==void 0&&u!=null&&p(e,["parameters","guidanceScale"],u);const d=h(n,["seed"]);e!==void 0&&d!=null&&p(e,["parameters","seed"],d);const f=h(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&p(e,["parameters","safetySetting"],f);const y=h(n,["personGeneration"]);e!==void 0&&y!=null&&p(e,["parameters","personGeneration"],y);const v=h(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const E=h(n,["includeRaiReason"]);e!==void 0&&E!=null&&p(e,["parameters","includeRaiReason"],E);const S=h(n,["language"]);e!==void 0&&S!=null&&p(e,["parameters","language"],S);const N=h(n,["outputMimeType"]);e!==void 0&&N!=null&&p(e,["parameters","outputOptions","mimeType"],N);const M=h(n,["outputCompressionQuality"]);e!==void 0&&M!=null&&p(e,["parameters","outputOptions","compressionQuality"],M);const k=h(n,["addWatermark"]);e!==void 0&&k!=null&&p(e,["parameters","addWatermark"],k);const B=h(n,["labels"]);e!==void 0&&B!=null&&p(e,["labels"],B);const q=h(n,["editMode"]);e!==void 0&&q!=null&&p(e,["parameters","editMode"],q);const H=h(n,["baseSteps"]);return e!==void 0&&H!=null&&p(e,["parameters","editConfig","baseSteps"],H),t}function jP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["prompt"]);i!=null&&p(t,["instances[0]","prompt"],i);const o=h(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>Qk(d))),p(t,["instances[0]","referenceImages"],u)}const l=h(e,["config"]);return l!=null&&WP(l,t),t}function JP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>bh(o))),p(e,["generatedImages"],i)}return e}function QP(n,e){const t={},r=h(n,["taskType"]);e!==void 0&&r!=null&&p(e,["requests[]","taskType"],r);const i=h(n,["title"]);e!==void 0&&i!=null&&p(e,["requests[]","title"],i);const o=h(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&p(e,["requests[]","outputDimensionality"],o),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function YP(n,e){const t={},r=h(n,["taskType"]);e!==void 0&&r!=null&&p(e,["instances[]","task_type"],r);const i=h(n,["title"]);e!==void 0&&i!=null&&p(e,["instances[]","title"],i);const o=h(n,["outputDimensionality"]);e!==void 0&&o!=null&&p(e,["parameters","outputDimensionality"],o);const l=h(n,["mimeType"]);e!==void 0&&l!=null&&p(e,["instances[]","mimeType"],l);const u=h(n,["autoTruncate"]);return e!==void 0&&u!=null&&p(e,["parameters","autoTruncate"],u),t}function XP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let u=ig(n,i);Array.isArray(u)&&(u=u.map(d=>d)),p(t,["requests[]","content"],u)}const o=h(e,["config"]);o!=null&&QP(o,t);const l=h(e,["model"]);return l!==void 0&&p(t,["requests[]","model"],Ze(n,l)),t}function ZP(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let l=ig(n,i);Array.isArray(l)&&(l=l.map(u=>u)),p(t,["instances[]","content"],l)}const o=h(e,["config"]);return o!=null&&YP(o,t),t}function ek(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["embeddings"],o)}const i=h(n,["metadata"]);return i!=null&&p(e,["metadata"],i),e}function tk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>MP(l))),p(e,["embeddings"],o)}const i=h(n,["metadata"]);return i!=null&&p(e,["metadata"],i),e}function nk(n){const e={},t=h(n,["endpoint"]);t!=null&&p(e,["name"],t);const r=h(n,["deployedModelId"]);return r!=null&&p(e,["deployedModelId"],r),e}function rk(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function ik(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const r=h(n,["args"]);r!=null&&p(e,["args"],r);const i=h(n,["name"]);if(i!=null&&p(e,["name"],i),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function sk(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const r=h(n,["allowedFunctionNames"]);if(r!=null&&p(e,["allowedFunctionNames"],r),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ok(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const i=h(n,["parameters"]);i!=null&&p(e,["parameters"],i);const o=h(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const u=h(n,["responseJsonSchema"]);return u!=null&&p(e,["responseJsonSchema"],u),e}function ak(n,e,t){const r={},i=h(e,["systemInstruction"]);t!==void 0&&i!=null&&p(t,["systemInstruction"],kh(un(i)));const o=h(e,["temperature"]);o!=null&&p(r,["temperature"],o);const l=h(e,["topP"]);l!=null&&p(r,["topP"],l);const u=h(e,["topK"]);u!=null&&p(r,["topK"],u);const d=h(e,["candidateCount"]);d!=null&&p(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&p(r,["maxOutputTokens"],f);const y=h(e,["stopSequences"]);y!=null&&p(r,["stopSequences"],y);const v=h(e,["responseLogprobs"]);v!=null&&p(r,["responseLogprobs"],v);const E=h(e,["logprobs"]);E!=null&&p(r,["logprobs"],E);const S=h(e,["presencePenalty"]);S!=null&&p(r,["presencePenalty"],S);const N=h(e,["frequencyPenalty"]);N!=null&&p(r,["frequencyPenalty"],N);const M=h(e,["seed"]);M!=null&&p(r,["seed"],M);const k=h(e,["responseMimeType"]);k!=null&&p(r,["responseMimeType"],k);const B=h(e,["responseSchema"]);B!=null&&p(r,["responseSchema"],sg(B));const q=h(e,["responseJsonSchema"]);if(q!=null&&p(r,["responseJsonSchema"],q),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const H=h(e,["safetySettings"]);if(t!==void 0&&H!=null){let D=H;Array.isArray(D)&&(D=D.map(Fe=>Yk(Fe))),p(t,["safetySettings"],D)}const ee=h(e,["tools"]);if(t!==void 0&&ee!=null){let D=il(ee);Array.isArray(D)&&(D=D.map(Fe=>ib(rl(Fe)))),p(t,["tools"],D)}const te=h(e,["toolConfig"]);if(t!==void 0&&te!=null&&p(t,["toolConfig"],rb(te)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);t!==void 0&&j!=null&&p(t,["cachedContent"],yi(n,j));const b=h(e,["responseModalities"]);b!=null&&p(r,["responseModalities"],b);const R=h(e,["mediaResolution"]);R!=null&&p(r,["mediaResolution"],R);const P=h(e,["speechConfig"]);if(P!=null&&p(r,["speechConfig"],og(P)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&p(r,["thinkingConfig"],L);const F=h(e,["imageConfig"]);F!=null&&p(r,["imageConfig"],Mk(F));const G=h(e,["enableEnhancedCivicAnswers"]);return G!=null&&p(r,["enableEnhancedCivicAnswers"],G),r}function lk(n,e,t){const r={},i=h(e,["systemInstruction"]);t!==void 0&&i!=null&&p(t,["systemInstruction"],un(i));const o=h(e,["temperature"]);o!=null&&p(r,["temperature"],o);const l=h(e,["topP"]);l!=null&&p(r,["topP"],l);const u=h(e,["topK"]);u!=null&&p(r,["topK"],u);const d=h(e,["candidateCount"]);d!=null&&p(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&p(r,["maxOutputTokens"],f);const y=h(e,["stopSequences"]);y!=null&&p(r,["stopSequences"],y);const v=h(e,["responseLogprobs"]);v!=null&&p(r,["responseLogprobs"],v);const E=h(e,["logprobs"]);E!=null&&p(r,["logprobs"],E);const S=h(e,["presencePenalty"]);S!=null&&p(r,["presencePenalty"],S);const N=h(e,["frequencyPenalty"]);N!=null&&p(r,["frequencyPenalty"],N);const M=h(e,["seed"]);M!=null&&p(r,["seed"],M);const k=h(e,["responseMimeType"]);k!=null&&p(r,["responseMimeType"],k);const B=h(e,["responseSchema"]);B!=null&&p(r,["responseSchema"],sg(B));const q=h(e,["responseJsonSchema"]);q!=null&&p(r,["responseJsonSchema"],q);const H=h(e,["routingConfig"]);H!=null&&p(r,["routingConfig"],H);const ee=h(e,["modelSelectionConfig"]);ee!=null&&p(r,["modelConfig"],ee);const te=h(e,["safetySettings"]);if(t!==void 0&&te!=null){let fe=te;Array.isArray(fe)&&(fe=fe.map(Ie=>Ie)),p(t,["safetySettings"],fe)}const j=h(e,["tools"]);if(t!==void 0&&j!=null){let fe=il(j);Array.isArray(fe)&&(fe=fe.map(Ie=>HT(rl(Ie)))),p(t,["tools"],fe)}const b=h(e,["toolConfig"]);t!==void 0&&b!=null&&p(t,["toolConfig"],b);const R=h(e,["labels"]);t!==void 0&&R!=null&&p(t,["labels"],R);const P=h(e,["cachedContent"]);t!==void 0&&P!=null&&p(t,["cachedContent"],yi(n,P));const L=h(e,["responseModalities"]);L!=null&&p(r,["responseModalities"],L);const F=h(e,["mediaResolution"]);F!=null&&p(r,["mediaResolution"],F);const G=h(e,["speechConfig"]);G!=null&&p(r,["speechConfig"],og(G));const D=h(e,["audioTimestamp"]);D!=null&&p(r,["audioTimestamp"],D);const Fe=h(e,["thinkingConfig"]);Fe!=null&&p(r,["thinkingConfig"],Fe);const Z=h(e,["imageConfig"]);if(Z!=null&&p(r,["imageConfig"],Vk(Z)),h(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function cw(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let l=Xn(i);Array.isArray(l)&&(l=l.map(u=>kh(u))),p(t,["contents"],l)}const o=h(e,["config"]);return o!=null&&p(t,["generationConfig"],ak(n,o,t)),t}function dw(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["contents"]);if(i!=null){let l=Xn(i);Array.isArray(l)&&(l=l.map(u=>u)),p(t,["contents"],l)}const o=h(e,["config"]);return o!=null&&p(t,["generationConfig"],lk(n,o,t)),t}function hw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>PP(f))),p(e,["candidates"],d)}const i=h(n,["modelVersion"]);i!=null&&p(e,["modelVersion"],i);const o=h(n,["promptFeedback"]);o!=null&&p(e,["promptFeedback"],o);const l=h(n,["responseId"]);l!=null&&p(e,["responseId"],l);const u=h(n,["usageMetadata"]);return u!=null&&p(e,["usageMetadata"],u),e}function fw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(y=>y)),p(e,["candidates"],f)}const i=h(n,["createTime"]);i!=null&&p(e,["createTime"],i);const o=h(n,["modelVersion"]);o!=null&&p(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&p(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&p(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&p(e,["usageMetadata"],d),e}function uk(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(n,["numberOfImages"]);e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r);const i=h(n,["aspectRatio"]);e!==void 0&&i!=null&&p(e,["parameters","aspectRatio"],i);const o=h(n,["guidanceScale"]);if(e!==void 0&&o!=null&&p(e,["parameters","guidanceScale"],o),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&p(e,["parameters","safetySetting"],l);const u=h(n,["personGeneration"]);e!==void 0&&u!=null&&p(e,["parameters","personGeneration"],u);const d=h(n,["includeSafetyAttributes"]);e!==void 0&&d!=null&&p(e,["parameters","includeSafetyAttributes"],d);const f=h(n,["includeRaiReason"]);e!==void 0&&f!=null&&p(e,["parameters","includeRaiReason"],f);const y=h(n,["language"]);e!==void 0&&y!=null&&p(e,["parameters","language"],y);const v=h(n,["outputMimeType"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","mimeType"],v);const E=h(n,["outputCompressionQuality"]);if(e!==void 0&&E!=null&&p(e,["parameters","outputOptions","compressionQuality"],E),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=h(n,["imageSize"]);if(e!==void 0&&S!=null&&p(e,["parameters","sampleImageSize"],S),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function ck(n,e){const t={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);const i=h(n,["negativePrompt"]);e!==void 0&&i!=null&&p(e,["parameters","negativePrompt"],i);const o=h(n,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const u=h(n,["guidanceScale"]);e!==void 0&&u!=null&&p(e,["parameters","guidanceScale"],u);const d=h(n,["seed"]);e!==void 0&&d!=null&&p(e,["parameters","seed"],d);const f=h(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&p(e,["parameters","safetySetting"],f);const y=h(n,["personGeneration"]);e!==void 0&&y!=null&&p(e,["parameters","personGeneration"],y);const v=h(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const E=h(n,["includeRaiReason"]);e!==void 0&&E!=null&&p(e,["parameters","includeRaiReason"],E);const S=h(n,["language"]);e!==void 0&&S!=null&&p(e,["parameters","language"],S);const N=h(n,["outputMimeType"]);e!==void 0&&N!=null&&p(e,["parameters","outputOptions","mimeType"],N);const M=h(n,["outputCompressionQuality"]);e!==void 0&&M!=null&&p(e,["parameters","outputOptions","compressionQuality"],M);const k=h(n,["addWatermark"]);e!==void 0&&k!=null&&p(e,["parameters","addWatermark"],k);const B=h(n,["labels"]);e!==void 0&&B!=null&&p(e,["labels"],B);const q=h(n,["imageSize"]);e!==void 0&&q!=null&&p(e,["parameters","sampleImageSize"],q);const H=h(n,["enhancePrompt"]);return e!==void 0&&H!=null&&p(e,["parameters","enhancePrompt"],H),t}function dk(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["prompt"]);i!=null&&p(t,["instances[0]","prompt"],i);const o=h(e,["config"]);return o!=null&&uk(o,t),t}function hk(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["prompt"]);i!=null&&p(t,["instances[0]","prompt"],i);const o=h(e,["config"]);return o!=null&&ck(o,t),t}function fk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Sk(l))),p(e,["generatedImages"],o)}const i=h(n,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],qT(i)),e}function pk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>bh(l))),p(e,["generatedImages"],o)}const i=h(n,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],zT(i)),e}function mk(n,e){const t={},r=h(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=h(n,["durationSeconds"]);if(e!==void 0&&i!=null&&p(e,["parameters","durationSeconds"],i),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=h(n,["aspectRatio"]);e!==void 0&&o!=null&&p(e,["parameters","aspectRatio"],o);const l=h(n,["resolution"]);e!==void 0&&l!=null&&p(e,["parameters","resolution"],l);const u=h(n,["personGeneration"]);if(e!==void 0&&u!=null&&p(e,["parameters","personGeneration"],u),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=h(n,["negativePrompt"]);e!==void 0&&d!=null&&p(e,["parameters","negativePrompt"],d);const f=h(n,["enhancePrompt"]);if(e!==void 0&&f!=null&&p(e,["parameters","enhancePrompt"],f),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const y=h(n,["lastFrame"]);e!==void 0&&y!=null&&p(e,["instances[0]","lastFrame"],Dh(y));const v=h(n,["referenceImages"]);if(e!==void 0&&v!=null){let E=v;Array.isArray(E)&&(E=E.map(S=>yb(S))),p(e,["instances[0]","referenceImages"],E)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function gk(n,e){const t={},r=h(n,["numberOfVideos"]);e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r);const i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const o=h(n,["fps"]);e!==void 0&&o!=null&&p(e,["parameters","fps"],o);const l=h(n,["durationSeconds"]);e!==void 0&&l!=null&&p(e,["parameters","durationSeconds"],l);const u=h(n,["seed"]);e!==void 0&&u!=null&&p(e,["parameters","seed"],u);const d=h(n,["aspectRatio"]);e!==void 0&&d!=null&&p(e,["parameters","aspectRatio"],d);const f=h(n,["resolution"]);e!==void 0&&f!=null&&p(e,["parameters","resolution"],f);const y=h(n,["personGeneration"]);e!==void 0&&y!=null&&p(e,["parameters","personGeneration"],y);const v=h(n,["pubsubTopic"]);e!==void 0&&v!=null&&p(e,["parameters","pubsubTopic"],v);const E=h(n,["negativePrompt"]);e!==void 0&&E!=null&&p(e,["parameters","negativePrompt"],E);const S=h(n,["enhancePrompt"]);e!==void 0&&S!=null&&p(e,["parameters","enhancePrompt"],S);const N=h(n,["generateAudio"]);e!==void 0&&N!=null&&p(e,["parameters","generateAudio"],N);const M=h(n,["lastFrame"]);e!==void 0&&M!=null&&p(e,["instances[0]","lastFrame"],gr(M));const k=h(n,["referenceImages"]);if(e!==void 0&&k!=null){let H=k;Array.isArray(H)&&(H=H.map(ee=>vb(ee))),p(e,["instances[0]","referenceImages"],H)}const B=h(n,["mask"]);e!==void 0&&B!=null&&p(e,["instances[0]","mask"],gb(B));const q=h(n,["compressionQuality"]);return e!==void 0&&q!=null&&p(e,["parameters","compressionQuality"],q),t}function yk(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response","generateVideoResponse"]);return l!=null&&p(e,["response"],Ek(l)),e}function vk(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response"]);return l!=null&&p(e,["response"],Tk(l)),e}function _k(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["prompt"]);i!=null&&p(t,["instances[0]","prompt"],i);const o=h(e,["image"]);o!=null&&p(t,["instances[0]","image"],Dh(o));const l=h(e,["video"]);l!=null&&p(t,["instances[0]","video"],$T(l));const u=h(e,["source"]);u!=null&&xk(u,t);const d=h(e,["config"]);return d!=null&&mk(d,t),t}function wk(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["prompt"]);i!=null&&p(t,["instances[0]","prompt"],i);const o=h(e,["image"]);o!=null&&p(t,["instances[0]","image"],gr(o));const l=h(e,["video"]);l!=null&&p(t,["instances[0]","video"],KT(l));const u=h(e,["source"]);u!=null&&Ik(u,t);const d=h(e,["config"]);return d!=null&&gk(d,t),t}function Ek(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Ck(l))),p(e,["generatedVideos"],o)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&p(e,["raiMediaFilteredCount"],r);const i=h(n,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function Tk(n){const e={},t=h(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Rk(l))),p(e,["generatedVideos"],o)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&p(e,["raiMediaFilteredCount"],r);const i=h(n,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function xk(n,e){const t={},r=h(n,["prompt"]);e!==void 0&&r!=null&&p(e,["instances[0]","prompt"],r);const i=h(n,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],Dh(i));const o=h(n,["video"]);return e!==void 0&&o!=null&&p(e,["instances[0]","video"],$T(o)),t}function Ik(n,e){const t={},r=h(n,["prompt"]);e!==void 0&&r!=null&&p(e,["instances[0]","prompt"],r);const i=h(n,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],gr(i));const o=h(n,["video"]);return e!==void 0&&o!=null&&p(e,["instances[0]","video"],KT(o)),t}function Sk(n){const e={},t=h(n,["_self"]);t!=null&&p(e,["image"],Lk(t));const r=h(n,["raiFilteredReason"]);r!=null&&p(e,["raiFilteredReason"],r);const i=h(n,["_self"]);return i!=null&&p(e,["safetyAttributes"],qT(i)),e}function bh(n){const e={},t=h(n,["_self"]);t!=null&&p(e,["image"],GT(t));const r=h(n,["raiFilteredReason"]);r!=null&&p(e,["raiFilteredReason"],r);const i=h(n,["_self"]);i!=null&&p(e,["safetyAttributes"],zT(i));const o=h(n,["prompt"]);return o!=null&&p(e,["enhancedPrompt"],o),e}function Ak(n){const e={},t=h(n,["_self"]);t!=null&&p(e,["mask"],GT(t));const r=h(n,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),p(e,["labels"],i)}return e}function Ck(n){const e={},t=h(n,["video"]);return t!=null&&p(e,["video"],pb(t)),e}function Rk(n){const e={},t=h(n,["_self"]);return t!=null&&p(e,["video"],mb(t)),e}function Nk(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&p(e,["modelConfig"],t);const r=h(n,["responseJsonSchema"]);r!=null&&p(e,["responseJsonSchema"],r);const i=h(n,["audioTimestamp"]);i!=null&&p(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&p(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&p(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&p(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&p(e,["logprobs"],d);const f=h(n,["maxOutputTokens"]);f!=null&&p(e,["maxOutputTokens"],f);const y=h(n,["mediaResolution"]);y!=null&&p(e,["mediaResolution"],y);const v=h(n,["presencePenalty"]);v!=null&&p(e,["presencePenalty"],v);const E=h(n,["responseLogprobs"]);E!=null&&p(e,["responseLogprobs"],E);const S=h(n,["responseMimeType"]);S!=null&&p(e,["responseMimeType"],S);const N=h(n,["responseModalities"]);N!=null&&p(e,["responseModalities"],N);const M=h(n,["responseSchema"]);M!=null&&p(e,["responseSchema"],M);const k=h(n,["routingConfig"]);k!=null&&p(e,["routingConfig"],k);const B=h(n,["seed"]);B!=null&&p(e,["seed"],B);const q=h(n,["speechConfig"]);q!=null&&p(e,["speechConfig"],q);const H=h(n,["stopSequences"]);H!=null&&p(e,["stopSequences"],H);const ee=h(n,["temperature"]);ee!=null&&p(e,["temperature"],ee);const te=h(n,["thinkingConfig"]);te!=null&&p(e,["thinkingConfig"],te);const j=h(n,["topK"]);j!=null&&p(e,["topK"],j);const b=h(n,["topP"]);if(b!=null&&p(e,["topP"],b),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Pk(n,e){const t={},r=h(e,["model"]);return r!=null&&p(t,["_url","name"],Ze(n,r)),t}function kk(n,e){const t={},r=h(e,["model"]);return r!=null&&p(t,["_url","name"],Ze(n,r)),t}function bk(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function Dk(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function Mk(n){const e={},t=h(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);const r=h(n,["imageSize"]);if(r!=null&&p(e,["imageSize"],r),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Vk(n){const e={},t=h(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);const r=h(n,["imageSize"]);r!=null&&p(e,["imageSize"],r);const i=h(n,["outputMimeType"]);i!=null&&p(e,["imageOutputOptions","mimeType"],i);const o=h(n,["outputCompressionQuality"]);return o!=null&&p(e,["imageOutputOptions","compressionQuality"],o),e}function Lk(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&p(e,["imageBytes"],_s(t));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function GT(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const r=h(n,["bytesBase64Encoded"]);r!=null&&p(e,["imageBytes"],_s(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Dh(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&p(e,["bytesBase64Encoded"],_s(t));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function gr(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const r=h(n,["imageBytes"]);r!=null&&p(e,["bytesBase64Encoded"],_s(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Fk(n,e,t){const r={},i=h(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const o=h(e,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const u=h(e,["queryBase"]);return t!==void 0&&u!=null&&p(t,["_url","models_url"],MT(n,u)),r}function Uk(n,e,t){const r={},i=h(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const o=h(e,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const u=h(e,["queryBase"]);return t!==void 0&&u!=null&&p(t,["_url","models_url"],MT(n,u)),r}function Ok(n,e){const t={},r=h(e,["config"]);return r!=null&&Fk(n,r,t),t}function Bk(n,e){const t={},r=h(e,["config"]);return r!=null&&Uk(n,r,t),t}function Gk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["_self"]);if(i!=null){let o=VT(i);Array.isArray(o)&&(o=o.map(l=>lm(l))),p(e,["models"],o)}return e}function qk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["_self"]);if(i!=null){let o=VT(i);Array.isArray(o)&&(o=o.map(l=>um(l))),p(e,["models"],o)}return e}function zk(n){const e={},t=h(n,["maskMode"]);t!=null&&p(e,["maskMode"],t);const r=h(n,["segmentationClasses"]);r!=null&&p(e,["maskClasses"],r);const i=h(n,["maskDilation"]);return i!=null&&p(e,["dilation"],i),e}function lm(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["displayName"]);r!=null&&p(e,["displayName"],r);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const o=h(n,["version"]);o!=null&&p(e,["version"],o);const l=h(n,["_self"]);l!=null&&p(e,["tunedModelInfo"],sb(l));const u=h(n,["inputTokenLimit"]);u!=null&&p(e,["inputTokenLimit"],u);const d=h(n,["outputTokenLimit"]);d!=null&&p(e,["outputTokenLimit"],d);const f=h(n,["supportedGenerationMethods"]);f!=null&&p(e,["supportedActions"],f);const y=h(n,["temperature"]);y!=null&&p(e,["temperature"],y);const v=h(n,["maxTemperature"]);v!=null&&p(e,["maxTemperature"],v);const E=h(n,["topP"]);E!=null&&p(e,["topP"],E);const S=h(n,["topK"]);S!=null&&p(e,["topK"],S);const N=h(n,["thinking"]);return N!=null&&p(e,["thinking"],N),e}function um(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["displayName"]);r!=null&&p(e,["displayName"],r);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const o=h(n,["versionId"]);o!=null&&p(e,["version"],o);const l=h(n,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>nk(E))),p(e,["endpoints"],v)}const u=h(n,["labels"]);u!=null&&p(e,["labels"],u);const d=h(n,["_self"]);d!=null&&p(e,["tunedModelInfo"],ob(d));const f=h(n,["defaultCheckpointId"]);f!=null&&p(e,["defaultCheckpointId"],f);const y=h(n,["checkpoints"]);if(y!=null){let v=y;Array.isArray(v)&&(v=v.map(E=>E)),p(e,["checkpoints"],v)}return e}function Hk(n){const e={},t=h(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);const r=h(n,["codeExecutionResult"]);r!=null&&p(e,["codeExecutionResult"],r);const i=h(n,["executableCode"]);i!=null&&p(e,["executableCode"],i);const o=h(n,["fileData"]);o!=null&&p(e,["fileData"],rk(o));const l=h(n,["functionCall"]);l!=null&&p(e,["functionCall"],ik(l));const u=h(n,["functionResponse"]);u!=null&&p(e,["functionResponse"],u);const d=h(n,["inlineData"]);d!=null&&p(e,["inlineData"],NP(d));const f=h(n,["text"]);f!=null&&p(e,["text"],f);const y=h(n,["thought"]);y!=null&&p(e,["thought"],y);const v=h(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const E=h(n,["videoMetadata"]);return E!=null&&p(e,["videoMetadata"],E),e}function $k(n){const e={},t=h(n,["productImage"]);return t!=null&&p(e,["image"],gr(t)),e}function Kk(n,e){const t={},r=h(n,["numberOfImages"]);e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r);const i=h(n,["baseSteps"]);e!==void 0&&i!=null&&p(e,["parameters","baseSteps"],i);const o=h(n,["outputGcsUri"]);e!==void 0&&o!=null&&p(e,["parameters","storageUri"],o);const l=h(n,["seed"]);e!==void 0&&l!=null&&p(e,["parameters","seed"],l);const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&p(e,["parameters","safetySetting"],u);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&p(e,["parameters","personGeneration"],d);const f=h(n,["addWatermark"]);e!==void 0&&f!=null&&p(e,["parameters","addWatermark"],f);const y=h(n,["outputMimeType"]);e!==void 0&&y!=null&&p(e,["parameters","outputOptions","mimeType"],y);const v=h(n,["outputCompressionQuality"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","compressionQuality"],v);const E=h(n,["enhancePrompt"]);e!==void 0&&E!=null&&p(e,["parameters","enhancePrompt"],E);const S=h(n,["labels"]);return e!==void 0&&S!=null&&p(e,["labels"],S),t}function Wk(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["source"]);i!=null&&Jk(i,t);const o=h(e,["config"]);return o!=null&&Kk(o,t),t}function jk(n){const e={},t=h(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>bh(i))),p(e,["generatedImages"],r)}return e}function Jk(n,e){const t={},r=h(n,["prompt"]);e!==void 0&&r!=null&&p(e,["instances[0]","prompt"],r);const i=h(n,["personImage"]);e!==void 0&&i!=null&&p(e,["instances[0]","personImage","image"],gr(i));const o=h(n,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>$k(u))),p(e,["instances[0]","productImages"],l)}return t}function Qk(n){const e={},t=h(n,["referenceImage"]);t!=null&&p(e,["referenceImage"],gr(t));const r=h(n,["referenceId"]);r!=null&&p(e,["referenceId"],r);const i=h(n,["referenceType"]);i!=null&&p(e,["referenceType"],i);const o=h(n,["maskImageConfig"]);o!=null&&p(e,["maskImageConfig"],zk(o));const l=h(n,["controlImageConfig"]);l!=null&&p(e,["controlImageConfig"],LP(l));const u=h(n,["styleImageConfig"]);u!=null&&p(e,["styleImageConfig"],u);const d=h(n,["subjectImageConfig"]);return d!=null&&p(e,["subjectImageConfig"],d),e}function qT(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const r=h(n,["safetyAttributes","scores"]);r!=null&&p(e,["scores"],r);const i=h(n,["contentType"]);return i!=null&&p(e,["contentType"],i),e}function zT(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const r=h(n,["safetyAttributes","scores"]);r!=null&&p(e,["scores"],r);const i=h(n,["contentType"]);return i!=null&&p(e,["contentType"],i),e}function Yk(n){const e={},t=h(n,["category"]);if(t!=null&&p(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=h(n,["threshold"]);return r!=null&&p(e,["threshold"],r),e}function Xk(n){const e={},t=h(n,["image"]);return t!=null&&p(e,["image"],gr(t)),e}function Zk(n,e){const t={},r=h(n,["mode"]);e!==void 0&&r!=null&&p(e,["parameters","mode"],r);const i=h(n,["maxPredictions"]);e!==void 0&&i!=null&&p(e,["parameters","maxPredictions"],i);const o=h(n,["confidenceThreshold"]);e!==void 0&&o!=null&&p(e,["parameters","confidenceThreshold"],o);const l=h(n,["maskDilation"]);e!==void 0&&l!=null&&p(e,["parameters","maskDilation"],l);const u=h(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&p(e,["parameters","binaryColorThreshold"],u);const d=h(n,["labels"]);return e!==void 0&&d!=null&&p(e,["labels"],d),t}function eb(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["source"]);i!=null&&nb(i,t);const o=h(e,["config"]);return o!=null&&Zk(o,t),t}function tb(n){const e={},t=h(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>Ak(i))),p(e,["generatedMasks"],r)}return e}function nb(n,e){const t={},r=h(n,["prompt"]);e!==void 0&&r!=null&&p(e,["instances[0]","prompt"],r);const i=h(n,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],gr(i));const o=h(n,["scribbleImage"]);return e!==void 0&&o!=null&&p(e,["instances[0]","scribble"],Xk(o)),t}function rb(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],sk(t));const r=h(n,["retrievalConfig"]);return r!=null&&p(e,["retrievalConfig"],r),e}function ib(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let y=t;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["functionDeclarations"],y)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const i=h(n,["computerUse"]);i!=null&&p(e,["computerUse"],i);const o=h(n,["fileSearch"]);o!=null&&p(e,["fileSearch"],o);const l=h(n,["codeExecution"]);if(l!=null&&p(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=h(n,["googleMaps"]);u!=null&&p(e,["googleMaps"],bk(u));const d=h(n,["googleSearch"]);d!=null&&p(e,["googleSearch"],Dk(d));const f=h(n,["urlContext"]);return f!=null&&p(e,["urlContext"],f),e}function HT(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(E=>ok(E))),p(e,["functionDeclarations"],v)}const r=h(n,["retrieval"]);r!=null&&p(e,["retrieval"],r);const i=h(n,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);if(o!=null&&p(e,["computerUse"],o),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&p(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&p(e,["googleMaps"],d);const f=h(n,["googleSearch"]);f!=null&&p(e,["googleSearch"],f);const y=h(n,["urlContext"]);return y!=null&&p(e,["urlContext"],y),e}function sb(n){const e={},t=h(n,["baseModel"]);t!=null&&p(e,["baseModel"],t);const r=h(n,["createTime"]);r!=null&&p(e,["createTime"],r);const i=h(n,["updateTime"]);return i!=null&&p(e,["updateTime"],i),e}function ob(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&p(e,["baseModel"],t);const r=h(n,["createTime"]);r!=null&&p(e,["createTime"],r);const i=h(n,["updateTime"]);return i!=null&&p(e,["updateTime"],i),e}function ab(n,e){const t={},r=h(n,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const i=h(n,["description"]);e!==void 0&&i!=null&&p(e,["description"],i);const o=h(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),t}function lb(n,e){const t={},r=h(n,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const i=h(n,["description"]);e!==void 0&&i!=null&&p(e,["description"],i);const o=h(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),t}function ub(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","name"],Ze(n,r));const i=h(e,["config"]);return i!=null&&ab(i,t),t}function cb(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["config"]);return i!=null&&lb(i,t),t}function db(n,e){const t={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);const i=h(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&p(e,["parameters","safetySetting"],i);const o=h(n,["personGeneration"]);e!==void 0&&o!=null&&p(e,["parameters","personGeneration"],o);const l=h(n,["includeRaiReason"]);e!==void 0&&l!=null&&p(e,["parameters","includeRaiReason"],l);const u=h(n,["outputMimeType"]);e!==void 0&&u!=null&&p(e,["parameters","outputOptions","mimeType"],u);const d=h(n,["outputCompressionQuality"]);e!==void 0&&d!=null&&p(e,["parameters","outputOptions","compressionQuality"],d);const f=h(n,["enhanceInputImage"]);e!==void 0&&f!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],f);const y=h(n,["imagePreservationFactor"]);e!==void 0&&y!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],y);const v=h(n,["labels"]);e!==void 0&&v!=null&&p(e,["labels"],v);const E=h(n,["numberOfImages"]);e!==void 0&&E!=null&&p(e,["parameters","sampleCount"],E);const S=h(n,["mode"]);return e!==void 0&&S!=null&&p(e,["parameters","mode"],S),t}function hb(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["_url","model"],Ze(n,r));const i=h(e,["image"]);i!=null&&p(t,["instances[0]","image"],gr(i));const o=h(e,["upscaleFactor"]);o!=null&&p(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=h(e,["config"]);return l!=null&&db(l,t),t}function fb(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>bh(o))),p(e,["generatedImages"],i)}return e}function pb(n){const e={},t=h(n,["uri"]);t!=null&&p(e,["uri"],t);const r=h(n,["encodedVideo"]);r!=null&&p(e,["videoBytes"],_s(r));const i=h(n,["encoding"]);return i!=null&&p(e,["mimeType"],i),e}function mb(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["uri"],t);const r=h(n,["bytesBase64Encoded"]);r!=null&&p(e,["videoBytes"],_s(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function gb(n){const e={},t=h(n,["image"]);t!=null&&p(e,["_self"],gr(t));const r=h(n,["maskMode"]);return r!=null&&p(e,["maskMode"],r),e}function yb(n){const e={},t=h(n,["image"]);t!=null&&p(e,["image"],Dh(t));const r=h(n,["referenceType"]);return r!=null&&p(e,["referenceType"],r),e}function vb(n){const e={},t=h(n,["image"]);t!=null&&p(e,["image"],gr(t));const r=h(n,["referenceType"]);return r!=null&&p(e,["referenceType"],r),e}function $T(n){const e={},t=h(n,["uri"]);t!=null&&p(e,["uri"],t);const r=h(n,["videoBytes"]);r!=null&&p(e,["encodedVideo"],_s(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["encoding"],i),e}function KT(n){const e={},t=h(n,["uri"]);t!=null&&p(e,["gcsUri"],t);const r=h(n,["videoBytes"]);r!=null&&p(e,["bytesBase64Encoded"],_s(r));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function _b(n,e){const t={},r=h(n,["displayName"]);return e!==void 0&&r!=null&&p(e,["displayName"],r),t}function wb(n){const e={},t=h(n,["config"]);return t!=null&&_b(t,e),e}function Eb(n,e){const t={},r=h(n,["force"]);return e!==void 0&&r!=null&&p(e,["_query","force"],r),t}function Tb(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","name"],t);const r=h(n,["config"]);return r!=null&&Eb(r,e),e}function xb(n){const e={},t=h(n,["name"]);return t!=null&&p(e,["_url","name"],t),e}function Ib(n,e){const t={},r=h(n,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["customMetadata"],o)}const i=h(n,["chunkingConfig"]);return e!==void 0&&i!=null&&p(e,["chunkingConfig"],i),t}function Sb(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const o=h(n,["error"]);o!=null&&p(e,["error"],o);const l=h(n,["response"]);return l!=null&&p(e,["response"],Cb(l)),e}function Ab(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&p(e,["_url","file_search_store_name"],t);const r=h(n,["fileName"]);r!=null&&p(e,["fileName"],r);const i=h(n,["config"]);return i!=null&&Ib(i,e),e}function Cb(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["parent"]);r!=null&&p(e,["parent"],r);const i=h(n,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function Rb(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),t}function Nb(n){const e={},t=h(n,["config"]);return t!=null&&Rb(t,e),e}function Pb(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["fileSearchStores"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["fileSearchStores"],o)}return e}function WT(n,e){const t={},r=h(n,["mimeType"]);e!==void 0&&r!=null&&p(e,["mimeType"],r);const i=h(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const o=h(n,["customMetadata"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>d)),p(e,["customMetadata"],u)}const l=h(n,["chunkingConfig"]);return e!==void 0&&l!=null&&p(e,["chunkingConfig"],l),t}function kb(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&p(e,["_url","file_search_store_name"],t);const r=h(n,["config"]);return r!=null&&WT(r,e),e}function bb(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}const Db="Content-Type",Mb="X-Server-Timeout",Vb="User-Agent",cm="x-goog-api-client",Lb="1.34.0",Fb=`google-genai-sdk/${Lb}`,Ub="v1beta1",Ob="v1beta";class Bb{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Ub,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Ob,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,i.toString(),e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(t))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,i.toString(),e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,i){if(t&&t.timeout||i){const o=new AbortController,l=o.signal;if(t.timeout&&t?.timeout>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&Gb(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await pw(i),new sm(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await pw(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return hr(this,arguments,function*(){var r;const i=(r=e?.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const u="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:y}=yield Ve(i.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=o.decode(y,{stream:!0});try{const N=JSON.parse(v);if("error"in N){const M=JSON.parse(JSON.stringify(N.error)),k=M.status,B=M.code,q=`got status: ${k}. ${JSON.stringify(N)}`;if(B>=400&&B<600)throw new Ph({message:q,status:B})}}catch(N){if(N.name==="ApiError")throw N}l+=v;let E=-1,S=0;for(;;){E=-1,S=0;for(const k of d){const B=l.indexOf(k);B!==-1&&(E===-1||B<E)&&(E=B,S=k.length)}if(E===-1)break;const N=l.substring(0,E);l=l.substring(E+S);const M=N.trim();if(M.startsWith(u)){const k=M.substring(u.length).trim();try{const B=new Response(k,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Ve(new sm(B))}catch(B){throw new Error(`exception parsing stream chunk ${k}. ${B}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=Fb+" "+this.clientOptions.userAgentExtra;return e[Vb]=t,e[cm]=t,e[Db]="application/json",e}async getHeadersInternal(e,t){const r=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))r.append(i,o);e.timeout&&e.timeout>0&&r.append(Mb,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}getFileName(e){var t;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(t=r.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),r}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);i.sizeBytes=String(l.size);const u=(r=t?.mimeType)!==null&&r!==void 0?r:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d={file:i},f=this.getFileName(e),y=me("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(y,i.sizeBytes,i.mimeType,f,d,t?.httpOptions);return o.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,r){var i;const o=this.clientOptions.uploader,l=await o.stat(t),u=String(l.size),d=(i=r?.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${e}:uploadToFileSearchStore`,y=this.getFileName(t),v={};r!=null&&WT(r,v);const E=await this.fetchUploadUrl(f,u,d,y,v,r?.httpOptions);return o.uploadToFileSearchStore(t,E,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,r,i,o,l){var u;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const f=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:d});if(!f||!f?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const y=(u=f?.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(y===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return y}}async function pw(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(r);throw t>=400&&t<600?new Ph({message:i,status:t}):new Error(i)}}function Gb(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,l){const u=Object.assign({},o);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],y=u[d];f&&typeof f=="object"&&!Array.isArray(f)&&y&&typeof y=="object"&&!Array.isArray(y)?u[d]=r(y,f):(y&&f&&typeof y!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof y}, New type: ${typeof f}. Overwriting.`),u[d]=f)}return u}const i=r(t,e);n.body=JSON.stringify(i)}const qb="mcp_used/unknown";let zb=!1;function jT(n){for(const e of n)if(Hb(e)||typeof e=="object"&&"inputSchema"in e)return!0;return zb}function JT(n){var e;const t=(e=n[cm])!==null&&e!==void 0?e:"";n[cm]=(t+` ${qb}`).trimStart()}function Hb(n){return n!==null&&typeof n=="object"&&n instanceof lg}function $b(n){return hr(this,arguments,function*(t,r=100){let i,o=0;for(;o<r;){const l=yield Ve(t.listTools({cursor:i}));for(const u of l.tools)yield yield Ve(u),o++;if(!l.nextCursor)break;i=l.nextCursor}})}class lg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new lg(e,t)}async initialize(){var e,t,r,i;if(this.mcpTools.length>0)return;const o={},l=[];for(const y of this.mcpClients)try{for(var u=!0,d=(t=void 0,fr($b(y))),f;f=await d.next(),e=f.done,!e;u=!0){i=f.value,u=!1;const v=i;l.push(v);const E=v.name;if(o[E])throw new Error(`Duplicate function name ${E} found in MCP tools. Please ensure function names are unique.`);o[E]=y}}catch(v){t={error:v}}finally{try{!u&&!e&&(r=d.return)&&await r.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),xR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await i.callTool({name:r.name,arguments:r.args},void 0,o);t.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return t}}async function Kb(n,e,t){const r=new mR;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(r,i),e(r)}class Wb{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=Qb(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let f=()=>{};const y=new Promise(H=>{f=H}),v=e.callbacks,E=function(){f({})},S=this.apiClient,N={onopen:E,onmessage:H=>{Kb(S,v.onmessage,H)},onerror:(t=v?.onerror)!==null&&t!==void 0?t:function(H){},onclose:(r=v?.onclose)!==null&&r!==void 0?r:function(H){}},M=this.webSocketFactory.create(d,Jb(l),N);M.connect(),await y;const q={setup:{model:Ze(this.apiClient,e.model)}};return M.send(JSON.stringify(q)),new jb(M,this.apiClient)}}class jb{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=wP(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=_P(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Aa.PLAY)}pause(){this.sendPlaybackControl(Aa.PAUSE)}stop(){this.sendPlaybackControl(Aa.STOP)}resetContext(){this.sendPlaybackControl(Aa.RESET_CONTEXT)}close(){this.conn.close()}}function Jb(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function Qb(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const Yb="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Xb(n,e,t){const r=new pR;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const o=JSON.parse(i);if(n.isVertexAI()){const l=xP(o);Object.assign(r,l)}else Object.assign(r,o);e(r)}class Zb{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new Wb(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,o,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let y;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&jT(e.config.tools)&&JT(v);const E=r2(v);if(this.apiClient.isVertexAI())y=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(E,y);else{const P=this.apiClient.getApiKey();let L="BidiGenerateContent",F="key";P?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",F="access_token"),y=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${L}?${F}=${P}`}let S=()=>{};const N=new Promise(P=>{S=P}),M=e.callbacks,k=function(){var P;(P=M?.onopen)===null||P===void 0||P.call(M),S({})},B=this.apiClient,q={onopen:k,onmessage:P=>{Xb(B,M.onmessage,P)},onerror:(t=M?.onerror)!==null&&t!==void 0?t:function(P){},onclose:(r=M?.onclose)!==null&&r!==void 0?r:function(P){}},H=this.webSocketFactory.create(y,n2(E),q);H.connect(),await N;let ee=Ze(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&ee.startsWith("publishers/")){const P=this.apiClient.getProject(),L=this.apiClient.getLocation();ee=`projects/${P}/locations/${L}/`+ee}let te={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[nh.AUDIO]}:e.config.responseModalities=[nh.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const j=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],b=[];for(const P of j)if(this.isCallableTool(P)){const L=P;b.push(await L.tool())}else b.push(P);b.length>0&&(e.config.tools=b);const R={model:ee,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?te=vP(this.apiClient,R):te=yP(this.apiClient,R),delete te.config,H.send(JSON.stringify(te)),new t2(H,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const e2={turnComplete:!0};class t2{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Xn(t.turns),e.isVertexAI()||(r=r.map(i=>kh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Yb)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},e2),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:TP(e)}:t={realtimeInput:EP(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function n2(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function r2(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const mw=10;function gw(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=n?.tools)!==null&&t!==void 0?t:[])if(Na(l)){i=!0;break}if(!i)return!0;const o=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Na(n){return"callTool"in n&&typeof n.callTool=="function"}function i2(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Na(i)))!==null&&r!==void 0?r:!1}function yw(n){var e;const t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((r,i)=>{if(Na(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(i)}),t}function vw(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class s2 extends gi{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,o,l,u;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!i2(t)||gw(t.config))return await this.generateContentInternal(d);const f=yw(t);if(f.length>0){const M=f.map(k=>`tools[${k}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${M}.`)}let y,v;const E=Xn(d.contents),S=(o=(i=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:mw;let N=0;for(;N<S&&(y=await this.generateContentInternal(d),!(!y.functionCalls||y.functionCalls.length===0));){const M=y.candidates[0].content,k=[];for(const B of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(Na(B)){const H=await B.callTool(y.functionCalls);k.push(...H)}N++,v={role:"user",parts:k},d.contents=Xn(d.contents),d.contents.push(M),d.contents.push(v),vw(d.config)&&(E.push(M),E.push(v))}return vw(d.config)&&(y.automaticFunctionCallingHistory=E),y},this.generateContentStream=async t=>{var r,i,o,l,u;if(this.maybeMoveToResponseJsonSchem(t),gw(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const d=yw(t);if(d.length>0){const v=d.map(E=>`tools[${E}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(i=(r=t?.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,y=(u=(l=t?.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(f&&!y)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let o;const l=[];if(r?.generatedImages)for(const d of r.generatedImages)d&&d?.safetyAttributes&&((i=d?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=d?.safetyAttributes:l.push(d);let u;return o?u={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new xo(hi.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var r,i,o,l,u,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=t.video)===null||r===void 0)&&r.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((d=(u=t.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,r,i;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async d=>Na(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&jT(e.config.tools)){const d=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),JT(f),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return u}async initAfcToolsMap(e){var t,r,i;const o=new Map;for(const l of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(Na(l)){const u=l,d=await u.tool();for(const f of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,u)}}return o}async processAfcStream(e){var t,r,i;const o=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:mw;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return(function(f,y,v){return hr(this,arguments,function*(){for(var E,S,N,M,k,B;u<o;){l&&(u++,l=!1);const te=yield Ve(f.processParamsMaybeAddMcpUsage(v)),j=yield Ve(f.generateContentStreamInternal(te)),b=[],R=[];try{for(var q=!0,H=(S=void 0,fr(j)),ee;ee=yield Ve(H.next()),E=ee.done,!E;q=!0){M=ee.value,q=!1;const P=M;if(yield yield Ve(P),P.candidates&&(!((k=P.candidates[0])===null||k===void 0)&&k.content)){R.push(P.candidates[0].content);for(const L of(B=P.candidates[0].content.parts)!==null&&B!==void 0?B:[])if(u<o&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(L.functionCall.name)){const F=yield Ve(y.get(L.functionCall.name).callTool([L.functionCall]));b.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(P){S={error:P}}finally{try{!q&&!E&&(N=H.return)&&(yield Ve(N.call(H)))}finally{if(S)throw S.error}}if(b.length>0){l=!0;const P=new au;P.candidates=[{content:{role:"user",parts:b}}],yield yield Ve(P);const L=[];L.push(...R),L.push({role:"user",parts:b});const F=Xn(v.contents).concat(L);v.contents=F}else break}})})(this,d,e)}async generateContentInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=dw(this.apiClient,e);return u=me("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=fw(y),E=new au;return Object.assign(E,v),E})}else{const f=cw(this.apiClient,e);return u=me("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=hw(y),E=new au;return Object.assign(E,v),E})}}async generateContentStreamInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=dw(this.apiClient,e);return u=me("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return hr(this,arguments,function*(){var E,S,N,M;try{for(var k=!0,B=fr(v),q;q=yield Ve(B.next()),E=q.done,!E;k=!0){M=q.value,k=!1;const H=M,ee=fw(yield Ve(H.json()));ee.sdkHttpResponse={headers:H.headers};const te=new au;Object.assign(te,ee),yield yield Ve(te)}}catch(H){S={error:H}}finally{try{!k&&!E&&(N=B.return)&&(yield Ve(N.call(B)))}finally{if(S)throw S.error}}})})}else{const f=cw(this.apiClient,e);return u=me("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(v){return hr(this,arguments,function*(){var E,S,N,M;try{for(var k=!0,B=fr(v),q;q=yield Ve(B.next()),E=q.done,!E;k=!0){M=q.value,k=!1;const H=M,ee=hw(yield Ve(H.json()));ee.sdkHttpResponse={headers:H.headers};const te=new au;Object.assign(te,ee),yield yield Ve(te)}}catch(H){S={error:H}}finally{try{!k&&!E&&(N=B.return)&&(yield Ve(N.call(B)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=ZP(this.apiClient,e);return u=me("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=tk(y),E=new W0;return Object.assign(E,v),E})}else{const f=XP(this.apiClient,e);return u=me("{model}:batchEmbedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=ek(y),E=new W0;return Object.assign(E,v),E})}}async generateImagesInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=hk(this.apiClient,e);return u=me("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=pk(y),E=new j0;return Object.assign(E,v),E})}else{const f=dk(this.apiClient,e);return u=me("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=fk(y),E=new j0;return Object.assign(E,v),E})}}async editImageInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=jP(this.apiClient,e);return o=me("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>{const f=JP(d),y=new rR;return Object.assign(y,f),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=hb(this.apiClient,e);return o=me("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>{const f=fb(d),y=new iR;return Object.assign(y,f),y})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=Wk(this.apiClient,e);return o=me("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=jk(d),y=new sR;return Object.assign(y,f),y})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=eb(this.apiClient,e);return o=me("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=tb(d),y=new oR;return Object.assign(y,f),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=kk(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>um(y))}else{const f=Pk(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>lm(y))}}async listInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=Bk(this.apiClient,e);return u=me("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=qk(y),E=new J0;return Object.assign(E,v),E})}else{const f=Ok(this.apiClient,e);return u=me("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=Gk(y),E=new J0;return Object.assign(E,v),E})}}async update(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=cb(this.apiClient,e);return u=me("{model}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>um(y))}else{const f=ub(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>lm(y))}}async delete(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=HP(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=KP(y),E=new Q0;return Object.assign(E,v),E})}else{const f=zP(this.apiClient,e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=$P(y),E=new Q0;return Object.assign(E,v),E})}}async countTokens(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=BP(this.apiClient,e);return u=me("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=qP(y),E=new Y0;return Object.assign(E,v),E})}else{const f=OP(this.apiClient,e);return u=me("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=GP(y),E=new Y0;return Object.assign(E,v),E})}}async computeTokens(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=bP(this.apiClient,e);return o=me("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>{const f=DP(d),y=new aR;return Object.assign(y,f),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=wk(this.apiClient,e);return u=me("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l.then(y=>{const v=vk(y),E=new rh;return Object.assign(E,v),E})}else{const f=_k(this.apiClient,e);return u=me("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l.then(y=>{const v=yk(y),E=new rh;return Object.assign(E,v),E})}}}class o2 extends gi{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=Y1(e);return u=me("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),l}else{const f=Q1(e);return u=me("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),l}}async fetchPredictVideosOperationInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=z1(e);return o=me("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}function a2(n){const e={},t=h(n,["data"]);if(t!=null&&p(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function l2(n){const e={},t=h(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>y2(o))),p(e,["parts"],i)}const r=h(n,["role"]);return r!=null&&p(e,["role"],r),e}function u2(n,e,t){const r={},i=h(e,["expireTime"]);t!==void 0&&i!=null&&p(t,["expireTime"],i);const o=h(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&p(t,["newSessionExpireTime"],o);const l=h(e,["uses"]);t!==void 0&&l!=null&&p(t,["uses"],l);const u=h(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&p(t,["bidiGenerateContentSetup"],g2(n,u));const d=h(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&p(t,["fieldMask"],d),r}function c2(n,e){const t={},r=h(e,["config"]);return r!=null&&p(t,["config"],u2(n,r,t)),t}function d2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function h2(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const r=h(n,["args"]);r!=null&&p(e,["args"],r);const i=h(n,["name"]);if(i!=null&&p(e,["name"],i),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function f2(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function p2(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function m2(n,e){const t={},r=h(n,["generationConfig"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig"],r);const i=h(n,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const o=h(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const u=h(n,["topK"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topK"],u);const d=h(n,["maxOutputTokens"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(n,["mediaResolution"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","mediaResolution"],f);const y=h(n,["seed"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","seed"],y);const v=h(n,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],ag(v));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&p(e,["setup","generationConfig","thinkingConfig"],E);const S=h(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],S);const N=h(n,["systemInstruction"]);e!==void 0&&N!=null&&p(e,["setup","systemInstruction"],l2(un(N)));const M=h(n,["tools"]);if(e!==void 0&&M!=null){let j=il(M);Array.isArray(j)&&(j=j.map(b=>_2(rl(b)))),p(e,["setup","tools"],j)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&p(e,["setup","sessionResumption"],v2(k));const B=h(n,["inputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","inputAudioTranscription"],B);const q=h(n,["outputAudioTranscription"]);e!==void 0&&q!=null&&p(e,["setup","outputAudioTranscription"],q);const H=h(n,["realtimeInputConfig"]);e!==void 0&&H!=null&&p(e,["setup","realtimeInputConfig"],H);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&p(e,["setup","contextWindowCompression"],ee);const te=h(n,["proactivity"]);if(e!==void 0&&te!=null&&p(e,["setup","proactivity"],te),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function g2(n,e){const t={},r=h(e,["model"]);r!=null&&p(t,["setup","model"],Ze(n,r));const i=h(e,["config"]);return i!=null&&p(t,["config"],m2(i,t)),t}function y2(n){const e={},t=h(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);const r=h(n,["codeExecutionResult"]);r!=null&&p(e,["codeExecutionResult"],r);const i=h(n,["executableCode"]);i!=null&&p(e,["executableCode"],i);const o=h(n,["fileData"]);o!=null&&p(e,["fileData"],d2(o));const l=h(n,["functionCall"]);l!=null&&p(e,["functionCall"],h2(l));const u=h(n,["functionResponse"]);u!=null&&p(e,["functionResponse"],u);const d=h(n,["inlineData"]);d!=null&&p(e,["inlineData"],a2(d));const f=h(n,["text"]);f!=null&&p(e,["text"],f);const y=h(n,["thought"]);y!=null&&p(e,["thought"],y);const v=h(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const E=h(n,["videoMetadata"]);return E!=null&&p(e,["videoMetadata"],E),e}function v2(n){const e={},t=h(n,["handle"]);if(t!=null&&p(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function _2(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let y=t;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["functionDeclarations"],y)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const i=h(n,["computerUse"]);i!=null&&p(e,["computerUse"],i);const o=h(n,["fileSearch"]);o!=null&&p(e,["fileSearch"],o);const l=h(n,["codeExecution"]);if(l!=null&&p(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=h(n,["googleMaps"]);u!=null&&p(e,["googleMaps"],f2(u));const d=h(n,["googleSearch"]);d!=null&&p(e,["googleSearch"],p2(d));const f=h(n,["urlContext"]);return f!=null&&p(e,["urlContext"],f),e}function w2(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${t}.${o}`);e.push(...i)}else e.push(t)}return e.join(",")}function E2(n,e){let t=null;const r=n.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else r!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const o=w2(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)o?n.fieldMask=o:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];o&&d.push(o),u.length>0&&d.push(...u),d.length>0?n.fieldMask=d.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class T2 extends gi{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=c2(this.apiClient,e);o=me("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=E2(u,e.config);return i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),i.then(f=>f)}}}function x2(n,e){const t={},r=h(n,["force"]);return e!==void 0&&r!=null&&p(e,["_query","force"],r),t}function I2(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","name"],t);const r=h(n,["config"]);return r!=null&&x2(r,e),e}function S2(n){const e={},t=h(n,["name"]);return t!=null&&p(e,["_url","name"],t),e}function A2(n,e){const t={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const i=h(n,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),t}function C2(n){const e={},t=h(n,["parent"]);t!=null&&p(e,["_url","parent"],t);const r=h(n,["config"]);return r!=null&&A2(r,e),e}function R2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const r=h(n,["nextPageToken"]);r!=null&&p(e,["nextPageToken"],r);const i=h(n,["documents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),p(e,["documents"],o)}return e}class N2 extends gi{constructor(e){super(),this.apiClient=e,this.list=async t=>new xo(hi.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:t.parent,config:r.config}),await this.listInternal(t),t)}async get(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=S2(e);return o=me("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=I2(e);i=me("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=C2(e);return o=me("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=R2(d),y=new lR;return Object.assign(y,f),y})}}}class P2 extends gi{constructor(e,t=new N2(e)){super(),this.apiClient=e,this.documents=t,this.list=async(r={})=>new xo(hi.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=wb(e);return o=me("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xb(e);return o=me("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Tb(e);i=me("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Nb(e);return o=me("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=Pb(d),y=new uR;return Object.assign(y,f),y})}}async uploadToFileSearchStoreInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=kb(e);return o=me("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=bb(d),y=new cR;return Object.assign(y,f),y})}}async importFile(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ab(e);return o=me("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const f=Sb(d),y=new ng;return Object.assign(y,f),y})}}}let QT=function(){const{crypto:n}=globalThis;if(n?.randomUUID)return QT=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^t()&15>>+r/4).toString(16))};const k2=()=>QT();function dm(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const hm=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class er extends Error{}class vn extends er{constructor(e,t,r,i){super(`${vn.makeMessage(e,t,r)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,r){const i=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,r,i){if(!e||!i)return new Mh({message:r,cause:hm(t)});const o=t;return e===400?new XT(e,o,r,i):e===401?new ZT(e,o,r,i):e===403?new ex(e,o,r,i):e===404?new tx(e,o,r,i):e===409?new nx(e,o,r,i):e===422?new rx(e,o,r,i):e===429?new ix(e,o,r,i):e>=500?new sx(e,o,r,i):new vn(e,o,r,i)}}class fm extends vn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Mh extends vn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class YT extends Mh{constructor({message:e}={}){super({message:e??"Request timed out."})}}class XT extends vn{}class ZT extends vn{}class ex extends vn{}class tx extends vn{}class nx extends vn{}class rx extends vn{}class ix extends vn{}class sx extends vn{}const b2=/^[a-z][a-z0-9+.-]*:/i,D2=n=>b2.test(n);let pm=n=>(pm=Array.isArray,pm(n));const M2=pm;let V2=M2;const _w=V2;function L2(n){if(!n)return!0;for(const e in n)return!1;return!0}function F2(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const U2=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new er(`${n} must be an integer`);if(e<0)throw new er(`${n} must be a positive integer`);return e},O2=n=>{try{return JSON.parse(n)}catch{return}};const B2=n=>new Promise(e=>setTimeout(e,n));const wa="0.0.1";function G2(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const q2=()=>{var n,e,t,r,i;const o=G2();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wa,"X-Stainless-OS":Ew(Deno.build.os),"X-Stainless-Arch":ww(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wa,"X-Stainless-OS":Ew((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":ww((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=z2();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function z2(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const i=r[1]||0,o=r[2]||0,l=r[3]||0;return{browser:e,version:`${i}.${o}.${l}`}}}return null}const ww=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Ew=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Nd;const H2=()=>Nd??(Nd=q2());function $2(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function ox(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function K2(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return ox({start(){},async pull(t){const{done:r,value:i}=await e.next();r?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function ax(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function W2(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const r=n.getReader(),i=r.cancel();r.releaseLock(),await i}const j2=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const lx=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Bp(n,e,t){return lx(),new File(n,e??"unknown_file",t)}function J2(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const Q2=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";const ux=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",Y2=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&ux(n),X2=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function Z2(n,e,t){if(lx(),n=await n,Y2(n))return n instanceof File?n:Bp([await n.arrayBuffer()],n.name);if(X2(n)){const i=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Bp(await mm(i),e,t)}const r=await mm(n);if(e||(e=J2(n)),!t?.type){const i=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return Bp(r,e,t)}async function mm(n){var e,t,r,i,o;let l=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)l.push(n);else if(ux(n))l.push(n instanceof Blob?n:await n.arrayBuffer());else if(Q2(n))try{for(var u=!0,d=fr(n),f;f=await d.next(),e=f.done,!e;u=!0){i=f.value,u=!1;const y=i;l.push(...await mm(y))}}catch(y){t={error:y}}finally{try{!u&&!e&&(r=d.return)&&await r.call(d)}finally{if(t)throw t.error}}else{const y=(o=n?.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof n}${y?`; constructor: ${y}`:""}${eD(n)}`)}return l}function eD(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}class cx{constructor(e){this._client=e}}cx._key=[];function dx(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Tw=Object.freeze(Object.create(null)),tD=(n=dx)=>(function(t,...r){if(t.length===1)return t[0];let i=!1;const o=[],l=t.reduce((y,v,E)=>{var S,N,M;/[?#]/.test(v)&&(i=!0);const k=r[E];let B=(i?encodeURIComponent:n)(""+k);return E!==r.length&&(k==null||typeof k=="object"&&k.toString===((M=Object.getPrototypeOf((N=Object.getPrototypeOf((S=k.hasOwnProperty)!==null&&S!==void 0?S:Tw))!==null&&N!==void 0?N:Tw))===null||M===void 0?void 0:M.toString))&&(B=k+"",o.push({start:y.length+v.length,length:B.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),y+v+(E===r.length?"":B)},""),u=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=d.exec(u))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((y,v)=>y.start-v.start),o.length>0){let y=0;const v=o.reduce((E,S)=>{const N=" ".repeat(S.start-y),M="^".repeat(S.length);return y=S.start+S.length,E+N+M},"");throw new er(`Path parameters result in path with invalid segments:
${o.map(E=>E.error).join(`
`)}
${l}
${v}`)}return l}),Pd=tD(dx);class hx extends cx{create(e,t){var r;const{api_version:i=this._client.apiVersion}=e,o=sh(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new er("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new er("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Pd`/${i}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,t={},r){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(Pd`/${i}/interactions/${e}`,r)}cancel(e,t={},r){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(Pd`/${i}/interactions/${e}/cancel`,r)}get(e,t={},r){var i;const o=t??{},{api_version:l=this._client.apiVersion}=o,u=sh(o,["api_version"]);return this._client.get(Pd`/${l}/interactions/${e}`,Object.assign(Object.assign({query:u},r),{stream:(i=t?.stream)!==null&&i!==void 0?i:!1}))}}hx._key=Object.freeze(["interactions"]);class fx extends hx{}function nD(n){let e=0;for(const i of n)e+=i.length;const t=new Uint8Array(e);let r=0;for(const i of n)t.set(i,r),r+=i.length;return t}let kd;function ug(n){let e;return(kd??(e=new globalThis.TextEncoder,kd=e.encode.bind(e)))(n)}let bd;function xw(n){let e;return(bd??(e=new globalThis.TextDecoder,bd=e.decode.bind(e)))(n)}class Vh{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ug(e):e;this.buffer=nD([this.buffer,t]);const r=[];let i;for(;(i=rD(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){r.push(xw(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=xw(this.buffer.subarray(0,o));r.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Vh.NEWLINE_CHARS=new Set([`
`,"\r"]);Vh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function rD(n,e){for(let i=e??0;i<n.length;i++){if(n[i]===10)return{preceding:i,index:i+1,carriage:!1};if(n[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function iD(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}const oh={off:0,error:200,warn:300,info:400,debug:500},Iw=(n,e,t)=>{if(n){if(F2(oh,n))return n;pn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(oh))}`)}};function pu(){}function Dd(n,e,t){return!e||oh[n]>oh[t]?pu:e[n].bind(e)}const sD={error:pu,warn:pu,info:pu,debug:pu};let Sw=new WeakMap;function pn(n){var e;const t=n.logger,r=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return sD;const i=Sw.get(t);if(i&&i[0]===r)return i[1];const o={error:Dd("error",t,r),warn:Dd("warn",t,r),info:Dd("info",t,r),debug:Dd("debug",t,r)};return Sw.set(t,[r,o]),o}const Zs=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);class Ca{constructor(e,t,r){this.iterator=e,this.controller=t,this.client=r}static fromSSEResponse(e,t,r){let i=!1;const o=r?pn(r):console;function l(){return hr(this,arguments,function*(){var d,f,y,v;if(i)throw new er("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let E=!1;try{try{for(var S=!0,N=fr(oD(e,t)),M;M=yield Ve(N.next()),d=M.done,!d;S=!0){v=M.value,S=!1;const k=v;if(!E)if(k.data.startsWith("[DONE]")){E=!0;continue}else try{yield yield Ve(JSON.parse(k.data))}catch(B){throw o.error("Could not parse message into JSON:",k.data),o.error("From chunk:",k.raw),B}}}catch(k){f={error:k}}finally{try{!S&&!d&&(y=N.return)&&(yield Ve(y.call(N)))}finally{if(f)throw f.error}}E=!0}catch(k){if(dm(k))return yield Ve(void 0);throw k}finally{E||t.abort()}})}return new Ca(l,t,r)}static fromReadableStream(e,t,r){let i=!1;function o(){return hr(this,arguments,function*(){var d,f,y,v;const E=new Vh,S=ax(e);try{for(var N=!0,M=fr(S),k;k=yield Ve(M.next()),d=k.done,!d;N=!0){v=k.value,N=!1;const B=v;for(const q of E.decode(B))yield yield Ve(q)}}catch(B){f={error:B}}finally{try{!N&&!d&&(y=M.return)&&(yield Ve(y.call(M)))}finally{if(f)throw f.error}}for(const B of E.flush())yield yield Ve(B)})}function l(){return hr(this,arguments,function*(){var d,f,y,v;if(i)throw new er("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let E=!1;try{try{for(var S=!0,N=fr(o()),M;M=yield Ve(N.next()),d=M.done,!d;S=!0){v=M.value,S=!1;const k=v;E||k&&(yield yield Ve(JSON.parse(k)))}}catch(k){f={error:k}}finally{try{!S&&!d&&(y=N.return)&&(yield Ve(y.call(N)))}finally{if(f)throw f.error}}E=!0}catch(k){if(dm(k))return yield Ve(void 0);throw k}finally{E||t.abort()}})}return new Ca(l,t,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),i=o=>({next:()=>{if(o.length===0){const l=r.next();e.push(l),t.push(l)}return o.shift()}});return[new Ca(()=>i(e),this.controller,this.client),new Ca(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return ox({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:o}=await t.next();if(o)return r.close();const l=ug(JSON.stringify(i)+`
`);r.enqueue(l)}catch(i){r.error(i)}},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}}function oD(n,e){return hr(this,arguments,function*(){var r,i,o,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new er("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new er("Attempted to iterate over a response with no body");const u=new lD,d=new Vh,f=ax(n.body);try{for(var y=!0,v=fr(aD(f)),E;E=yield Ve(v.next()),r=E.done,!r;y=!0){l=E.value,y=!1;const S=l;for(const N of d.decode(S)){const M=u.decode(N);M&&(yield yield Ve(M))}}}catch(S){i={error:S}}finally{try{!y&&!r&&(o=v.return)&&(yield Ve(o.call(v)))}finally{if(i)throw i.error}}for(const S of d.flush()){const N=u.decode(S);N&&(yield yield Ve(N))}})}function aD(n){return hr(this,arguments,function*(){var t,r,i,o;let l=new Uint8Array;try{for(var u=!0,d=fr(n),f;f=yield Ve(d.next()),t=f.done,!t;u=!0){o=f.value,u=!1;const y=o;if(y==null)continue;const v=y instanceof ArrayBuffer?new Uint8Array(y):typeof y=="string"?ug(y):y;let E=new Uint8Array(l.length+v.length);E.set(l),E.set(v,l.length),l=E;let S;for(;(S=iD(l))!==-1;)yield yield Ve(l.slice(0,S)),l=l.slice(S)}}catch(y){r={error:y}}finally{try{!u&&!t&&(i=d.return)&&(yield Ve(i.call(d)))}finally{if(r)throw r.error}}l.length>0&&(yield yield Ve(l))})}class lD{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,i]=uD(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function uD(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function cD(n,e){const{response:t,requestLogID:r,retryOfRequestLogID:i,startTime:o}=e,l=await(async()=>{var u;if(e.options.stream)return pn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Ca.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),f=(u=d?.split(";")[0])===null||u===void 0?void 0:u.trim();return f?.includes("application/json")||f?.endsWith("+json")?await t.json():await t.text()})();return pn(n).debug(`[${r}] response parsed`,Zs({retryOfRequestLogID:i,url:t.url,status:t.status,body:l,durationMs:Date.now()-o})),l}class cg extends Promise{constructor(e,t,r=cD){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new cg(this.client,this.responsePromise,async(t,r)=>e(await this.parseResponse(t,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const px=Symbol("brand.privateNullableHeaders");function*dD(n){if(!n)return;if(px in n){const{values:r,nulls:i}=n;yield*r.entries();for(const o of i)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():_w(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let r of t){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const o=_w(r[1])?r[1]:[r[1]];let l=!1;for(const u of o)u!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,u])}}const lu=n=>{const e=new Headers,t=new Set;for(const r of n){const i=new Set;for(const[o,l]of dD(r)){const u=o.toLowerCase();i.has(u)||(e.delete(o),i.add(u)),l===null?(e.delete(o),t.add(u)):(e.append(o,l),t.delete(u))}}return{[px]:!0,values:e,nulls:t}};const Gp=n=>{var e,t,r,i,o,l;if(typeof globalThis.process<"u")return(r=(t=(e=F1)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||o===void 0?void 0:o.call(i,n))===null||l===void 0?void 0:l.trim()};var mx;class Lh{constructor(e){var t,r,i,o,l,u,d,{baseURL:f=Gp("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:y=(t=Gp("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,E=sh(e,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:y,apiVersion:v},E),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(r=S.timeout)!==null&&r!==void 0?r:Lh.DEFAULT_TIMEOUT,this.logger=(i=S.logger)!==null&&i!==void 0?i:console;const N="warn";this.logLevel=N,this.logLevel=(l=(o=Iw(S.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:Iw(Gp("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:N,this.fetchOptions=S.fetchOptions,this.maxRetries=(u=S.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(d=S.fetch)!==null&&d!==void 0?d:$2(),this.encoder=j2,this._options=S,this.apiKey=y,this.apiVersion=v,this.clientAdapter=S.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=lu([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return lu([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return lu([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new er(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${wa}`}defaultIdempotencyKey(){return`stainless-node-retry-${k2()}`}makeStatusError(e,t,r,i){return vn.generate(e,t,r,i)}buildURL(e,t,r){const i=!this.baseURLOverridden()&&r||this.baseURL,o=D2(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return L2(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new cg(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){var i,o,l;const u=await e,d=(i=u.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=d),await this.prepareOptions(u);const{req:f,url:y,timeout:v}=await this.buildRequest(u,{retryCount:d-t});await this.prepareRequest(f,{url:y,options:u});const E="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=r===void 0?"":`, retryOf: ${r}`,N=Date.now();if(pn(this).debug(`[${E}] sending request`,Zs({retryOfRequestLogID:r,method:u.method,url:y,options:u,headers:f.headers})),!((o=u.signal)===null||o===void 0)&&o.aborted)throw new fm;const M=new AbortController,k=await this.fetchWithTimeout(y,f,v,M).catch(hm),B=Date.now();if(k instanceof globalThis.Error){const H=`retrying, ${t} attempts remaining`;if(!((l=u.signal)===null||l===void 0)&&l.aborted)throw new fm;const ee=dm(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(t)return pn(this).info(`[${E}] connection ${ee?"timed out":"failed"} - ${H}`),pn(this).debug(`[${E}] connection ${ee?"timed out":"failed"} (${H})`,Zs({retryOfRequestLogID:r,url:y,durationMs:B-N,message:k.message})),this.retryRequest(u,t,r??E);throw pn(this).info(`[${E}] connection ${ee?"timed out":"failed"} - error; no more retries left`),pn(this).debug(`[${E}] connection ${ee?"timed out":"failed"} (error; no more retries left)`,Zs({retryOfRequestLogID:r,url:y,durationMs:B-N,message:k.message})),ee?new YT:new Mh({cause:k})}const q=`[${E}${S}] ${f.method} ${y} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${B-N}ms`;if(!k.ok){const H=await this.shouldRetry(k);if(t&&H){const P=`retrying, ${t} attempts remaining`;return await W2(k.body),pn(this).info(`${q} - ${P}`),pn(this).debug(`[${E}] response error (${P})`,Zs({retryOfRequestLogID:r,url:k.url,status:k.status,headers:k.headers,durationMs:B-N})),this.retryRequest(u,t,r??E,k.headers)}const ee=H?"error; no more retries left":"error; not retryable";pn(this).info(`${q} - ${ee}`);const te=await k.text().catch(P=>hm(P).message),j=O2(te),b=j?void 0:te;throw pn(this).debug(`[${E}] response error (${ee})`,Zs({retryOfRequestLogID:r,url:k.url,status:k.status,headers:k.headers,message:b,durationMs:Date.now()-N})),this.makeStatusError(k.status,j,b,k.headers)}return pn(this).info(q),pn(this).debug(`[${E}] response start`,Zs({retryOfRequestLogID:r,url:k.url,status:k.status,headers:k.headers,durationMs:B-N})),{response:k,options:u,controller:M,requestLogID:E,retryOfRequestLogID:r,startTime:N}}async fetchWithTimeout(e,t,r,i){const o=t||{},{signal:l,method:u}=o,d=sh(o,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const f=setTimeout(()=>i.abort(),r),y=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:i.signal},y?{duplex:"half"}:{}),{method:"GET"}),d);u&&(v.method=u.toUpperCase());try{return await this.fetch.call(void 0,e,v)}finally{clearTimeout(f)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r,i){var o;let l;const u=i?.get("retry-after-ms");if(u){const f=parseFloat(u);Number.isNaN(f)||(l=f)}const d=i?.get("retry-after");if(d&&!l){const f=parseFloat(d);Number.isNaN(f)?l=Date.parse(d)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,f)}return await B2(l),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),u=1-Math.random()*.25;return l*u*1e3}async buildRequest(e,{retryCount:t=0}={}){var r,i,o;const l=Object.assign({},e),{method:u,path:d,query:f,defaultBaseURL:y}=l,v=this.buildURL(d,f,y);"timeout"in l&&U2("timeout",l.timeout),l.timeout=(r=l.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:E,body:S}=this.buildBody({options:l}),N=await this.buildHeaders({options:e,method:u,bodyHeaders:E,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:N},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:v,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:i}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let u=lu([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),H2()),this._options.defaultHeaders,r,e.headers,l]);return this.validateHeaders(u),u.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=lu([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:K2(e)}:this.encoder({body:e,headers:r})}}Lh.DEFAULT_TIMEOUT=6e4;class Kt extends Lh{constructor(){super(...arguments),this.interactions=new fx(this)}}mx=Kt;Kt.GeminiNextGenAPIClient=mx;Kt.GeminiNextGenAPIClientError=er;Kt.APIError=vn;Kt.APIConnectionError=Mh;Kt.APIConnectionTimeoutError=YT;Kt.APIUserAbortError=fm;Kt.NotFoundError=tx;Kt.ConflictError=nx;Kt.RateLimitError=ix;Kt.BadRequestError=XT;Kt.AuthenticationError=ZT;Kt.InternalServerError=sx;Kt.PermissionDeniedError=ex;Kt.UnprocessableEntityError=rx;Kt.toFile=Z2;Kt.Interactions=fx;function hD(n,e){const t={},r=h(n,["name"]);return r!=null&&p(t,["_url","name"],r),t}function fD(n,e){const t={},r=h(n,["name"]);return r!=null&&p(t,["_url","name"],r),t}function pD(n,e){const t={},r=h(n,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function mD(n,e){const t={},r=h(n,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function gD(n,e,t){const r={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&p(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=h(n,["epochCount"]);e!==void 0&&o!=null&&p(e,["tuningTask","hyperparameters","epochCount"],o);const l=h(n,["learningRateMultiplier"]);if(l!=null&&p(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=h(n,["batchSize"]);e!==void 0&&u!=null&&p(e,["tuningTask","hyperparameters","batchSize"],u);const d=h(n,["learningRate"]);if(e!==void 0&&d!=null&&p(e,["tuningTask","hyperparameters","learningRate"],d),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(h(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function yD(n,e,t){const r={};let i=h(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const S=h(n,["validationDataset"]);e!==void 0&&S!=null&&p(e,["supervisedTuningSpec"],Aw(S))}else if(i==="PREFERENCE_TUNING"){const S=h(n,["validationDataset"]);e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec"],Aw(S))}const o=h(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&p(e,["tunedModelDisplayName"],o);const l=h(n,["description"]);e!==void 0&&l!=null&&p(e,["description"],l);let u=h(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const S=h(n,["epochCount"]);e!==void 0&&S!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],S)}else if(u==="PREFERENCE_TUNING"){const S=h(n,["epochCount"]);e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],S)}let d=h(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const S=h(n,["learningRateMultiplier"]);e!==void 0&&S!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],S)}else if(d==="PREFERENCE_TUNING"){const S=h(n,["learningRateMultiplier"]);e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],S)}let f=h(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const S=h(n,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],S)}else if(f==="PREFERENCE_TUNING"){const S=h(n,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],S)}let y=h(t,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const S=h(n,["adapterSize"]);e!==void 0&&S!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],S)}else if(y==="PREFERENCE_TUNING"){const S=h(n,["adapterSize"]);e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],S)}if(h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=h(n,["labels"]);e!==void 0&&v!=null&&p(e,["labels"],v);const E=h(n,["beta"]);return e!==void 0&&E!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","beta"],E),r}function vD(n,e){const t={},r=h(n,["baseModel"]);r!=null&&p(t,["baseModel"],r);const i=h(n,["preTunedModel"]);i!=null&&p(t,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&ND(o);const l=h(n,["config"]);return l!=null&&gD(l,t),t}function _D(n,e){const t={},r=h(n,["baseModel"]);r!=null&&p(t,["baseModel"],r);const i=h(n,["preTunedModel"]);i!=null&&p(t,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&PD(o,t,e);const l=h(n,["config"]);return l!=null&&yD(l,t,e),t}function wD(n,e){const t={},r=h(n,["name"]);return r!=null&&p(t,["_url","name"],r),t}function ED(n,e){const t={},r=h(n,["name"]);return r!=null&&p(t,["_url","name"],r),t}function TD(n,e,t){const r={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&p(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&p(e,["_query","filter"],l),r}function xD(n,e,t){const r={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&p(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&p(e,["_query","filter"],l),r}function ID(n,e){const t={},r=h(n,["config"]);return r!=null&&TD(r,t),t}function SD(n,e){const t={},r=h(n,["config"]);return r!=null&&xD(r,t),t}function AD(n,e){const t={},r=h(n,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const i=h(n,["nextPageToken"]);i!=null&&p(t,["nextPageToken"],i);const o=h(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>gx(u))),p(t,["tuningJobs"],l)}return t}function CD(n,e){const t={},r=h(n,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const i=h(n,["nextPageToken"]);i!=null&&p(t,["nextPageToken"],i);const o=h(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>gm(u))),p(t,["tuningJobs"],l)}return t}function RD(n,e){const t={},r=h(n,["name"]);r!=null&&p(t,["model"],r);const i=h(n,["name"]);return i!=null&&p(t,["endpoint"],i),t}function ND(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=h(n,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),p(t,["examples","examples"],i)}return t}function PD(n,e,t){const r={};let i=h(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=h(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function gx(n,e){const t={},r=h(n,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const i=h(n,["name"]);i!=null&&p(t,["name"],i);const o=h(n,["state"]);o!=null&&p(t,["state"],bT(o));const l=h(n,["createTime"]);l!=null&&p(t,["createTime"],l);const u=h(n,["tuningTask","startTime"]);u!=null&&p(t,["startTime"],u);const d=h(n,["tuningTask","completeTime"]);d!=null&&p(t,["endTime"],d);const f=h(n,["updateTime"]);f!=null&&p(t,["updateTime"],f);const y=h(n,["description"]);y!=null&&p(t,["description"],y);const v=h(n,["baseModel"]);v!=null&&p(t,["baseModel"],v);const E=h(n,["_self"]);return E!=null&&p(t,["tunedModel"],RD(E)),t}function gm(n,e){const t={},r=h(n,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const i=h(n,["name"]);i!=null&&p(t,["name"],i);const o=h(n,["state"]);o!=null&&p(t,["state"],bT(o));const l=h(n,["createTime"]);l!=null&&p(t,["createTime"],l);const u=h(n,["startTime"]);u!=null&&p(t,["startTime"],u);const d=h(n,["endTime"]);d!=null&&p(t,["endTime"],d);const f=h(n,["updateTime"]);f!=null&&p(t,["updateTime"],f);const y=h(n,["error"]);y!=null&&p(t,["error"],y);const v=h(n,["description"]);v!=null&&p(t,["description"],v);const E=h(n,["baseModel"]);E!=null&&p(t,["baseModel"],E);const S=h(n,["tunedModel"]);S!=null&&p(t,["tunedModel"],S);const N=h(n,["preTunedModel"]);N!=null&&p(t,["preTunedModel"],N);const M=h(n,["supervisedTuningSpec"]);M!=null&&p(t,["supervisedTuningSpec"],M);const k=h(n,["preferenceOptimizationSpec"]);k!=null&&p(t,["preferenceOptimizationSpec"],k);const B=h(n,["tuningDataStats"]);B!=null&&p(t,["tuningDataStats"],B);const q=h(n,["encryptionSpec"]);q!=null&&p(t,["encryptionSpec"],q);const H=h(n,["partnerModelTuningSpec"]);H!=null&&p(t,["partnerModelTuningSpec"],H);const ee=h(n,["customBaseModel"]);ee!=null&&p(t,["customBaseModel"],ee);const te=h(n,["experiment"]);te!=null&&p(t,["experiment"],te);const j=h(n,["labels"]);j!=null&&p(t,["labels"],j);const b=h(n,["outputUri"]);b!=null&&p(t,["outputUri"],b);const R=h(n,["pipelineJob"]);R!=null&&p(t,["pipelineJob"],R);const P=h(n,["serviceAccount"]);P!=null&&p(t,["serviceAccount"],P);const L=h(n,["tunedModelDisplayName"]);L!=null&&p(t,["tunedModelDisplayName"],L);const F=h(n,["veoTuningSpec"]);return F!=null&&p(t,["veoTuningSpec"],F),t}function kD(n,e){const t={},r=h(n,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const i=h(n,["name"]);i!=null&&p(t,["name"],i);const o=h(n,["metadata"]);o!=null&&p(t,["metadata"],o);const l=h(n,["done"]);l!=null&&p(t,["done"],l);const u=h(n,["error"]);return u!=null&&p(t,["error"],u),t}function Aw(n,e){const t={},r=h(n,["gcsUri"]);r!=null&&p(t,["validationDatasetUri"],r);const i=h(n,["vertexDatasetResource"]);return i!=null&&p(t,["validationDatasetUri"],i),t}class bD extends gi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new xo(hi.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var r;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((r=t.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),o=await this.tuneMldevInternal(i);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:im.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=ED(e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>gm(y))}else{const f=wD(e);return u=me("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>gx(y))}}async listInternal(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=SD(e);return u=me("tuningJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=CD(y),E=new X0;return Object.assign(E,v),E})}else{const f=ID(e);return u=me("tunedModels",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=AD(y),E=new X0;return Object.assign(E,v),E})}}async cancel(e){var t,r,i,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=fD(e);return u=me("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=mD(y),E=new Z0;return Object.assign(E,v),E})}else{const f=hD(e);return u=me("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(v=>{const E=v;return E.sdkHttpResponse={headers:y.headers},E})),l.then(y=>{const v=pD(y),E=new Z0;return Object.assign(E,v),E})}}async tuneInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI()){const u=_D(e,e);return o=me("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>gm(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=vD(e);return o=me("tunedModels",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const y=f;return y.sdkHttpResponse={headers:d.headers},y})),i.then(d=>kD(d))}}}class DD{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const MD=1024*1024*8,VD=3,LD=1e3,FD=2,ah="x-goog-upload-status";async function UD(n,e,t){var r;const i=await yx(n,e,t),o=await i?.json();if(((r=i?.headers)===null||r===void 0?void 0:r[ah])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function OD(n,e,t){var r;const i=await yx(n,e,t),o=await i?.json();if(((r=i?.headers)===null||r===void 0?void 0:r[ah])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=AT(o),u=new rg;return Object.assign(u,l),u}async function yx(n,e,t){var r,i;let o=0,l=0,u=new sm(new Response),d="upload";for(o=n.size;l<o;){const f=Math.min(MD,o-l),y=n.slice(l,l+f);l+f>=o&&(d+=", finalize");let v=0,E=LD;for(;v<VD&&(u=await t.request({path:"",body:y,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((r=u?.headers)===null||r===void 0)&&r[ah]));)v++,await GD(E),E=E*FD;if(l+=f,((i=u?.headers)===null||i===void 0?void 0:i[ah])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function BD(n){return{size:n.size,type:n.type}}function GD(n){return new Promise(e=>setTimeout(e,n))}class qD{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await UD(e,t,r)}async uploadToFileSearchStore(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await OD(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await BD(e)}}class zD{create(e,t,r){return new HD(e,t,r)}}class HD{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const Cw="x-goog-api-key";class $D{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(Cw)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Cw,this.apiKey)}}}const KD="gl-node/";class WD{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Kt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=G1(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new $D(this.apiKey);this.apiClient=new Bb({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:KD+"web",uploader:new qD,downloader:new DD}),this.models=new s2(this.apiClient),this.live=new Zb(this.apiClient,i,new zD),this.batches=new gN(this.apiClient),this.chats=new YN(this.models,this.apiClient),this.caches=new jN(this.apiClient),this.files=new aP(this.apiClient),this.operations=new o2(this.apiClient),this.authTokens=new T2(this.apiClient),this.tunings=new bD(this.apiClient),this.fileSearchStores=new P2(this.apiClient)}}const jD=async(n,e="image/jpeg",t="de")=>{const r=new WD({apiKey:void 0}),i={tr:`Bu bir restoran harcama fii/faturasdr (Grsel veya PDF). Ltfen verileri analiz et ve JSON formatnda dndr. 
         karlacak Veriler: 
         - totalAmount (Sadece say)
         - description (rn: Metro Market Gda)
         - category ('Maa/Avans', 'Tedariki', 'Kira/Fatura', 'Vergi', 'Dier')
         Ltfen sadece JSON dndr.`,de:`Dies ist ein Kassenbeleg/Rechnung eines Restaurants (Bild oder PDF). Bitte analysieren Sie die Daten und geben Sie sie im JSON-Format zurck.
         Daten:
         - totalAmount (Nur Zahl)
         - description (Z.B.: Metro Markt Einkauf)
         - category ('Gehalt/Vorschuss', 'Lieferant', 'Miete/Nebenkosten', 'Steuer', 'Sonstiges')
         Nur JSON zurckgeben.`,en:`This is a restaurant expense receipt/invoice (Image or PDF). Please analyze the data and return it in JSON format.
         Data:
         - totalAmount (Number only)
         - description (E.g.: Metro Market Groceries)
         - category ('Salary/Advance', 'Supplier', 'Rent/Bills', 'Tax', 'Other')
         Return only JSON.`,es:`Este es un recibo/factura de gastos de restaurante (imagen o PDF). Analice los datos y devulvalos en formato JSON.
         Datos:
         - totalAmount (solo nmero)
         - description (Ej: Compras Metro Market)
         - category ('Salario/Adelanto', 'Proveedor', 'Alquiler/Facturas', 'Impuestos', 'Otros')
         Devolver solo JSON.`},o=i[t]||i.de;try{const u=(await r.models.generateContent({model:"gemini-1.5-flash",contents:{parts:[{text:o},{inlineData:{mimeType:e,data:n}}]},config:{responseMimeType:"application/json",responseSchema:{type:Qn.OBJECT,properties:{totalAmount:{type:Qn.NUMBER},description:{type:Qn.STRING},category:{type:Qn.STRING}},required:["totalAmount","description","category"]}}})).text?.trim();return u?JSON.parse(u):null}catch(l){return console.error("AI Receipt Error:",l),null}},JD=()=>{};var Rw={};const vx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},QD=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],l=n[t++],u=n[t++],d=((i&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],l=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|l&63)}}return e.join("")},_x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],l=i+1<n.length,u=l?n[i+1]:0,d=i+2<n.length,f=d?n[i+2]:0,y=o>>2,v=(o&3)<<4|u>>4;let E=(u&15)<<2|f>>6,S=f&63;d||(S=64,l||(E=64)),r.push(t[y],t[v],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):QD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const v=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||f==null||v==null)throw new YD;const E=o<<2|u>>4;if(r.push(E),f!==64){const S=u<<4&240|f>>2;if(r.push(S),v!==64){const N=f<<6&192|v;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class YD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XD=function(n){const e=vx(n);return _x.encodeByteArray(e,!0)},lh=function(n){return XD(n).replace(/\./g,"")},wx=function(n){try{return _x.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function uh(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!ZD(t)||(n[t]=uh(n[t],e[t]));return n}function ZD(n){return n!=="__proto__"}function dg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const eM=()=>dg().__FIREBASE_DEFAULTS__,tM=()=>{if(typeof process>"u"||typeof Rw>"u")return;const n=Rw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},nM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wx(n[1]);return e&&JSON.parse(e)},Ex=()=>{try{return JD()||eM()||tM()||nM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},hg=()=>Ex()?.config;class rM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function fg(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iM(n){return(await fetch(n,{credentials:"include"})).ok}function sM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[lh(JSON.stringify(t)),lh(JSON.stringify(l)),""].join(".")}const Eu={};function oM(){const n={prod:[],emulator:[]};for(const e of Object.keys(Eu))Eu[e]?n.emulator.push(e):n.prod.push(e);return n}function aM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Nw=!1;function lM(n,e){if(typeof window>"u"||typeof document>"u"||!fg(window.location.host)||Eu[n]===e||Eu[n]||Nw)return;Eu[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",o=oM().prod.length>0;function l(){const E=document.getElementById(r);E&&E.remove()}function u(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function d(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function f(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Nw=!0,l()},E}function y(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function v(){const E=aM(r),S=t("text"),N=document.getElementById(S)||document.createElement("span"),M=t("learnmore"),k=document.getElementById(M)||document.createElement("a"),B=t("preprendIcon"),q=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const H=E.element;u(H),y(k,M);const ee=f();d(q,B),H.append(q,N,k,ee),document.body.appendChild(H)}o?(N.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function ch(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Tx(){const n=Ex()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uM(){return typeof window<"u"||xx()}function xx(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ix(){return!Tx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Sx(){return!Tx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Ax(){try{return typeof indexedDB=="object"}catch{return!1}}function cM(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const dM="FirebaseError";class Io extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=dM,Object.setPrototypeOf(this,Io.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fh.prototype.create)}}class Fh{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],l=o?hM(o,r):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Io(i,u,r)}}function hM(n,e){return n.replace(fM,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const fM=/\{\$([^}]+)}/g;function Pw(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Da(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],l=e[i];if(kw(o)&&kw(l)){if(!Da(o,l))return!1}else if(o!==l)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function kw(n){return n!==null&&typeof n=="object"}function pM(n,e){const t=new mM(n,e);return t.subscribe.bind(t)}class mM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");gM(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=qp),i.error===void 0&&(i.error=qp),i.complete===void 0&&(i.complete=qp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function qp(){}function Lt(n){return n&&n._delegate?n._delegate:n}class fo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const eo="[DEFAULT]";class yM{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new rM;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_M(e))try{this.getOrInitializeService({instanceIdentifier:eo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=eo){return this.instances.has(e)}getOptions(e=eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&l.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vM(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=eo){return this.component?this.component.multipleInstances?e:eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vM(n){return n===eo?void 0:n}function _M(n){return n.instantiationMode==="EAGER"}class Cx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yM(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const pg=[];var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const Rx={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},wM=Ke.INFO,EM={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},TM=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=EM[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mg{constructor(e){this.name=e,this._logLevel=wM,this._logHandler=TM,this._userLogHandler=null,pg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rx[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}function xM(n){pg.forEach(e=>{e.setLogLevel(n)})}function IM(n,e){for(const t of pg){let r=null;e&&e.level&&(r=Rx[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,o,...l)=>{const u=l.map(d=>{if(d==null)return null;if(typeof d=="string")return d;if(typeof d=="number"||typeof d=="boolean")return d.toString();if(d instanceof Error)return d.message;try{return JSON.stringify(d)}catch{return null}}).filter(d=>d).join(" ");o>=(r??i.logLevel)&&n({level:Ke[o].toLowerCase(),message:u,args:l,type:i.name})}}}const SM=(n,e)=>e.some(t=>n instanceof t);let bw,Dw;function AM(){return bw||(bw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CM(){return Dw||(Dw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nx=new WeakMap,ym=new WeakMap,Px=new WeakMap,zp=new WeakMap,gg=new WeakMap;function RM(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(ss(n.result)),i()},l=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&Nx.set(t,n)}).catch(()=>{}),gg.set(e,n),e}function NM(n){if(ym.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),i()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});ym.set(n,e)}let vm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ym.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Px.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ss(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function PM(n){vm=n(vm)}function kM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Hp(this),e,...t);return Px.set(r,e.sort?e.sort():[e]),ss(r)}:CM().includes(n)?function(...e){return n.apply(Hp(this),e),ss(Nx.get(this))}:function(...e){return ss(n.apply(Hp(this),e))}}function bM(n){return typeof n=="function"?kM(n):(n instanceof IDBTransaction&&NM(n),SM(n,AM())?new Proxy(n,vm):n)}function ss(n){if(n instanceof IDBRequest)return RM(n);if(zp.has(n))return zp.get(n);const e=bM(n);return e!==n&&(zp.set(n,e),gg.set(e,n)),e}const Hp=n=>gg.get(n);function DM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const l=indexedDB.open(n,e),u=ss(l);return r&&l.addEventListener("upgradeneeded",d=>{r(ss(l.result),d.oldVersion,d.newVersion,ss(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const MM=["get","getKey","getAll","getAllKeys","count"],VM=["put","add","delete","clear"],$p=new Map;function Mw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if($p.get(e))return $p.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=VM.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||MM.includes(t)))return;const o=async function(l,...u){const d=this.transaction(l,i?"readwrite":"readonly");let f=d.store;return r&&(f=f.index(u.shift())),(await Promise.all([f[t](...u),i&&d.done]))[0]};return $p.set(e,o),o}PM(n=>({...n,get:(e,t,r)=>Mw(e,t)||n.get(e,t,r),has:(e,t)=>!!Mw(e,t)||n.has(e,t)}));class LM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(FM(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function FM(n){return n.getComponent()?.type==="VERSION"}const dh="@firebase/app",_m="0.14.6";const fi=new mg("@firebase/app"),UM="@firebase/app-compat",OM="@firebase/analytics-compat",BM="@firebase/analytics",GM="@firebase/app-check-compat",qM="@firebase/app-check",zM="@firebase/auth",HM="@firebase/auth-compat",$M="@firebase/database",KM="@firebase/data-connect",WM="@firebase/database-compat",jM="@firebase/functions",JM="@firebase/functions-compat",QM="@firebase/installations",YM="@firebase/installations-compat",XM="@firebase/messaging",ZM="@firebase/messaging-compat",eV="@firebase/performance",tV="@firebase/performance-compat",nV="@firebase/remote-config",rV="@firebase/remote-config-compat",iV="@firebase/storage",sV="@firebase/storage-compat",oV="@firebase/firestore",aV="@firebase/ai",lV="@firebase/firestore-compat",uV="firebase",cV="12.6.0";const us="[DEFAULT]",dV={[dh]:"fire-core",[UM]:"fire-core-compat",[BM]:"fire-analytics",[OM]:"fire-analytics-compat",[qM]:"fire-app-check",[GM]:"fire-app-check-compat",[zM]:"fire-auth",[HM]:"fire-auth-compat",[$M]:"fire-rtdb",[KM]:"fire-data-connect",[WM]:"fire-rtdb-compat",[jM]:"fire-fn",[JM]:"fire-fn-compat",[QM]:"fire-iid",[YM]:"fire-iid-compat",[XM]:"fire-fcm",[ZM]:"fire-fcm-compat",[eV]:"fire-perf",[tV]:"fire-perf-compat",[nV]:"fire-rc",[rV]:"fire-rc-compat",[iV]:"fire-gcs",[sV]:"fire-gcs-compat",[oV]:"fire-fst",[lV]:"fire-fst-compat",[aV]:"fire-vertex","fire-js":"fire-js",[uV]:"fire-js-all"};const cs=new Map,Ma=new Map,Va=new Map;function Vu(n,e){try{n.container.addComponent(e)}catch(t){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function kx(n,e){n.container.addOrOverwriteComponent(e)}function La(n){const e=n.name;if(Va.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;Va.set(e,n);for(const t of cs.values())Vu(t,n);for(const t of Ma.values())Vu(t,n);return!0}function bx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function hV(n,e,t=us){bx(n,e).clearInstance(t)}function yg(n){return n.options!==void 0}function Dx(n){return yg(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Mx(n){return n==null?!1:n.settings!==void 0}function fV(){Va.clear()}const pV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bn=new Fh("app","Firebase",pV);let Vx=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bn.create("app-deleted",{appName:this._name})}};function Vw(n,e){const t=wx(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,o=new Date().getTime();i-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class mV extends Vx{constructor(e,t,r,i){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,l,i);else{const u=e;super(u.options,l,i)}this._serverConfig={automaticDataCollectionEnabled:o,...t},this._serverConfig.authIdToken&&Vw(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Vw(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,di(dh,_m,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){wg(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Bn.create("server-app-deleted")}}const vg=cV;function _g(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:us,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Bn.create("bad-app-name",{appName:String(i)});if(t||(t=hg()),!t)throw Bn.create("no-options");const o=cs.get(i);if(o){if(Da(t,o.options)&&Da(r,o.config))return o;throw Bn.create("duplicate-app",{appName:i})}const l=new Cx(i);for(const d of Va.values())l.addComponent(d);const u=new Vx(t,r,l);return cs.set(i,u),u}function gV(n,e={}){if(uM()&&!xx())throw Bn.create("invalid-server-app-environment");let t,r=e||{};if(n&&(yg(n)?t=n.options:Dx(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=hg()),!t)throw Bn.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const o=y=>[...y].reduce((v,E)=>Math.imul(31,v)+E.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Bn.create("finalization-registry-not-supported",{});const l=""+o(JSON.stringify(i)),u=Ma.get(l);if(u)return u.incRefCount(r.releaseOnDeref),u;const d=new Cx(l);for(const y of Va.values())d.addComponent(y);const f=new mV(t,r,l,d);return Ma.set(l,f),f}function yV(n=us){const e=cs.get(n);if(!e&&n===us&&hg())return _g();if(!e)throw Bn.create("no-app",{appName:n});return e}function vV(){return Array.from(cs.values())}async function wg(n){let e=!1;const t=n.name;cs.has(t)?(e=!0,cs.delete(t)):Ma.has(t)&&n.decRefCount()<=0&&(Ma.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function di(n,e,t){let r=dV[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${r}" with version "${e}":`];i&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(l.join(" "));return}La(new fo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function Lx(n,e){if(n!==null&&typeof n!="function")throw Bn.create("invalid-log-argument");IM(n,e)}function Fx(n){xM(n)}const _V="firebase-heartbeat-database",wV=1,Lu="firebase-heartbeat-store";let Kp=null;function Ux(){return Kp||(Kp=DM(_V,wV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Bn.create("idb-open",{originalErrorMessage:n.message})})),Kp}async function EV(n){try{const t=(await Ux()).transaction(Lu),r=await t.objectStore(Lu).get(Ox(n));return await t.done,r}catch(e){if(e instanceof Io)fi.warn(e.message);else{const t=Bn.create("idb-get",{originalErrorMessage:e?.message});fi.warn(t.message)}}}async function Lw(n,e){try{const r=(await Ux()).transaction(Lu,"readwrite");await r.objectStore(Lu).put(e,Ox(n)),await r.done}catch(t){if(t instanceof Io)fi.warn(t.message);else{const r=Bn.create("idb-set",{originalErrorMessage:t?.message});fi.warn(r.message)}}}function Ox(n){return`${n.name}!${n.options.appId}`}const TV=1024,xV=30;class IV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new AV(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Fw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>xV){const i=CV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Fw(),{heartbeatsToSend:t,unsentEntries:r}=SV(this._heartbeatsCache.heartbeats),i=lh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return fi.warn(e),""}}}function Fw(){return new Date().toISOString().substring(0,10)}function SV(n,e=TV){const t=[];let r=n.slice();for(const i of n){const o=t.find(l=>l.agent===i.agent);if(o){if(o.dates.push(i.date),Uw(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Uw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class AV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ax()?cM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await EV(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Lw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Lw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Uw(n){return lh(JSON.stringify({version:2,heartbeats:n})).length}function CV(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function RV(n){La(new fo("platform-logger",e=>new LM(e),"PRIVATE")),La(new fo("heartbeat",e=>new IV(e),"PRIVATE")),di(dh,_m,n),di(dh,_m,"esm2020"),di("fire-js","")}RV("");const NV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Io,SDK_VERSION:vg,_DEFAULT_ENTRY_NAME:us,_addComponent:Vu,_addOrOverwriteComponent:kx,_apps:cs,_clearComponents:fV,_components:Va,_getProvider:bx,_isFirebaseApp:yg,_isFirebaseServerApp:Mx,_isFirebaseServerAppSettings:Dx,_registerComponent:La,_removeServiceInstance:hV,_serverApps:Ma,deleteApp:wg,getApp:yV,getApps:vV,initializeApp:_g,initializeServerApp:gV,onLog:Lx,registerVersion:di,setLogLevel:Fx},Symbol.toStringTag,{value:"Module"}));class PV{constructor(e,t){this._delegate=e,this.firebase=t,Vu(e,new fo("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),wg(this._delegate)))}_getService(e,t=us){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=us){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Vu(this._delegate,e)}_addOrOverwriteComponent(e){kx(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const kV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ow=new Fh("app-compat","Firebase",kV);function bV(n){const e={},t={__esModule:!0,initializeApp:o,app:i,registerVersion:di,setLogLevel:Fx,onLog:Lx,apps:null,SDK_VERSION:vg,INTERNAL:{registerComponent:u,removeApp:r,useAsService:d,modularAPIs:NV}};t.default=t,Object.defineProperty(t,"apps",{get:l});function r(f){delete e[f]}function i(f){if(f=f||us,!Pw(e,f))throw Ow.create("no-app",{appName:f});return e[f]}i.App=n;function o(f,y={}){const v=_g(f,y);if(Pw(e,v.name))return e[v.name];const E=new n(v,t);return e[v.name]=E,E}function l(){return Object.keys(e).map(f=>e[f])}function u(f){const y=f.name,v=y.replace("-compat","");if(La(f)&&f.type==="PUBLIC"){const E=(S=i())=>{if(typeof S[v]!="function")throw Ow.create("invalid-app-argument",{appName:y});return S[v]()};f.serviceProps!==void 0&&uh(E,f.serviceProps),t[v]=E,n.prototype[v]=function(...S){return this._getService.bind(this,y).apply(this,f.multipleInstances?S:[])}}return f.type==="PUBLIC"?t[v]:null}function d(f,y){return y==="serverAuth"?null:y}return t}function Bx(){const n=bV(PV);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:Bx,extendNamespace:e,createSubscribe:pM,ErrorFactory:Fh,deepExtend:uh};function e(t){uh(n,t)}return n}const DV=Bx();const Bw=new mg("@firebase/app-compat"),MV="@firebase/app-compat",VV="0.5.6";function LV(n){di(MV,VV,n)}try{const n=dg();if(n.firebase!==void 0){Bw.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Bw.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Tu=DV;LV();var FV="firebase",UV="12.7.0";Tu.registerVersion(FV,UV,"app-compat");var Gw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var os,Gx;(function(){var n;function e(b,R){function P(){}P.prototype=R.prototype,b.F=R.prototype,b.prototype=new P,b.prototype.constructor=b,b.D=function(L,F,G){for(var D=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)D[Fe-2]=arguments[Fe];return R.prototype[F].apply(L,D)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,R,P){P||(P=0);const L=Array(16);if(typeof R=="string")for(var F=0;F<16;++F)L[F]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(F=0;F<16;++F)L[F]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=b.g[0],P=b.g[1],F=b.g[2];let G=b.g[3],D;D=R+(G^P&(F^G))+L[0]+3614090360&4294967295,R=P+(D<<7&4294967295|D>>>25),D=G+(F^R&(P^F))+L[1]+3905402710&4294967295,G=R+(D<<12&4294967295|D>>>20),D=F+(P^G&(R^P))+L[2]+606105819&4294967295,F=G+(D<<17&4294967295|D>>>15),D=P+(R^F&(G^R))+L[3]+3250441966&4294967295,P=F+(D<<22&4294967295|D>>>10),D=R+(G^P&(F^G))+L[4]+4118548399&4294967295,R=P+(D<<7&4294967295|D>>>25),D=G+(F^R&(P^F))+L[5]+1200080426&4294967295,G=R+(D<<12&4294967295|D>>>20),D=F+(P^G&(R^P))+L[6]+2821735955&4294967295,F=G+(D<<17&4294967295|D>>>15),D=P+(R^F&(G^R))+L[7]+4249261313&4294967295,P=F+(D<<22&4294967295|D>>>10),D=R+(G^P&(F^G))+L[8]+1770035416&4294967295,R=P+(D<<7&4294967295|D>>>25),D=G+(F^R&(P^F))+L[9]+2336552879&4294967295,G=R+(D<<12&4294967295|D>>>20),D=F+(P^G&(R^P))+L[10]+4294925233&4294967295,F=G+(D<<17&4294967295|D>>>15),D=P+(R^F&(G^R))+L[11]+2304563134&4294967295,P=F+(D<<22&4294967295|D>>>10),D=R+(G^P&(F^G))+L[12]+1804603682&4294967295,R=P+(D<<7&4294967295|D>>>25),D=G+(F^R&(P^F))+L[13]+4254626195&4294967295,G=R+(D<<12&4294967295|D>>>20),D=F+(P^G&(R^P))+L[14]+2792965006&4294967295,F=G+(D<<17&4294967295|D>>>15),D=P+(R^F&(G^R))+L[15]+1236535329&4294967295,P=F+(D<<22&4294967295|D>>>10),D=R+(F^G&(P^F))+L[1]+4129170786&4294967295,R=P+(D<<5&4294967295|D>>>27),D=G+(P^F&(R^P))+L[6]+3225465664&4294967295,G=R+(D<<9&4294967295|D>>>23),D=F+(R^P&(G^R))+L[11]+643717713&4294967295,F=G+(D<<14&4294967295|D>>>18),D=P+(G^R&(F^G))+L[0]+3921069994&4294967295,P=F+(D<<20&4294967295|D>>>12),D=R+(F^G&(P^F))+L[5]+3593408605&4294967295,R=P+(D<<5&4294967295|D>>>27),D=G+(P^F&(R^P))+L[10]+38016083&4294967295,G=R+(D<<9&4294967295|D>>>23),D=F+(R^P&(G^R))+L[15]+3634488961&4294967295,F=G+(D<<14&4294967295|D>>>18),D=P+(G^R&(F^G))+L[4]+3889429448&4294967295,P=F+(D<<20&4294967295|D>>>12),D=R+(F^G&(P^F))+L[9]+568446438&4294967295,R=P+(D<<5&4294967295|D>>>27),D=G+(P^F&(R^P))+L[14]+3275163606&4294967295,G=R+(D<<9&4294967295|D>>>23),D=F+(R^P&(G^R))+L[3]+4107603335&4294967295,F=G+(D<<14&4294967295|D>>>18),D=P+(G^R&(F^G))+L[8]+1163531501&4294967295,P=F+(D<<20&4294967295|D>>>12),D=R+(F^G&(P^F))+L[13]+2850285829&4294967295,R=P+(D<<5&4294967295|D>>>27),D=G+(P^F&(R^P))+L[2]+4243563512&4294967295,G=R+(D<<9&4294967295|D>>>23),D=F+(R^P&(G^R))+L[7]+1735328473&4294967295,F=G+(D<<14&4294967295|D>>>18),D=P+(G^R&(F^G))+L[12]+2368359562&4294967295,P=F+(D<<20&4294967295|D>>>12),D=R+(P^F^G)+L[5]+4294588738&4294967295,R=P+(D<<4&4294967295|D>>>28),D=G+(R^P^F)+L[8]+2272392833&4294967295,G=R+(D<<11&4294967295|D>>>21),D=F+(G^R^P)+L[11]+1839030562&4294967295,F=G+(D<<16&4294967295|D>>>16),D=P+(F^G^R)+L[14]+4259657740&4294967295,P=F+(D<<23&4294967295|D>>>9),D=R+(P^F^G)+L[1]+2763975236&4294967295,R=P+(D<<4&4294967295|D>>>28),D=G+(R^P^F)+L[4]+1272893353&4294967295,G=R+(D<<11&4294967295|D>>>21),D=F+(G^R^P)+L[7]+4139469664&4294967295,F=G+(D<<16&4294967295|D>>>16),D=P+(F^G^R)+L[10]+3200236656&4294967295,P=F+(D<<23&4294967295|D>>>9),D=R+(P^F^G)+L[13]+681279174&4294967295,R=P+(D<<4&4294967295|D>>>28),D=G+(R^P^F)+L[0]+3936430074&4294967295,G=R+(D<<11&4294967295|D>>>21),D=F+(G^R^P)+L[3]+3572445317&4294967295,F=G+(D<<16&4294967295|D>>>16),D=P+(F^G^R)+L[6]+76029189&4294967295,P=F+(D<<23&4294967295|D>>>9),D=R+(P^F^G)+L[9]+3654602809&4294967295,R=P+(D<<4&4294967295|D>>>28),D=G+(R^P^F)+L[12]+3873151461&4294967295,G=R+(D<<11&4294967295|D>>>21),D=F+(G^R^P)+L[15]+530742520&4294967295,F=G+(D<<16&4294967295|D>>>16),D=P+(F^G^R)+L[2]+3299628645&4294967295,P=F+(D<<23&4294967295|D>>>9),D=R+(F^(P|~G))+L[0]+4096336452&4294967295,R=P+(D<<6&4294967295|D>>>26),D=G+(P^(R|~F))+L[7]+1126891415&4294967295,G=R+(D<<10&4294967295|D>>>22),D=F+(R^(G|~P))+L[14]+2878612391&4294967295,F=G+(D<<15&4294967295|D>>>17),D=P+(G^(F|~R))+L[5]+4237533241&4294967295,P=F+(D<<21&4294967295|D>>>11),D=R+(F^(P|~G))+L[12]+1700485571&4294967295,R=P+(D<<6&4294967295|D>>>26),D=G+(P^(R|~F))+L[3]+2399980690&4294967295,G=R+(D<<10&4294967295|D>>>22),D=F+(R^(G|~P))+L[10]+4293915773&4294967295,F=G+(D<<15&4294967295|D>>>17),D=P+(G^(F|~R))+L[1]+2240044497&4294967295,P=F+(D<<21&4294967295|D>>>11),D=R+(F^(P|~G))+L[8]+1873313359&4294967295,R=P+(D<<6&4294967295|D>>>26),D=G+(P^(R|~F))+L[15]+4264355552&4294967295,G=R+(D<<10&4294967295|D>>>22),D=F+(R^(G|~P))+L[6]+2734768916&4294967295,F=G+(D<<15&4294967295|D>>>17),D=P+(G^(F|~R))+L[13]+1309151649&4294967295,P=F+(D<<21&4294967295|D>>>11),D=R+(F^(P|~G))+L[4]+4149444226&4294967295,R=P+(D<<6&4294967295|D>>>26),D=G+(P^(R|~F))+L[11]+3174756917&4294967295,G=R+(D<<10&4294967295|D>>>22),D=F+(R^(G|~P))+L[2]+718787259&4294967295,F=G+(D<<15&4294967295|D>>>17),D=P+(G^(F|~R))+L[9]+3951481745&4294967295,b.g[0]=b.g[0]+R&4294967295,b.g[1]=b.g[1]+(F+(D<<21&4294967295|D>>>11))&4294967295,b.g[2]=b.g[2]+F&4294967295,b.g[3]=b.g[3]+G&4294967295}r.prototype.v=function(b,R){R===void 0&&(R=b.length);const P=R-this.blockSize,L=this.C;let F=this.h,G=0;for(;G<R;){if(F==0)for(;G<=P;)i(this,b,G),G+=this.blockSize;if(typeof b=="string"){for(;G<R;)if(L[F++]=b.charCodeAt(G++),F==this.blockSize){i(this,L),F=0;break}}else for(;G<R;)if(L[F++]=b[G++],F==this.blockSize){i(this,L),F=0;break}}this.h=F,this.o+=R},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var R=1;R<b.length-8;++R)b[R]=0;R=this.o*8;for(var P=b.length-8;P<b.length;++P)b[P]=R&255,R/=256;for(this.v(b),b=Array(16),R=0,P=0;P<4;++P)for(let L=0;L<32;L+=8)b[R++]=this.g[P]>>>L&255;return b};function o(b,R){var P=u;return Object.prototype.hasOwnProperty.call(P,b)?P[b]:P[b]=R(b)}function l(b,R){this.h=R;const P=[];let L=!0;for(let F=b.length-1;F>=0;F--){const G=b[F]|0;L&&G==R||(P[F]=G,L=!1)}this.g=P}var u={};function d(b){return-128<=b&&b<128?o(b,function(R){return new l([R|0],R<0?-1:0)}):new l([b|0],b<0?-1:0)}function f(b){if(isNaN(b)||!isFinite(b))return v;if(b<0)return k(f(-b));const R=[];let P=1;for(let L=0;b>=P;L++)R[L]=b/P|0,P*=4294967296;return new l(R,0)}function y(b,R){if(b.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(b.charAt(0)=="-")return k(y(b.substring(1),R));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=f(Math.pow(R,8));let L=v;for(let G=0;G<b.length;G+=8){var F=Math.min(8,b.length-G);const D=parseInt(b.substring(G,G+F),R);F<8?(F=f(Math.pow(R,F)),L=L.j(F).add(f(D))):(L=L.j(P),L=L.add(f(D)))}return L}var v=d(0),E=d(1),S=d(16777216);n=l.prototype,n.m=function(){if(M(this))return-k(this).m();let b=0,R=1;for(let P=0;P<this.g.length;P++){const L=this.i(P);b+=(L>=0?L:4294967296+L)*R,R*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(N(this))return"0";if(M(this))return"-"+k(this).toString(b);const R=f(Math.pow(b,6));var P=this;let L="";for(;;){const F=ee(P,R).g;P=B(P,F.j(R));let G=((P.g.length>0?P.g[0]:P.h)>>>0).toString(b);if(P=F,N(P))return G+L;for(;G.length<6;)G="0"+G;L=G+L}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function N(b){if(b.h!=0)return!1;for(let R=0;R<b.g.length;R++)if(b.g[R]!=0)return!1;return!0}function M(b){return b.h==-1}n.l=function(b){return b=B(this,b),M(b)?-1:N(b)?0:1};function k(b){const R=b.g.length,P=[];for(let L=0;L<R;L++)P[L]=~b.g[L];return new l(P,~b.h).add(E)}n.abs=function(){return M(this)?k(this):this},n.add=function(b){const R=Math.max(this.g.length,b.g.length),P=[];let L=0;for(let F=0;F<=R;F++){let G=L+(this.i(F)&65535)+(b.i(F)&65535),D=(G>>>16)+(this.i(F)>>>16)+(b.i(F)>>>16);L=D>>>16,G&=65535,D&=65535,P[F]=D<<16|G}return new l(P,P[P.length-1]&-2147483648?-1:0)};function B(b,R){return b.add(k(R))}n.j=function(b){if(N(this)||N(b))return v;if(M(this))return M(b)?k(this).j(k(b)):k(k(this).j(b));if(M(b))return k(this.j(k(b)));if(this.l(S)<0&&b.l(S)<0)return f(this.m()*b.m());const R=this.g.length+b.g.length,P=[];for(var L=0;L<2*R;L++)P[L]=0;for(L=0;L<this.g.length;L++)for(let F=0;F<b.g.length;F++){const G=this.i(L)>>>16,D=this.i(L)&65535,Fe=b.i(F)>>>16,Z=b.i(F)&65535;P[2*L+2*F]+=D*Z,q(P,2*L+2*F),P[2*L+2*F+1]+=G*Z,q(P,2*L+2*F+1),P[2*L+2*F+1]+=D*Fe,q(P,2*L+2*F+1),P[2*L+2*F+2]+=G*Fe,q(P,2*L+2*F+2)}for(b=0;b<R;b++)P[b]=P[2*b+1]<<16|P[2*b];for(b=R;b<2*R;b++)P[b]=0;return new l(P,0)};function q(b,R){for(;(b[R]&65535)!=b[R];)b[R+1]+=b[R]>>>16,b[R]&=65535,R++}function H(b,R){this.g=b,this.h=R}function ee(b,R){if(N(R))throw Error("division by zero");if(N(b))return new H(v,v);if(M(b))return R=ee(k(b),R),new H(k(R.g),k(R.h));if(M(R))return R=ee(b,k(R)),new H(k(R.g),R.h);if(b.g.length>30){if(M(b)||M(R))throw Error("slowDivide_ only works with positive integers.");for(var P=E,L=R;L.l(b)<=0;)P=te(P),L=te(L);var F=j(P,1),G=j(L,1);for(L=j(L,2),P=j(P,2);!N(L);){var D=G.add(L);D.l(b)<=0&&(F=F.add(P),G=D),L=j(L,1),P=j(P,1)}return R=B(b,F.j(R)),new H(F,R)}for(F=v;b.l(R)>=0;){for(P=Math.max(1,Math.floor(b.m()/R.m())),L=Math.ceil(Math.log(P)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),G=f(P),D=G.j(R);M(D)||D.l(b)>0;)P-=L,G=f(P),D=G.j(R);N(G)&&(G=E),F=F.add(G),b=B(b,D)}return new H(F,b)}n.B=function(b){return ee(this,b).h},n.and=function(b){const R=Math.max(this.g.length,b.g.length),P=[];for(let L=0;L<R;L++)P[L]=this.i(L)&b.i(L);return new l(P,this.h&b.h)},n.or=function(b){const R=Math.max(this.g.length,b.g.length),P=[];for(let L=0;L<R;L++)P[L]=this.i(L)|b.i(L);return new l(P,this.h|b.h)},n.xor=function(b){const R=Math.max(this.g.length,b.g.length),P=[];for(let L=0;L<R;L++)P[L]=this.i(L)^b.i(L);return new l(P,this.h^b.h)};function te(b){const R=b.g.length+1,P=[];for(let L=0;L<R;L++)P[L]=b.i(L)<<1|b.i(L-1)>>>31;return new l(P,b.h)}function j(b,R){const P=R>>5;R%=32;const L=b.g.length-P,F=[];for(let G=0;G<L;G++)F[G]=R>0?b.i(G+P)>>>R|b.i(G+P+1)<<32-R:b.i(G+P);return new l(F,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Gx=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=y,os=l}).apply(typeof Gw<"u"?Gw:typeof self<"u"?self:typeof window<"u"?window:{});var Md=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qx,mu,zx,zd,wm,Hx,$x,Kx;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Md=="object"&&Md];for(var x=0;x<m.length;++x){var I=m[x];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(m,x){if(x)e:{var I=r;m=m.split(".");for(var C=0;C<m.length-1;C++){var W=m[C];if(!(W in I))break e;I=I[W]}m=m[m.length-1],C=I[m],x=x(C),x!=C&&x!=null&&e(I,m,{configurable:!0,writable:!0,value:x})}}i("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(m){return m||function(x){var I=[],C;for(C in x)Object.prototype.hasOwnProperty.call(x,C)&&I.push([C,x[C]]);return I}});var o=o||{},l=this||self;function u(m){var x=typeof m;return x=="object"&&m!=null||x=="function"}function d(m,x,I){return m.call.apply(m.bind,arguments)}function f(m,x,I){return f=d,f.apply(null,arguments)}function y(m,x){var I=Array.prototype.slice.call(arguments,1);return function(){var C=I.slice();return C.push.apply(C,arguments),m.apply(this,C)}}function v(m,x){function I(){}I.prototype=x.prototype,m.Z=x.prototype,m.prototype=new I,m.prototype.constructor=m,m.Ob=function(C,W,X){for(var de=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)de[Le-2]=arguments[Le];return x.prototype[W].apply(C,de)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function S(m){const x=m.length;if(x>0){const I=Array(x);for(let C=0;C<x;C++)I[C]=m[C];return I}return[]}function N(m,x){for(let C=1;C<arguments.length;C++){const W=arguments[C];var I=typeof W;if(I=I!="object"?I:W?Array.isArray(W)?"array":I:"null",I=="array"||I=="object"&&typeof W.length=="number"){I=m.length||0;const X=W.length||0;m.length=I+X;for(let de=0;de<X;de++)m[I+de]=W[de]}else m.push(W)}}class M{constructor(x,I){this.i=x,this.j=I,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function k(m){l.setTimeout(()=>{throw m},0)}function B(){var m=b;let x=null;return m.g&&(x=m.g,m.g=m.g.next,m.g||(m.h=null),x.next=null),x}class q{constructor(){this.h=this.g=null}add(x,I){const C=H.get();C.set(x,I),this.h?this.h.next=C:this.g=C,this.h=C}}var H=new M(()=>new ee,m=>m.reset());class ee{constructor(){this.next=this.g=this.h=null}set(x,I){this.h=x,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let te,j=!1,b=new q,R=()=>{const m=Promise.resolve(void 0);te=()=>{m.then(P)}};function P(){for(var m;m=B();){try{m.h.call(m.g)}catch(I){k(I)}var x=H;x.j(m),x.h<100&&(x.h++,m.next=x.g,x.g=m)}j=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(m,x){this.type=m,this.g=this.target=x,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,x=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const I=()=>{};l.addEventListener("test",I,x),l.removeEventListener("test",I,x)}catch{}return m})();function D(m){return/^[\s\xa0]*$/.test(m)}function Fe(m,x){F.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,x)}v(Fe,F),Fe.prototype.init=function(m,x){const I=this.type=m.type,C=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=x,x=m.relatedTarget,x||(I=="mouseover"?x=m.fromElement:I=="mouseout"&&(x=m.toElement)),this.relatedTarget=x,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&Fe.Z.h.call(this)},Fe.prototype.h=function(){Fe.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Z="closure_listenable_"+(Math.random()*1e6|0),fe=0;function Ie(m,x,I,C,W){this.listener=m,this.proxy=null,this.src=x,this.type=I,this.capture=!!C,this.ha=W,this.key=++fe,this.da=this.fa=!1}function ce(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Ce(m,x,I){for(const C in m)x.call(I,m[C],C,m)}function ge(m,x){for(const I in m)x.call(void 0,m[I],I,m)}function z(m){const x={};for(const I in m)x[I]=m[I];return x}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ke(m,x){let I,C;for(let W=1;W<arguments.length;W++){C=arguments[W];for(I in C)m[I]=C[I];for(let X=0;X<ne.length;X++)I=ne[X],Object.prototype.hasOwnProperty.call(C,I)&&(m[I]=C[I])}}function De(m){this.src=m,this.g={},this.h=0}De.prototype.add=function(m,x,I,C,W){const X=m.toString();m=this.g[X],m||(m=this.g[X]=[],this.h++);const de=Be(m,x,C,W);return de>-1?(x=m[de],I||(x.fa=!1)):(x=new Ie(x,this.src,X,!!C,W),x.fa=I,m.push(x)),x};function Oe(m,x){const I=x.type;if(I in m.g){var C=m.g[I],W=Array.prototype.indexOf.call(C,x,void 0),X;(X=W>=0)&&Array.prototype.splice.call(C,W,1),X&&(ce(x),m.g[I].length==0&&(delete m.g[I],m.h--))}}function Be(m,x,I,C){for(let W=0;W<m.length;++W){const X=m[W];if(!X.da&&X.listener==x&&X.capture==!!I&&X.ha==C)return W}return-1}var We="closure_lm_"+(Math.random()*1e6|0),He={};function tt(m,x,I,C,W){if(Array.isArray(x)){for(let X=0;X<x.length;X++)tt(m,x[X],I,C,W);return null}return I=Ss(I),m&&m[Z]?m.J(x,I,u(C)?!!C.capture:!1,W):ae(m,x,I,!1,C,W)}function ae(m,x,I,C,W,X){if(!x)throw Error("Invalid event type");const de=u(W)?!!W.capture:!!W;let Le=Ti(m);if(Le||(m[We]=Le=new De(m)),I=Le.add(x,I,C,de,X),I.proxy)return I;if(C=je(),I.proxy=C,C.src=m,C.listener=I,m.addEventListener)G||(W=de),W===void 0&&(W=!1),m.addEventListener(x.toString(),C,W);else if(m.attachEvent)m.attachEvent(Nn(x.toString()),C);else if(m.addListener&&m.removeListener)m.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return I}function je(){function m(I){return x.call(m.src,m.listener,I)}const x=Hr;return m}function Pt(m,x,I,C,W){if(Array.isArray(x))for(var X=0;X<x.length;X++)Pt(m,x[X],I,C,W);else C=u(C)?!!C.capture:!!C,I=Ss(I),m&&m[Z]?(m=m.i,X=String(x).toString(),X in m.g&&(x=m.g[X],I=Be(x,I,C,W),I>-1&&(ce(x[I]),Array.prototype.splice.call(x,I,1),x.length==0&&(delete m.g[X],m.h--)))):m&&(m=Ti(m))&&(x=m.g[x.toString()],m=-1,x&&(m=Be(x,I,C,W)),(I=m>-1?x[m]:null)&&Bt(I))}function Bt(m){if(typeof m!="number"&&m&&!m.da){var x=m.src;if(x&&x[Z])Oe(x.i,m);else{var I=m.type,C=m.proxy;x.removeEventListener?x.removeEventListener(I,C,m.capture):x.detachEvent?x.detachEvent(Nn(I),C):x.addListener&&x.removeListener&&x.removeListener(C),(I=Ti(x))?(Oe(I,m),I.h==0&&(I.src=null,x[We]=null)):ce(m)}}}function Nn(m){return m in He?He[m]:He[m]="on"+m}function Hr(m,x){if(m.da)m=!0;else{x=new Fe(x,this);const I=m.listener,C=m.ha||m.src;m.fa&&Bt(m),m=I.call(C,x)}return m}function Ti(m){return m=m[We],m instanceof De?m:null}var $r="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ss(m){return typeof m=="function"?m:(m[$r]||(m[$r]=function(x){return m.handleEvent(x)}),m[$r])}function kt(){L.call(this),this.i=new De(this),this.M=this,this.G=null}v(kt,L),kt.prototype[Z]=!0,kt.prototype.removeEventListener=function(m,x,I,C){Pt(this,m,x,I,C)};function xt(m,x){var I,C=m.G;if(C)for(I=[];C;C=C.G)I.push(C);if(m=m.M,C=x.type||x,typeof x=="string")x=new F(x,m);else if(x instanceof F)x.target=x.target||m;else{var W=x;x=new F(C,m),ke(x,W)}W=!0;let X,de;if(I)for(de=I.length-1;de>=0;de--)X=x.g=I[de],W=tr(X,C,!0,x)&&W;if(X=x.g=m,W=tr(X,C,!0,x)&&W,W=tr(X,C,!1,x)&&W,I)for(de=0;de<I.length;de++)X=x.g=I[de],W=tr(X,C,!1,x)&&W}kt.prototype.N=function(){if(kt.Z.N.call(this),this.i){var m=this.i;for(const x in m.g){const I=m.g[x];for(let C=0;C<I.length;C++)ce(I[C]);delete m.g[x],m.h--}}this.G=null},kt.prototype.J=function(m,x,I,C){return this.i.add(String(m),x,!1,I,C)},kt.prototype.K=function(m,x,I,C){return this.i.add(String(m),x,!0,I,C)};function tr(m,x,I,C){if(x=m.i.g[String(x)],!x)return!0;x=x.concat();let W=!0;for(let X=0;X<x.length;++X){const de=x[X];if(de&&!de.da&&de.capture==I){const Le=de.listener,It=de.ha||de.src;de.fa&&Oe(m.i,de),W=Le.call(It,C)!==!1&&W}}return W&&!C.defaultPrevented}function pl(m,x){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=f(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:l.setTimeout(m,x||0)}function ml(m){m.g=pl(()=>{m.g=null,m.i&&(m.i=!1,ml(m))},m.l);const x=m.h;m.h=null,m.m.apply(null,x)}class pc extends L{constructor(x,I){super(),this.m=x,this.l=I,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:ml(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xi(m){L.call(this),this.h=m,this.g={}}v(xi,L);var gl=[];function No(m){Ce(m.g,function(x,I){this.g.hasOwnProperty(I)&&Bt(x)},m),m.g={}}xi.prototype.N=function(){xi.Z.N.call(this),No(this)},xi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ii=l.JSON.stringify,mc=l.JSON.parse,As=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function Si(){}function gc(){}var Ai={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Po(){F.call(this,"d")}v(Po,F);function yl(){F.call(this,"c")}v(yl,F);var nr={},ko=null;function Ci(){return ko=ko||new kt}nr.Ia="serverreachability";function bo(m){F.call(this,nr.Ia,m)}v(bo,F);function Kr(m){const x=Ci();xt(x,new bo(x))}nr.STAT_EVENT="statevent";function Wr(m,x){F.call(this,nr.STAT_EVENT,m),this.stat=x}v(Wr,F);function wt(m){const x=Ci();xt(x,new Wr(x,m))}nr.Ja="timingevent";function vl(m,x){F.call(this,nr.Ja,m),this.size=x}v(vl,F);function Ri(m,x){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},x)}function Ni(){this.g=!0}Ni.prototype.ua=function(){this.g=!1};function yc(m,x,I,C,W,X){m.info(function(){if(m.g)if(X){var de="",Le=X.split("&");for(let rt=0;rt<Le.length;rt++){var It=Le[rt].split("=");if(It.length>1){const bt=It[0];It=It[1];const Vn=bt.split("_");de=Vn.length>=2&&Vn[1]=="type"?de+(bt+"="+It+"&"):de+(bt+"=redacted&")}}}else de=null;else de=X;return"XMLHTTP REQ ("+C+") [attempt "+W+"]: "+x+`
`+I+`
`+de})}function vc(m,x,I,C,W,X,de){m.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+W+"]: "+x+`
`+I+`
`+X+" "+de})}function yr(m,x,I,C){m.info(function(){return"XMLHTTP TEXT ("+x+"): "+Cs(m,I)+(C?" "+C:"")})}function _c(m,x){m.info(function(){return"TIMEOUT: "+x})}Ni.prototype.info=function(){};function Cs(m,x){if(!m.g)return x;if(!x)return null;try{const X=JSON.parse(x);if(X){for(m=0;m<X.length;m++)if(Array.isArray(X[m])){var I=X[m];if(!(I.length<2)){var C=I[1];if(Array.isArray(C)&&!(C.length<1)){var W=C[0];if(W!="noop"&&W!="stop"&&W!="close")for(let de=1;de<C.length;de++)C[de]=""}}}}return Ii(X)}catch{return x}}var Pi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ki={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},wc;function jr(){}v(jr,Si),jr.prototype.g=function(){return new XMLHttpRequest},wc=new jr;function vr(m){return encodeURIComponent(String(m))}function Do(m){var x=1;m=m.split(":");const I=[];for(;x>0&&m.length;)I.push(m.shift()),x--;return m.length&&I.push(m.join(":")),I}function qn(m,x,I,C){this.j=m,this.i=x,this.l=I,this.S=C||1,this.V=new xi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ec}function Ec(){this.i=null,this.g="",this.h=!1}var Tc={},_l={};function rr(m,x,I){m.M=1,m.A=Qr(zn(x)),m.u=I,m.R=!0,wl(m,null)}function wl(m,x){m.F=Date.now(),Rs(m),m.B=zn(m.A);var I=m.B,C=m.S;Array.isArray(C)||(C=[String(C)]),Pl(I.i,"t",C),m.C=0,I=m.j.L,m.h=new Ec,m.g=bc(m.j,I?x:null,!m.u),m.P>0&&(m.O=new pc(f(m.Y,m,m.g),m.P)),x=m.V,I=m.g,C=m.ba;var W="readystatechange";Array.isArray(W)||(W&&(gl[0]=W.toString()),W=gl);for(let X=0;X<W.length;X++){const de=tt(I,W[X],C||x.handleEvent,!1,x.h||x);if(!de)break;x.g[de.key]=de}x=m.J?z(m.J):{},m.u?(m.v||(m.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,x)):(m.v="GET",m.g.ea(m.B,m.v,null,x)),Kr(),yc(m.i,m.v,m.B,m.l,m.S,m.u)}qn.prototype.ba=function(m){m=m.target;const x=this.O;x&&Sr(m)==3?x.j():this.Y(m)},qn.prototype.Y=function(m){try{if(m==this.g)e:{const Le=Sr(this.g),It=this.g.ya(),rt=this.g.ca();if(!(Le<3)&&(Le!=3||this.g&&(this.h.h||this.g.la()||Pc(this.g)))){this.K||Le!=4||It==7||(It==8||rt<=0?Kr(3):Kr(2)),Mo(this);var x=this.g.ca();this.X=x;var I=xc(this);if(this.o=x==200,vc(this.i,this.v,this.B,this.l,this.S,Le,x),this.o){if(this.U&&!this.L){t:{if(this.g){var C,W=this.g;if((C=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(C)){var X=C;break t}}X=null}if(m=X)yr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ct(this,m);else{this.o=!1,this.m=3,wt(12),Jr(this),Ns(this);break e}}if(this.R){m=!0;let bt;for(;!this.K&&this.C<I.length;)if(bt=Sc(this,I),bt==_l){Le==4&&(this.m=4,wt(14),m=!1),yr(this.i,this.l,null,"[Incomplete Response]");break}else if(bt==Tc){this.m=4,wt(15),yr(this.i,this.l,I,"[Invalid Chunk]"),m=!1;break}else yr(this.i,this.l,bt,null),ct(this,bt);if(Ic(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||I.length!=0||this.h.h||(this.m=1,wt(16),m=!1),this.o=this.o&&m,!m)yr(this.i,this.l,I,"[Invalid Chunked Response]"),Jr(this),Ns(this);else if(I.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Us(de),de.P=!0,wt(11))}}else yr(this.i,this.l,I,null),ct(this,I);Le==4&&Jr(this),this.o&&!this.K&&(Le==4?Ho(this.j,this):(this.o=!1,Rs(this)))}else bl(this.g),x==400&&I.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),Jr(this),Ns(this)}}}catch{}};function xc(m){if(!Ic(m))return m.g.la();const x=Pc(m.g);if(x==="")return"";let I="";const C=x.length,W=Sr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Jr(m),Ns(m),"";m.h.i=new l.TextDecoder}for(let X=0;X<C;X++)m.h.h=!0,I+=m.h.i.decode(x[X],{stream:!(W&&X==C-1)});return x.length=0,m.h.g+=I,m.C=0,m.h.g}function Ic(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function Sc(m,x){var I=m.C,C=x.indexOf(`
`,I);return C==-1?_l:(I=Number(x.substring(I,C)),isNaN(I)?Tc:(C+=1,C+I>x.length?_l:(x=x.slice(C,C+I),m.C=C+I,x)))}qn.prototype.cancel=function(){this.K=!0,Jr(this)};function Rs(m){m.T=Date.now()+m.H,El(m,m.H)}function El(m,x){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Ri(f(m.aa,m),x)}function Mo(m){m.D&&(l.clearTimeout(m.D),m.D=null)}qn.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(_c(this.i,this.B),this.M!=2&&(Kr(),wt(17)),Jr(this),this.m=2,Ns(this)):El(this,this.T-m)};function Ns(m){m.j.I==0||m.K||Ho(m.j,m)}function Jr(m){Mo(m);var x=m.O;x&&typeof x.dispose=="function"&&x.dispose(),m.O=null,No(m.V),m.g&&(x=m.g,m.g=null,x.abort(),x.dispose())}function ct(m,x){try{var I=m.j;if(I.I!=0&&(I.g==m||xl(I.h,m))){if(!m.L&&xl(I.h,m)&&I.I==3){try{var C=I.Ba.g.parse(x)}catch{C=null}if(Array.isArray(C)&&C.length==3){var W=C;if(W[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<m.F)zo(I),Dn(I);else break e;Rr(I),wt(18)}}else I.xa=W[1],0<I.xa-I.K&&W[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Ri(f(I.Va,I),6e3));Ps(I.h)<=1&&I.ta&&(I.ta=void 0)}else Mn(I,11)}else if((m.L||I.g==m)&&zo(I),!D(x))for(W=I.Ba.g.parse(x),x=0;x<W.length;x++){let rt=W[x];const bt=rt[0];if(!(bt<=I.K))if(I.K=bt,rt=rt[1],I.I==2)if(rt[0]=="c"){I.M=rt[1],I.ba=rt[2];const Vn=rt[3];Vn!=null&&(I.ka=Vn,I.j.info("VER="+I.ka));const ti=rt[4];ti!=null&&(I.za=ti,I.j.info("SVER="+I.za));const Nr=rt[5];Nr!=null&&typeof Nr=="number"&&Nr>0&&(C=1.5*Nr,I.O=C,I.j.info("backChannelRequestTimeoutMs_="+C)),C=I;const Pr=m.g;if(Pr){const Wo=Pr.g?Pr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wo){var X=C.h;X.g||Wo.indexOf("spdy")==-1&&Wo.indexOf("quic")==-1&&Wo.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Lo(X,X.h),X.h=null))}if(C.G){const Vl=Pr.g?Pr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vl&&(C.wa=Vl,et(C.J,C.G,Vl))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-m.F,I.j.info("Handshake RTT: "+I.T+"ms")),C=I;var de=m;if(C.na=Ml(C,C.L?C.ba:null,C.W),de.L){ks(C.h,de);var Le=de,It=C.O;It&&(Le.H=It),Le.D&&(Mo(Le),Rs(Le)),C.g=de}else en(C);I.i.length>0&&ei(I)}else rt[0]!="stop"&&rt[0]!="close"||Mn(I,7);else I.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Mn(I,7):Go(I):rt[0]!="noop"&&I.l&&I.l.qa(rt),I.A=0)}}Kr(4)}catch{}}var hf=class{constructor(m,x){this.g=m,this.map=x}};function Vo(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tl(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Ps(m){return m.h?1:m.g?m.g.size:0}function xl(m,x){return m.h?m.h==x:m.g?m.g.has(x):!1}function Lo(m,x){m.g?m.g.add(x):m.h=x}function ks(m,x){m.h&&m.h==x?m.h=null:m.g&&m.g.has(x)&&m.g.delete(x)}Vo.prototype.cancel=function(){if(this.i=Pn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Pn(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let x=m.i;for(const I of m.g.values())x=x.concat(I.G);return x}return S(m.i)}var Ac=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function kn(m,x){if(m){m=m.split("&");for(let I=0;I<m.length;I++){const C=m[I].indexOf("=");let W,X=null;C>=0?(W=m[I].substring(0,C),X=m[I].substring(C+1)):W=m[I],x(W,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function _r(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;m instanceof _r?(this.l=m.l,bs(this,m.j),this.o=m.o,this.g=m.g,wr(this,m.u),this.h=m.h,bi(this,kl(m.i)),this.m=m.m):m&&(x=String(m).match(Ac))?(this.l=!1,bs(this,x[1]||"",!0),this.o=Ds(x[2]||""),this.g=Ds(x[3]||"",!0),wr(this,x[4]),this.h=Ds(x[5]||"",!0),bi(this,x[6]||"",!0),this.m=Ds(x[7]||"")):(this.l=!1,this.i=new $e(null,this.l))}_r.prototype.toString=function(){const m=[];var x=this.j;x&&m.push(Ms(x,Sl,!0),":");var I=this.g;return(I||x=="file")&&(m.push("//"),(x=this.o)&&m.push(Ms(x,Sl,!0),"@"),m.push(vr(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&m.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&m.push("/"),m.push(Ms(I,I.charAt(0)=="/"?Vs:Al,!0))),(I=this.i.toString())&&m.push("?",I),(I=this.m)&&m.push("#",Ms(I,Cl)),m.join("")},_r.prototype.resolve=function(m){const x=zn(this);let I=!!m.j;I?bs(x,m.j):I=!!m.o,I?x.o=m.o:I=!!m.g,I?x.g=m.g:I=m.u!=null;var C=m.h;if(I)wr(x,m.u);else if(I=!!m.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var W=x.h.lastIndexOf("/");W!=-1&&(C=x.h.slice(0,W+1)+C)}if(W=C,W==".."||W==".")C="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){C=W.lastIndexOf("/",0)==0,W=W.split("/");const X=[];for(let de=0;de<W.length;){const Le=W[de++];Le=="."?C&&de==W.length&&X.push(""):Le==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),C&&de==W.length&&X.push("")):(X.push(Le),C=!0)}C=X.join("/")}else C=W}return I?x.h=C:I=m.i.toString()!=="",I?bi(x,kl(m.i)):I=!!m.m,I&&(x.m=m.m),x};function zn(m){return new _r(m)}function bs(m,x,I){m.j=I?Ds(x,!0):x,m.j&&(m.j=m.j.replace(/:$/,""))}function wr(m,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);m.u=x}else m.u=null}function bi(m,x,I){x instanceof $e?(m.i=x,Uo(m.i,m.l)):(I||(x=Ms(x,ff)),m.i=new $e(x,m.l))}function et(m,x,I){m.i.set(x,I)}function Qr(m){return et(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Ds(m,x){return m?x?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ms(m,x,I){return typeof m=="string"?(m=encodeURI(m).replace(x,Il),I&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Il(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Sl=/[#\/\?@]/g,Al=/[#\?:]/g,Vs=/[#\?]/g,ff=/[#\?@]/g,Cl=/#/g;function $e(m,x){this.h=this.g=null,this.i=m||null,this.j=!!x}function Er(m){m.g||(m.g=new Map,m.h=0,m.i&&kn(m.i,function(x,I){m.add(decodeURIComponent(x.replace(/\+/g," ")),I)}))}n=$e.prototype,n.add=function(m,x){Er(this),this.i=null,m=Tr(this,m);let I=this.g.get(m);return I||this.g.set(m,I=[]),I.push(x),this.h+=1,this};function Rl(m,x){Er(m),x=Tr(m,x),m.g.has(x)&&(m.i=null,m.h-=m.g.get(x).length,m.g.delete(x))}function Fo(m,x){return Er(m),x=Tr(m,x),m.g.has(x)}n.forEach=function(m,x){Er(this),this.g.forEach(function(I,C){I.forEach(function(W){m.call(x,W,C,this)},this)},this)};function Nl(m,x){Er(m);let I=[];if(typeof x=="string")Fo(m,x)&&(I=I.concat(m.g.get(Tr(m,x))));else for(m=Array.from(m.g.values()),x=0;x<m.length;x++)I=I.concat(m[x]);return I}n.set=function(m,x){return Er(this),this.i=null,m=Tr(this,m),Fo(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[x]),this.h+=1,this},n.get=function(m,x){return m?(m=Nl(this,m),m.length>0?String(m[0]):x):x};function Pl(m,x,I){Rl(m,x),I.length>0&&(m.i=null,m.g.set(Tr(m,x),S(I)),m.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],x=Array.from(this.g.keys());for(let C=0;C<x.length;C++){var I=x[C];const W=vr(I);I=Nl(this,I);for(let X=0;X<I.length;X++){let de=W;I[X]!==""&&(de+="="+vr(I[X])),m.push(de)}}return this.i=m.join("&")};function kl(m){const x=new $e;return x.i=m.i,m.g&&(x.g=new Map(m.g),x.h=m.h),x}function Tr(m,x){return x=String(x),m.j&&(x=x.toLowerCase()),x}function Uo(m,x){x&&!m.j&&(Er(m),m.i=null,m.g.forEach(function(I,C){const W=C.toLowerCase();C!=W&&(Rl(this,C),Pl(this,W,I))},m)),m.j=x}function xr(m,x){const I=new Ni;if(l.Image){const C=new Image;C.onload=y(Wt,I,"TestLoadImage: loaded",!0,x,C),C.onerror=y(Wt,I,"TestLoadImage: error",!1,x,C),C.onabort=y(Wt,I,"TestLoadImage: abort",!1,x,C),C.ontimeout=y(Wt,I,"TestLoadImage: timeout",!1,x,C),l.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=m}else x(!1)}function Ir(m,x){const I=new Ni,C=new AbortController,W=setTimeout(()=>{C.abort(),Wt(I,"TestPingServer: timeout",!1,x)},1e4);fetch(m,{signal:C.signal}).then(X=>{clearTimeout(W),X.ok?Wt(I,"TestPingServer: ok",!0,x):Wt(I,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(W),Wt(I,"TestPingServer: error",!1,x)})}function Wt(m,x,I,C,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),C(I)}catch{}}function Ls(){this.g=new As}function Yr(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Yr,Si),Yr.prototype.g=function(){return new bn(this.i,this.h)};function bn(m,x){kt.call(this),this.H=m,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(bn,kt),n=bn.prototype,n.open=function(m,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=x,this.readyState=1,ir(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(x.body=m),(this.H||l).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Di(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ir(this)),this.g&&(this.readyState=3,ir(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cc(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cc(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var x=m.value?m.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!m.done}))&&(this.response=this.responseText+=x)}m.done?Di(this):ir(this),this.readyState==3&&Cc(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,Di(this))},n.Na=function(m){this.g&&(this.response=m,Di(this))},n.ga=function(){this.g&&Di(this)};function Di(m){m.readyState=4,m.l=null,m.j=null,m.B=null,ir(m)}n.setRequestHeader=function(m,x){this.A.append(m,x)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],x=this.h.entries();for(var I=x.next();!I.done;)I=I.value,m.push(I[0]+": "+I[1]),I=x.next();return m.join(`\r
`)};function ir(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(bn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Rc(m){let x="";return Ce(m,function(I,C){x+=C,x+=":",x+=I,x+=`\r
`}),x}function Oo(m,x,I){e:{for(C in I){var C=!1;break e}C=!0}C||(I=Rc(I),typeof m=="string"?I!=null&&vr(I):et(m,x,I))}function ot(m){kt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ot,kt);var Nc=/^https?$/i,pf=["POST","PUT"];n=ot.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,x,I,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);x=x?x.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():wc.g(),this.g.onreadystatechange=E(f(this.Ca,this));try{this.B=!0,this.g.open(x,String(m),!0),this.B=!1}catch(X){Mi(this,X);return}if(m=I||"",I=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var W in C)I.set(W,C[W]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const X of C.keys())I.set(X,C.get(X));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(I.keys()).find(X=>X.toLowerCase()=="content-type"),W=l.FormData&&m instanceof l.FormData,!(Array.prototype.indexOf.call(pf,x,void 0)>=0)||C||W||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,de]of I)this.g.setRequestHeader(X,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(X){Mi(this,X)}};function Mi(m,x){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=x,m.o=5,Vi(m),Zr(m)}function Vi(m){m.A||(m.A=!0,xt(m,"complete"),xt(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,xt(this,"complete"),xt(this,"abort"),Zr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zr(this,!0)),ot.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Xr(this):this.Xa())},n.Xa=function(){Xr(this)};function Xr(m){if(m.h&&typeof o<"u"){if(m.v&&Sr(m)==4)setTimeout(m.Ca.bind(m),0);else if(xt(m,"readystatechange"),Sr(m)==4){m.h=!1;try{const X=m.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var I;if(!(I=x)){var C;if(C=X===0){let de=String(m.D).match(Ac)[1]||null;!de&&l.self&&l.self.location&&(de=l.self.location.protocol.slice(0,-1)),C=!Nc.test(de?de.toLowerCase():"")}I=C}if(I)xt(m,"complete"),xt(m,"success");else{m.o=6;try{var W=Sr(m)>2?m.g.statusText:""}catch{W=""}m.l=W+" ["+m.ca()+"]",Vi(m)}}finally{Zr(m)}}}}function Zr(m,x){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const I=m.g;m.g=null,x||xt(m,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Sr(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Sr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var x=this.g.responseText;return m&&x.indexOf(m)==0&&(x=x.substring(m.length)),mc(x)}};function Pc(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function bl(m){const x={};m=(m.g&&Sr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<m.length;C++){if(D(m[C]))continue;var I=Do(m[C]);const W=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const X=x[W]||[];x[W]=X,X.push(I)}ge(x,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ar(m,x,I){return I&&I.internalChannelParams&&I.internalChannelParams[m]||x}function Bo(m){this.za=0,this.i=[],this.j=new Ni,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ar("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ar("baseRetryDelayMs",5e3,m),this.Za=Ar("retryDelaySeedMs",1e4,m),this.Ta=Ar("forwardChannelMaxRetries",2,m),this.va=Ar("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Vo(m&&m.concurrentRequestLimit),this.Ba=new Ls,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Bo.prototype,n.ka=8,n.I=1,n.connect=function(m,x,I,C){wt(0),this.W=m,this.H=x||{},I&&C!==void 0&&(this.H.OSID=I,this.H.OAID=C),this.F=this.X,this.J=Ml(this,null,this.W),ei(this)};function Go(m){if(qo(m),m.I==3){var x=m.V++,I=zn(m.J);if(et(I,"SID",m.M),et(I,"RID",x),et(I,"TYPE","terminate"),Cr(m,I),x=new qn(m,m.j,x),x.M=2,x.A=Qr(zn(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(x.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=x.A,I=!0),I||(x.g=bc(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Rs(x)}Os(m)}function Dn(m){m.g&&(Us(m),m.g.cancel(),m.g=null)}function qo(m){Dn(m),m.v&&(l.clearTimeout(m.v),m.v=null),zo(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&l.clearTimeout(m.m),m.m=null)}function ei(m){if(!Tl(m.h)&&!m.m){m.m=!0;var x=m.Ea;te||R(),j||(te(),j=!0),b.add(x,m),m.D=0}}function kc(m,x){return Ps(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=x.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Ri(f(m.Ea,m,x),$o(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const W=new qn(this,this.j,m);let X=this.o;if(this.U&&(X?(X=z(X),ke(X,this.U)):X=this.U),this.u!==null||this.R||(W.J=X,X=null),this.S)e:{for(var x=0,I=0;I<this.i.length;I++){t:{var C=this.i[I];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(x+=C,x>4096){x=I;break e}if(x===4096||I===this.i.length-1){x=I+1;break e}}x=1e3}else x=1e3;x=Dl(this,W,x),I=zn(this.J),et(I,"RID",m),et(I,"CVER",22),this.G&&et(I,"X-HTTP-Session-Id",this.G),Cr(this,I),X&&(this.R?x="headers="+vr(Rc(X))+"&"+x:this.u&&Oo(I,this.u,X)),Lo(this.h,W),this.Ra&&et(I,"TYPE","init"),this.S?(et(I,"$req",x),et(I,"SID","null"),W.U=!0,rr(W,I,null)):rr(W,I,x),this.I=2}}else this.I==3&&(m?Fs(this,m):this.i.length==0||Tl(this.h)||Fs(this))};function Fs(m,x){var I;x?I=x.l:I=m.V++;const C=zn(m.J);et(C,"SID",m.M),et(C,"RID",I),et(C,"AID",m.K),Cr(m,C),m.u&&m.o&&Oo(C,m.u,m.o),I=new qn(m,m.j,I,m.D+1),m.u===null&&(I.J=m.o),x&&(m.i=x.G.concat(m.i)),x=Dl(m,I,1e3),I.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Lo(m.h,I),rr(I,C,x)}function Cr(m,x){m.H&&Ce(m.H,function(I,C){et(x,C,I)}),m.l&&Ce({},function(I,C){et(x,C,I)})}function Dl(m,x,I){I=Math.min(m.i.length,I);const C=m.l?f(m.l.Ka,m.l,m):null;e:{var W=m.i;let Le=-1;for(;;){const It=["count="+I];Le==-1?I>0?(Le=W[0].g,It.push("ofs="+Le)):Le=0:It.push("ofs="+Le);let rt=!0;for(let bt=0;bt<I;bt++){var X=W[bt].g;const Vn=W[bt].map;if(X-=Le,X<0)Le=Math.max(0,W[bt].g-100),rt=!1;else try{X="req"+X+"_"||"";try{var de=Vn instanceof Map?Vn:Object.entries(Vn);for(const[ti,Nr]of de){let Pr=Nr;u(Nr)&&(Pr=Ii(Nr)),It.push(X+ti+"="+encodeURIComponent(Pr))}}catch(ti){throw It.push(X+"type="+encodeURIComponent("_badmap")),ti}}catch{C&&C(Vn)}}if(rt){de=It.join("&");break e}}de=void 0}return m=m.i.splice(0,I),x.G=m,de}function en(m){if(!m.g&&!m.v){m.Y=1;var x=m.Da;te||R(),j||(te(),j=!0),b.add(x,m),m.A=0}}function Rr(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Ri(f(m.Da,m),$o(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,Li(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Ri(f(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),Dn(this),Li(this))};function Us(m){m.B!=null&&(l.clearTimeout(m.B),m.B=null)}function Li(m){m.g=new qn(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var x=zn(m.na);et(x,"RID","rpc"),et(x,"SID",m.M),et(x,"AID",m.K),et(x,"CI",m.F?"0":"1"),!m.F&&m.ia&&et(x,"TO",m.ia),et(x,"TYPE","xmlhttp"),Cr(m,x),m.u&&m.o&&Oo(x,m.u,m.o),m.O&&(m.g.H=m.O);var I=m.g;m=m.ba,I.M=1,I.A=Qr(zn(x)),I.u=null,I.R=!0,wl(I,m)}n.Va=function(){this.C!=null&&(this.C=null,Dn(this),Rr(this),wt(19))};function zo(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function Ho(m,x){var I=null;if(m.g==x){zo(m),Us(m),m.g=null;var C=2}else if(xl(m.h,x))I=x.G,ks(m.h,x),C=1;else return;if(m.I!=0){if(x.o)if(C==1){I=x.u?x.u.length:0,x=Date.now()-x.F;var W=m.D;C=Ci(),xt(C,new vl(C,I)),ei(m)}else en(m);else if(W=x.m,W==3||W==0&&x.X>0||!(C==1&&kc(m,x)||C==2&&Rr(m)))switch(I&&I.length>0&&(x=m.h,x.i=x.i.concat(I)),W){case 1:Mn(m,5);break;case 4:Mn(m,10);break;case 3:Mn(m,6);break;default:Mn(m,2)}}}function $o(m,x){let I=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(I*=2),I*x}function Mn(m,x){if(m.j.info("Error code "+x),x==2){var I=f(m.bb,m),C=m.Ua;const W=!C;C=new _r(C||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||bs(C,"https"),Qr(C),W?xr(C.toString(),I):Ir(C.toString(),I)}else wt(2);m.I=0,m.l&&m.l.pa(x),Os(m),qo(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function Os(m){if(m.I=0,m.ja=[],m.l){const x=Pn(m.h);(x.length!=0||m.i.length!=0)&&(N(m.ja,x),N(m.ja,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.oa()}}function Ml(m,x,I){var C=I instanceof _r?zn(I):new _r(I);if(C.g!="")x&&(C.g=x+"."+C.g),wr(C,C.u);else{var W=l.location;C=W.protocol,x=x?x+"."+W.hostname:W.hostname,W=+W.port;const X=new _r(null);C&&bs(X,C),x&&(X.g=x),W&&wr(X,W),I&&(X.h=I),C=X}return I=m.G,x=m.wa,I&&x&&et(C,I,x),et(C,"VER",m.ka),Cr(m,C),C}function bc(m,x,I){if(x&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=m.Aa&&!m.ma?new ot(new Yr({ab:I})):new ot(m.ma),x.Fa(m.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Dc(){}n=Dc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ko(){}Ko.prototype.g=function(m,x){return new jt(m,x)};function jt(m,x){kt.call(this),this.g=new Bo(x),this.l=m,this.h=x&&x.messageUrlParams||null,m=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(m?m["X-WebChannel-Content-Type"]=x.messageContentType:m={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(m?m["X-WebChannel-Client-Profile"]=x.sa:m={"X-WebChannel-Client-Profile":x.sa}),this.g.U=m,(m=x&&x.Qb)&&!D(m)&&(this.g.u=m),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!D(x)&&(this.g.G=x,m=this.h,m!==null&&x in m&&(m=this.h,x in m&&delete m[x])),this.j=new Fi(this)}v(jt,kt),jt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jt.prototype.close=function(){Go(this.g)},jt.prototype.o=function(m){var x=this.g;if(typeof m=="string"){var I={};I.__data__=m,m=I}else this.v&&(I={},I.__data__=Ii(m),m=I);x.i.push(new hf(x.Ya++,m)),x.I==3&&ei(x)},jt.prototype.N=function(){this.g.l=null,delete this.j,Go(this.g),delete this.g,jt.Z.N.call(this)};function Mc(m){Po.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var x=m.__sm__;if(x){e:{for(const I in x){m=I;break e}m=void 0}(this.i=m)&&(m=this.i,x=x!==null&&m in x?x[m]:void 0),this.data=x}else this.data=m}v(Mc,Po);function Vc(){yl.call(this),this.status=1}v(Vc,yl);function Fi(m){this.g=m}v(Fi,Dc),Fi.prototype.ra=function(){xt(this.g,"a")},Fi.prototype.qa=function(m){xt(this.g,new Mc(m))},Fi.prototype.pa=function(m){xt(this.g,new Vc)},Fi.prototype.oa=function(){xt(this.g,"b")},Ko.prototype.createWebChannel=Ko.prototype.g,jt.prototype.send=jt.prototype.o,jt.prototype.open=jt.prototype.m,jt.prototype.close=jt.prototype.close,Kx=function(){return new Ko},$x=function(){return Ci()},Hx=nr,wm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Pi.NO_ERROR=0,Pi.TIMEOUT=8,Pi.HTTP_ERROR=6,zd=Pi,ki.COMPLETE="complete",zx=ki,gc.EventType=Ai,Ai.OPEN="a",Ai.CLOSE="b",Ai.ERROR="c",Ai.MESSAGE="d",kt.prototype.listen=kt.prototype.J,mu=gc,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,qx=ot}).apply(typeof Md<"u"?Md:typeof self<"u"?self:typeof window<"u"?window:{});const qw="@firebase/firestore",zw="4.9.3";class $t{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$t.UNAUTHENTICATED=new $t(null),$t.GOOGLE_CREDENTIALS=new $t("google-credentials-uid"),$t.FIRST_PARTY=new $t("first-party-uid"),$t.MOCK_USER=new $t("mock-user");let ol="12.7.0";const ds=new mg("@firebase/firestore");function Ea(){return ds.logLevel}function OV(n){ds.setLogLevel(n)}function se(n,...e){if(ds.logLevel<=Ke.DEBUG){const t=e.map(Eg);ds.debug(`Firestore (${ol}): ${n}`,...t)}}function At(n,...e){if(ds.logLevel<=Ke.ERROR){const t=e.map(Eg);ds.error(`Firestore (${ol}): ${n}`,...t)}}function qr(n,...e){if(ds.logLevel<=Ke.WARN){const t=e.map(Eg);ds.warn(`Firestore (${ol}): ${n}`,...t)}}function Eg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ye(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Wx(n,r,t)}function Wx(n,e,t){let r=`FIRESTORE (${ol}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw At(r),new Error(r)}function Te(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Wx(e,i,r)}function BV(n,e){n||ye(57014,e)}function pe(n,e){return n}const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Io{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Zt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class jx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class GV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t($t.UNAUTHENTICATED)))}shutdown(){}}class qV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class zV{constructor(e){this.t=e,this.currentUser=$t.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Te(this.o===void 0,42304);let r=this.i;const i=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let o=new Zt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Zt,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await i(this.currentUser)}))},u=d=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((d=>u(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Zt)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string",31837,{l:r}),new jx(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string",2055,{h:e}),new $t(e)}}class HV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=$t.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $V{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new HV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t($t.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Hw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mx(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Te(this.o===void 0,3512);const r=o=>{o.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,se("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Hw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Hw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function WV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Tg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=WV(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function Me(n,e){return n<e?-1:n>e?1:0}function Em(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),o=e.charAt(r);if(i!==o)return Wp(i)===Wp(o)?Me(i,o):Wp(i)?1:-1}return Me(n.length,e.length)}const jV=55296,JV=57343;function Wp(n){const e=n.charCodeAt(0);return e>=jV&&e<=JV}function Fa(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function Jx(n){return n+"\0"}const $w="__name__";class Vr{constructor(e,t,r){t===void 0?t=0:t>e.length&&ye(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ye(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Vr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=Vr.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Me(e.length,t.length)}static compareSegments(e,t){const r=Vr.isNumericId(e),i=Vr.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Vr.extractNumericId(e).compare(Vr.extractNumericId(t)):Em(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return os.fromString(e.substring(4,e.length-2))}}class qe extends Vr{construct(e,t,r){return new qe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new qe(t)}static emptyPath(){return new qe([])}}const QV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Vr{construct(e,t,r){return new gt(e,t,r)}static isValidIdentifier(e){return QV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$w}static keyField(){return new gt([$w])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new re(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new re(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new re(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(r+=u,i++):(o(),i++)}if(o(),l)throw new re(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(t)}static emptyPath(){return new gt([])}}class he{constructor(e){this.path=e}static fromPath(e){return new he(qe.fromString(e))}static fromName(e){return new he(qe.fromString(e).popFirst(5))}static empty(){return new he(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new qe(e.slice()))}}function xg(n,e,t){if(!t)throw new re(Y.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qx(n,e,t,r){if(e===!0&&r===!0)throw new re(Y.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Kw(n){if(!he.isDocumentKey(n))throw new re(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ww(n){if(he.isDocumentKey(n))throw new re(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Yx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Uh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ye(12329,{type:typeof n})}function Xe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new re(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Uh(n);throw new re(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xx(n,e){if(e<=0)throw new re(Y.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Vt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Zu(n,e){if(!Yx(n))throw new re(Y.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(i&&typeof l!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new re(Y.INVALID_ARGUMENT,t);return!0}const jw=-62135596800,Jw=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Jw);return new nt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new re(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new re(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jw)throw new re(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jw}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zu(e,nt._jsonSchema))return new nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-jw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nt._jsonSchemaVersion="firestore/timestamp/1.0",nt._jsonSchema={type:Vt("string",nt._jsonSchemaVersion),seconds:Vt("number"),nanoseconds:Vt("number")};class Re{static fromTimestamp(e){return new Re(e)}static min(){return new Re(new nt(0,0))}static max(){return new Re(new nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ua=-1;class hh{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Tm(n){return n.fields.find((e=>e.kind===2))}function to(n){return n.fields.filter((e=>e.kind!==2))}hh.UNKNOWN_ID=-1;class Hd{constructor(e,t){this.fieldPath=e,this.kind=t}}class Fu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Fu(0,Gn.min())}}function Zx(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Re.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new Gn(i,he.empty(),e)}function eI(n){return new Gn(n.readTime,n.key,Ua)}class Gn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Gn(Re.min(),he.empty(),Ua)}static max(){return new Gn(Re.max(),he.empty(),Ua)}}function Ig(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:Me(n.largestBatchId,e.largestBatchId))}const tI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ws(n){if(n.code!==Y.FAILED_PRECONDITION||n.message!==tI)throw n;se("LocalStore","Unexpectedly lost primary lease")}class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):$.reject(t)}static resolve(e){return new $(((t,r)=>{t(e)}))}static reject(e){return new $(((t,r)=>{r(e)}))}static waitFor(e){return new $(((t,r)=>{let i=0,o=0,l=!1;e.forEach((u=>{++i,u.next((()=>{++o,l&&o===i&&t()}),(d=>r(d)))})),l=!0,o===i&&t()}))}static or(e){let t=$.resolve(!1);for(const r of e)t=t.next((i=>i?$.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new $(((r,i)=>{const o=e.length,l=new Array(o);let u=0;for(let d=0;d<o;d++){const f=d;t(e[f]).next((y=>{l[f]=y,++u,u===o&&r(l)}),(y=>i(y)))}}))}static doWhile(e,t){return new $(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}const On="SimpleDb";class Oh{static open(e,t,r,i){try{return new Oh(t,e.transaction(i,r))}catch(o){throw new xu(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Zt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new xu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Sg(r.target.error);this.S.reject(new xu(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(se(On,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new XV(t)}}class Or{static delete(e){return se(On,"Removing database:",e),ro(dg().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Ax())return!1;if(Or.F())return!0;const e=ch(),t=Or.M(e),r=0<t&&t<10,i=rI(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Or.M(ch())===12.2&&At("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(se(On,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const l=o.target.result;t(l)},i.onblocked=()=>{r(new xu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const l=o.target.error;l.name==="VersionError"?r(new re(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new re(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new xu(e,l))},i.onupgradeneeded=o=>{se(On,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const l=o.target.result;this.N.k(l,i.transaction,o.oldVersion,this.version).next((()=>{se(On,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const o=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=Oh.open(this.db,e,o?"readonly":"readwrite",r),d=i(u).next((f=>(u.C(),f))).catch((f=>(u.abort(f),$.reject(f)))).toPromise();return d.catch((()=>{})),await u.D,d}catch(u){const d=u,f=d.name!=="FirebaseError"&&l<3;if(se(On,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class YV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ro(this.U.delete())}}class xu extends re{constructor(e,t){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Es(n){return n.name==="IndexedDbTransactionError"}class XV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(se(On,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(se(On,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ro(r)}add(e){return se(On,"ADD",this.store.name,e,e),ro(this.store.add(e))}get(e){return ro(this.store.get(e)).next((t=>(t===void 0&&(t=null),se(On,"GET",this.store.name,e,t),t)))}delete(e){return se(On,"DELETE",this.store.name,e),ro(this.store.delete(e))}count(){return se(On,"COUNT",this.store.name),ro(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new $(((l,u)=>{o.onerror=d=>{u(d.target.error)},o.onsuccess=d=>{l(d.target.result)}}))}{const o=this.cursor(r),l=[];return this.H(o,((u,d)=>{l.push(d)})).next((()=>l))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new $(((i,o)=>{r.onerror=l=>{o(l.target.error)},r.onsuccess=l=>{i(l.target.result)}}))}Z(e,t){se(On,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((o,l,u)=>u.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new $(((r,i)=>{t.onerror=o=>{const l=Sg(o.target.error);i(l)},t.onsuccess=o=>{const l=o.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():r()})):r()}}))}H(e,t){const r=[];return new $(((i,o)=>{e.onerror=l=>{o(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void i();const d=new YV(u),f=t(u.primaryKey,u.value,d);if(f instanceof $){const y=f.catch((v=>(d.done(),$.reject(v))));r.push(y)}d.isDone?i():d.G===null?u.continue():u.continue(d.G)}})).next((()=>$.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ro(n){return new $(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Sg(r.target.error);t(i)}}))}let Qw=!1;function Sg(n){const e=Or.M(ch());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Qw||(Qw=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Iu="IndexBackfiller";class ZV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){se(Iu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();se(Iu,`Documents written: ${t}`)}catch(t){Es(t)?se(Iu,"Ignoring IndexedDB error during index backfill: ",t):await ws(t)}await this.re(6e4)}))}}class eL{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,o=!0;return $.doWhile((()=>o===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return se(Iu,`Processing collection: ${l}`),this.oe(e,l,i).next((u=>{i-=u,r.add(l)}));o=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((o=>{const l=o.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,o))).next((u=>(se(Iu,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,o)=>{const l=eI(o);Ig(l,r)>0&&(r=l)})),new Gn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class An{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}An.ce=-1;const as=-1;function ec(n){return n==null}function Uu(n){return n===0&&1/n==-1/0}function iI(n){return typeof n=="number"&&Number.isInteger(n)&&!Uu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const fh="";function cn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Yw(e)),e=tL(n.get(t),e);return Yw(e)}function tL(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case fh:t+="";break;default:t+=o}}return t}function Yw(n){return n+fh+""}function Fr(n){const e=n.length;if(Te(e>=2,64408,{path:n}),e===2)return Te(n.charAt(0)===fh&&n.charAt(1)==="",56145,{path:n}),qe.emptyPath();const t=e-2,r=[];let i="";for(let o=0;o<e;){const l=n.indexOf(fh,o);switch((l<0||l>t)&&ye(50515,{path:n}),n.charAt(l+1)){case"":const u=n.substring(o,l);let d;i.length===0?d=u:(i+=u,d=i,i=""),r.push(d);break;case"":i+=n.substring(o,l),i+="\0";break;case"":i+=n.substring(o,l+1);break;default:ye(61167,{path:n})}o=l+2}return new qe(r)}const no="remoteDocuments",tc="owner",pa="owner",Ou="mutationQueues",nL="userId",dr="mutations",Xw="batchId",lo="userMutationsIndex",Zw=["userId","batchId"];function $d(n,e){return[n,cn(e)]}function sI(n,e,t){return[n,cn(e),t]}const rL={},Oa="documentMutations",ph="remoteDocumentsV14",iL=["prefixPath","collectionGroup","readTime","documentId"],Kd="documentKeyIndex",sL=["prefixPath","collectionGroup","documentId"],oI="collectionGroupIndex",oL=["collectionGroup","readTime","prefixPath","documentId"],Bu="remoteDocumentGlobal",xm="remoteDocumentGlobalKey",Ba="targets",aI="queryTargetsIndex",aL=["canonicalId","targetId"],Ga="targetDocuments",lL=["targetId","path"],Ag="documentTargetsIndex",uL=["path","targetId"],mh="targetGlobalKey",ho="targetGlobal",Gu="collectionParents",cL=["collectionId","parent"],qa="clientMetadata",dL="clientId",Bh="bundles",hL="bundleId",Gh="namedQueries",fL="name",Cg="indexConfiguration",pL="indexId",Im="collectionGroupIndex",mL="collectionGroup",Su="indexState",gL=["indexId","uid"],lI="sequenceNumberIndex",yL=["uid","sequenceNumber"],Au="indexEntries",vL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uI="documentKeyIndex",_L=["indexId","uid","orderedDocumentKey"],qh="documentOverlays",wL=["userId","collectionPath","documentId"],Sm="collectionPathOverlayIndex",EL=["userId","collectionPath","largestBatchId"],cI="collectionGroupOverlayIndex",TL=["userId","collectionGroup","largestBatchId"],Rg="globals",xL="name",dI=[Ou,dr,Oa,no,Ba,tc,ho,Ga,qa,Bu,Gu,Bh,Gh],IL=[...dI,qh],hI=[Ou,dr,Oa,ph,Ba,tc,ho,Ga,qa,Bu,Gu,Bh,Gh,qh],fI=hI,Ng=[...fI,Cg,Su,Au],SL=Ng,pI=[...Ng,Rg],AL=pI;class Am extends nI{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Ot(n,e){const t=pe(n);return Or.O(t.le,e)}function eE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ts(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function mI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ut{constructor(e,t){this.comparator=e,this.root=t||Yt.EMPTY}insert(e,t){return new ut(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Yt.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Yt{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??Yt.RED,this.left=i??Yt.EMPTY,this.right=o??Yt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new Yt(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Yt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Yt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Yt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Yt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}Yt.EMPTY=null,Yt.RED=!0,Yt.BLACK=!1;Yt.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Yt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class st{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tE(this.data.getIterator())}getIteratorFrom(e){return new tE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class tE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ma(n){return n.hasNext()?n.getNext():void 0}class Cn{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new Cn([])}unionWith(e){let t=new st(gt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Cn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fa(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class gI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function CL(){return typeof atob<"u"}class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new gI("Invalid base64 string: "+o):o}})(e);return new Tt(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let l=0;l<i.length;++l)o+=String.fromCharCode(i[l]);return o})(e);return new Tt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const RL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(n){if(Te(!!n,39018),typeof n=="string"){let e=0;const t=RL.exec(n);if(Te(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(n.seconds),nanos:mt(n.nanos)}}function mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function mi(n){return typeof n=="string"?Tt.fromBase64String(n):Tt.fromUint8Array(n)}const yI="server_timestamp",vI="__type__",_I="__previous_value__",wI="__local_write_time__";function zh(n){return(n?.mapValue?.fields||{})[vI]?.stringValue===yI}function Hh(n){const e=n.mapValue.fields[_I];return zh(e)?Hh(e):e}function qu(n){const e=pi(n.mapValue.fields[wI].timestampValue);return new nt(e.seconds,e.nanos)}class NL{constructor(e,t,r,i,o,l,u,d,f,y){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=y}}const Cm="(default)";class hs{constructor(e,t){this.projectId=e,this.database=t||Cm}static empty(){return new hs("","")}get isDefaultDatabase(){return this.database===Cm}isEqual(e){return e instanceof hs&&e.projectId===this.projectId&&e.database===this.database}}const Pg="__type__",EI="__max__",rs={mapValue:{fields:{__type__:{stringValue:EI}}}},kg="__vector__",za="value",Wd={nullValue:"NULL_VALUE"};function fs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?zh(n)?4:TI(n)?9007199254740991:$h(n)?10:11:ye(28295,{value:n})}function zr(n,e){if(n===e)return!0;const t=fs(n);if(t!==fs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return qu(n).isEqual(qu(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const l=pi(i.timestampValue),u=pi(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return mi(i.bytesValue).isEqual(mi(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return mt(i.geoPointValue.latitude)===mt(o.geoPointValue.latitude)&&mt(i.geoPointValue.longitude)===mt(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return mt(i.integerValue)===mt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const l=mt(i.doubleValue),u=mt(o.doubleValue);return l===u?Uu(l)===Uu(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return Fa(n.arrayValue.values||[],e.arrayValue.values||[],zr);case 10:case 11:return(function(i,o){const l=i.mapValue.fields||{},u=o.mapValue.fields||{};if(eE(l)!==eE(u))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(u[d]===void 0||!zr(l[d],u[d])))return!1;return!0})(n,e);default:return ye(52216,{left:n})}}function zu(n,e){return(n.values||[]).find((t=>zr(t,e)))!==void 0}function ps(n,e){if(n===e)return 0;const t=fs(n),r=fs(e);if(t!==r)return Me(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(n.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=mt(o.integerValue||o.doubleValue),d=mt(l.integerValue||l.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1})(n,e);case 3:return nE(n.timestampValue,e.timestampValue);case 4:return nE(qu(n),qu(e));case 5:return Em(n.stringValue,e.stringValue);case 6:return(function(o,l){const u=mi(o),d=mi(l);return u.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),d=l.split("/");for(let f=0;f<u.length&&f<d.length;f++){const y=Me(u[f],d[f]);if(y!==0)return y}return Me(u.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Me(mt(o.latitude),mt(l.latitude));return u!==0?u:Me(mt(o.longitude),mt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return rE(n.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},d=l.fields||{},f=u[za]?.arrayValue,y=d[za]?.arrayValue,v=Me(f?.values?.length||0,y?.values?.length||0);return v!==0?v:rE(f,y)})(n.mapValue,e.mapValue);case 11:return(function(o,l){if(o===rs.mapValue&&l===rs.mapValue)return 0;if(o===rs.mapValue)return 1;if(l===rs.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),f=l.fields||{},y=Object.keys(f);d.sort(),y.sort();for(let v=0;v<d.length&&v<y.length;++v){const E=Em(d[v],y[v]);if(E!==0)return E;const S=ps(u[d[v]],f[y[v]]);if(S!==0)return S}return Me(d.length,y.length)})(n.mapValue,e.mapValue);default:throw ye(23264,{he:t})}}function nE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Me(n,e);const t=pi(n),r=pi(e),i=Me(t.seconds,r.seconds);return i!==0?i:Me(t.nanos,r.nanos)}function rE(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=ps(t[i],r[i]);if(o)return o}return Me(t.length,r.length)}function Ha(n){return Rm(n)}function Rm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=pi(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return mi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return he.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=Rm(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const l of r)o?o=!1:i+=",",i+=`${l}:${Rm(t.fields[l])}`;return i+"}"})(n.mapValue):ye(61005,{value:n})}function jd(n){switch(fs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hh(n);return e?16+jd(e):16;case 5:return 2*n.stringValue.length;case 6:return mi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+jd(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Ts(r.fields,((o,l)=>{i+=o.length+jd(l)})),i})(n.mapValue);default:throw ye(13486,{value:n})}}function po(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Nm(n){return!!n&&"integerValue"in n}function Hu(n){return!!n&&"arrayValue"in n}function iE(n){return!!n&&"nullValue"in n}function sE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function $h(n){return(n?.mapValue?.fields||{})[Pg]?.stringValue===kg}function Cu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ts(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Cu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Cu(n.arrayValue.values[t]);return e}return{...n}}function TI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===EI}const xI={mapValue:{fields:{[Pg]:{stringValue:kg},[za]:{arrayValue:{}}}}};function PL(n){return"nullValue"in n?Wd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?po(hs.empty(),he.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?$h(n)?xI:{mapValue:{}}:ye(35942,{value:n})}function kL(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?po(hs.empty(),he.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?xI:"mapValue"in n?$h(n)?{mapValue:{}}:rs:ye(61959,{value:n})}function oE(n,e){const t=ps(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function aE(n,e){const t=ps(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cu(t)}setAll(e){let t=gt.emptyPath(),r={},i=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const d=this.getFieldsMap(t);this.applyChanges(d,r,i),r={},i=[],t=u.popLast()}l?r[u.lastSegment()]=Cu(l):i.push(u.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Jd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ts(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new Xt(Cu(this.value))}}function II(n){const e=[];return Ts(n.fields,((t,r)=>{const i=new gt([t]);if(Jd(r)){const o=II(r.mapValue).fields;if(o.length===0)e.push(i);else for(const l of o)e.push(i.child(l))}else e.push(i)})),new Cn(e)}class ft{constructor(e,t,r,i,o,l,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new ft(e,0,Re.min(),Re.min(),Re.min(),Xt.empty(),0)}static newFoundDocument(e,t,r,i){return new ft(e,1,t,Re.min(),r,i,0)}static newNoDocument(e,t){return new ft(e,2,t,Re.min(),Re.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new ft(e,3,t,Re.min(),Re.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ms{constructor(e,t){this.position=e,this.inclusive=t}}function lE(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],l=n.position[i];if(o.field.isKeyField()?r=he.comparator(he.fromName(l.referenceValue),t.key):r=ps(l,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function uE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!zr(n.position[t],e.position[t]))return!1;return!0}class $u{constructor(e,t="asc"){this.field=e,this.dir=t}}function bL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class SI{}class ze extends SI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new DL(e,t,r):t==="array-contains"?new LL(e,r):t==="in"?new kI(e,r):t==="not-in"?new FL(e,r):t==="array-contains-any"?new UL(e,r):new ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ML(e,r):new VL(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ps(t,this.value)):t!==null&&fs(this.value)===fs(t)&&this.matchesComparison(ps(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends SI{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new it(e,t)}matches(e){return $a(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $a(n){return n.op==="and"}function Pm(n){return n.op==="or"}function bg(n){return AI(n)&&$a(n)}function AI(n){for(const e of n.filters)if(e instanceof it)return!1;return!0}function km(n){if(n instanceof ze)return n.field.canonicalString()+n.op.toString()+Ha(n.value);if(bg(n))return n.filters.map((e=>km(e))).join(",");{const e=n.filters.map((t=>km(t))).join(",");return`${n.op}(${e})`}}function CI(n,e){return n instanceof ze?(function(r,i){return i instanceof ze&&r.op===i.op&&r.field.isEqual(i.field)&&zr(r.value,i.value)})(n,e):n instanceof it?(function(r,i){return i instanceof it&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,l,u)=>o&&CI(l,i.filters[u])),!0):!1})(n,e):void ye(19439)}function RI(n,e){const t=n.filters.concat(e);return it.create(t,n.op)}function NI(n){return n instanceof ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ha(t.value)}`})(n):n instanceof it?(function(t){return t.op.toString()+" {"+t.getFilters().map(NI).join(" ,")+"}"})(n):"Filter"}class DL extends ze{constructor(e,t,r){super(e,t,r),this.key=he.fromName(r.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class ML extends ze{constructor(e,t){super(e,"in",t),this.keys=PI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class VL extends ze{constructor(e,t){super(e,"not-in",t),this.keys=PI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function PI(n,e){return(e.arrayValue?.values||[]).map((t=>he.fromName(t.referenceValue)))}class LL extends ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hu(t)&&zu(t.arrayValue,this.value)}}class kI extends ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zu(this.value.arrayValue,t)}}class FL extends ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(zu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!zu(this.value.arrayValue,t)}}class UL extends ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>zu(this.value.arrayValue,r)))}}class OL{constructor(e,t=null,r=[],i=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function bm(n,e=null,t=[],r=[],i=null,o=null,l=null){return new OL(n,e,t,r,i,o,l)}function mo(n){const e=pe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>km(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),ec(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ha(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ha(r))).join(",")),e.Te=t}return e.Te}function nc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!CI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uE(n.startAt,e.startAt)&&uE(n.endAt,e.endAt)}function gh(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function yh(n,e){return n.filters.filter((t=>t instanceof ze&&t.field.isEqual(e)))}function cE(n,e,t){let r=Wd,i=!0;for(const o of yh(n,e)){let l=Wd,u=!0;switch(o.op){case"<":case"<=":l=PL(o.value);break;case"==":case"in":case">=":l=o.value;break;case">":l=o.value,u=!1;break;case"!=":case"not-in":l=Wd}oE({value:r,inclusive:i},{value:l,inclusive:u})<0&&(r=l,i=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];oE({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}}return{value:r,inclusive:i}}function dE(n,e,t){let r=rs,i=!0;for(const o of yh(n,e)){let l=rs,u=!0;switch(o.op){case">=":case">":l=kL(o.value),u=!1;break;case"==":case"in":case"<=":l=o.value;break;case"<":l=o.value,u=!1;break;case"!=":case"not-in":l=rs}aE({value:r,inclusive:i},{value:l,inclusive:u})>0&&(r=l,i=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];aE({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}}return{value:r,inclusive:i}}class vi{constructor(e,t=null,r=[],i=[],o=null,l="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bI(n,e,t,r,i,o,l,u){return new vi(n,e,t,r,i,o,l,u)}function al(n){return new vi(n)}function hE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Dg(n){return n.collectionGroup!==null}function Pa(n){const e=pe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new st(gt.comparator);return l.filters.forEach((d=>{d.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new $u(o,r))})),t.has(gt.keyField().canonicalString())||e.Ie.push(new $u(gt.keyField(),r))}return e.Ie}function yn(n){const e=pe(n);return e.Ee||(e.Ee=BL(e,Pa(n))),e.Ee}function BL(n,e){if(n.limitType==="F")return bm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new $u(i.field,o)}));const t=n.endAt?new ms(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ms(n.startAt.position,n.startAt.inclusive):null;return bm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Dm(n,e){const t=n.filters.concat([e]);return new vi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function vh(n,e,t){return new vi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rc(n,e){return nc(yn(n),yn(e))&&n.limitType===e.limitType}function DI(n){return`${mo(yn(n))}|lt:${n.limitType}`}function Ta(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>NI(i))).join(", ")}]`),ec(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Ha(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Ha(i))).join(",")),`Target(${r})`})(yn(n))}; limitType=${n.limitType})`}function ic(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):he.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of Pa(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(l,u,d){const f=lE(l,u,d);return l.inclusive?f<=0:f<0})(r.startAt,Pa(r),i)||r.endAt&&!(function(l,u,d){const f=lE(l,u,d);return l.inclusive?f>=0:f>0})(r.endAt,Pa(r),i))})(n,e)}function MI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function VI(n){return(e,t)=>{let r=!1;for(const i of Pa(n)){const o=GL(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function GL(n,e,t){const r=n.field.isKeyField()?he.comparator(e.key,t.key):(function(o,l,u){const d=l.data.field(o),f=u.data.field(o);return d!==null&&f!==null?ps(d,f):ye(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ye(19790,{direction:n.dir})}}class _i{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ts(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return mI(this.inner)}size(){return this.innerSize}}const qL=new ut(he.comparator);function Rn(){return qL}const LI=new ut(he.comparator);function gu(...n){let e=LI;for(const t of n)e=e.insert(t.key,t);return e}function FI(n){let e=LI;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ur(){return Ru()}function UI(){return Ru()}function Ru(){return new _i((n=>n.toString()),((n,e)=>n.isEqual(e)))}const zL=new ut(he.comparator),HL=new st(he.comparator);function Ue(...n){let e=HL;for(const t of n)e=e.add(t);return e}const $L=new st(Me);function Mg(){return $L}function Vg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uu(e)?"-0":e}}function OI(n){return{integerValue:""+n}}function BI(n,e){return iI(e)?OI(e):Vg(n,e)}class Kh{constructor(){this._=void 0}}function KL(n,e,t){return n instanceof Ka?(function(i,o){const l={fields:{[vI]:{stringValue:yI},[wI]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&zh(o)&&(o=Hh(o)),o&&(l.fields[_I]=o),{mapValue:l}})(t,e):n instanceof go?qI(n,e):n instanceof yo?zI(n,e):(function(i,o){const l=GI(i,o),u=fE(l)+fE(i.Ae);return Nm(l)&&Nm(i.Ae)?OI(u):Vg(i.serializer,u)})(n,e)}function WL(n,e,t){return n instanceof go?qI(n,e):n instanceof yo?zI(n,e):t}function GI(n,e){return n instanceof Wa?(function(r){return Nm(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Ka extends Kh{}class go extends Kh{constructor(e){super(),this.elements=e}}function qI(n,e){const t=HI(e);for(const r of n.elements)t.some((i=>zr(i,r)))||t.push(r);return{arrayValue:{values:t}}}class yo extends Kh{constructor(e){super(),this.elements=e}}function zI(n,e){let t=HI(e);for(const r of n.elements)t=t.filter((i=>!zr(i,r)));return{arrayValue:{values:t}}}class Wa extends Kh{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function fE(n){return mt(n.integerValue||n.doubleValue)}function HI(n){return Hu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class sc{constructor(e,t){this.field=e,this.transform=t}}function jL(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof go&&i instanceof go||r instanceof yo&&i instanceof yo?Fa(r.elements,i.elements,zr):r instanceof Wa&&i instanceof Wa?zr(r.Ae,i.Ae):r instanceof Ka&&i instanceof Ka})(n.transform,e.transform)}class JL{constructor(e,t){this.version=e,this.transformResults=t}}class yt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yt}static exists(e){return new yt(void 0,e)}static updateTime(e){return new yt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Wh{}function $I(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ul(n.key,yt.none()):new ll(n.key,n.data,yt.none());{const t=n.data,r=Xt.empty();let i=new st(gt.comparator);for(let o of e.fields)if(!i.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?r.delete(o):r.set(o,l),i=i.add(o)}return new wi(n.key,r,new Cn(i.toArray()),yt.none())}}function QL(n,e,t){n instanceof ll?(function(i,o,l){const u=i.value.clone(),d=mE(i.fieldTransforms,o,l.transformResults);u.setAll(d),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof wi?(function(i,o,l){if(!Qd(i.precondition,o))return void o.convertToUnknownDocument(l.version);const u=mE(i.fieldTransforms,o,l.transformResults),d=o.data;d.setAll(KI(i)),d.setAll(u),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):(function(i,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Nu(n,e,t,r){return n instanceof ll?(function(o,l,u,d){if(!Qd(o.precondition,l))return u;const f=o.value.clone(),y=gE(o.fieldTransforms,d,l);return f.setAll(y),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(n,e,t,r):n instanceof wi?(function(o,l,u,d){if(!Qd(o.precondition,l))return u;const f=gE(o.fieldTransforms,d,l),y=l.data;return y.setAll(KI(o)),y.setAll(f),l.convertToFoundDocument(l.version,y).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(o,l,u){return Qd(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function YL(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),o=GI(r.transform,i||null);o!=null&&(t===null&&(t=Xt.empty()),t.set(r.field,o))}return t||null}function pE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fa(r,i,((o,l)=>jL(o,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ll extends Wh{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class wi extends Wh{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function KI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function mE(n,e,t){const r=new Map;Te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const o=n[i],l=o.transform,u=e.data.field(o.field);r.set(o.field,WL(l,u,t[i]))}return r}function gE(n,e,t){const r=new Map;for(const i of n){const o=i.transform,l=t.data.field(i.field);r.set(i.field,KL(o,l,e))}return r}class ul extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Lg extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fg{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&QL(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Nu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Nu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=UI();return this.mutations.forEach((i=>{const o=e.get(i.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=t.has(i.key)?null:u;const d=$I(l,u);d!==null&&r.set(i.key,d),l.isValidDocument()||l.convertToNoDocument(Re.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ue())}isEqual(e){return this.batchId===e.batchId&&Fa(this.mutations,e.mutations,((t,r)=>pE(t,r)))&&Fa(this.baseMutations,e.baseMutations,((t,r)=>pE(t,r)))}}class Ug{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return zL})();const o=e.mutations;for(let l=0;l<o.length;l++)i=i.insert(o[l].key,r[l].version);return new Ug(e,t,r,i)}}class Og{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class XL{constructor(e,t){this.count=e,this.unchangedNames=t}}var Mt,Je;function WI(n){switch(n){case Y.OK:return ye(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return ye(15467,{code:n})}}function jI(n){if(n===void 0)return At("GRPC error has no .code"),Y.UNKNOWN;switch(n){case Mt.OK:return Y.OK;case Mt.CANCELLED:return Y.CANCELLED;case Mt.UNKNOWN:return Y.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return Y.INTERNAL;case Mt.UNAVAILABLE:return Y.UNAVAILABLE;case Mt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Mt.NOT_FOUND:return Y.NOT_FOUND;case Mt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Mt.ABORTED:return Y.ABORTED;case Mt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Mt.DATA_LOSS:return Y.DATA_LOSS;default:return ye(39323,{code:n})}}(Je=Mt||(Mt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";function JI(){return new TextEncoder}const ZL=new os([4294967295,4294967295],0);function yE(n){const e=JI().encode(n),t=new Gx;return t.update(e),new Uint8Array(t.digest())}function vE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new os([t,r],0),new os([i,o],0)]}class Bg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new yu(`Invalid padding: ${t}`);if(r<0)throw new yu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new yu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=os.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(os.fromNumber(r)));return i.compare(ZL)===1&&(i=new os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=yE(e),[r,i]=vE(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,i,o);if(!this.we(l))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new Bg(o,i,t);return r.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=yE(e),[r,i]=vE(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,i,o);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class yu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class oc{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,ac.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new oc(Re.min(),i,new ut(Me),Rn(),Ue())}}class ac{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ac(r,t,Ue(),Ue(),Ue())}}class Yd{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class QI{constructor(e,t){this.targetId=e,this.Ce=t}}class YI{constructor(e,t,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class _E{constructor(){this.ve=0,this.Fe=wE(),this.Me=Tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ue(),t=Ue(),r=Ue();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ye(38017,{changeType:o})}})),new ac(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=wE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class eF{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rn(),this.Je=Ld(),this.He=Ld(),this.Ye=new ut(Me)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(gh(o))if(r===0){const l=new he(o.path);this.et(t,l,ft.newNoDocument(l,Re.min()))}else Te(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const u=this.ut(e),d=u?this.ct(u,e,l):1;if(d!==0){this.it(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,f)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let l,u;try{l=mi(r).toUint8Array()}catch(d){if(d instanceof gI)return qr("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new Bg(l,i,o)}catch(d){return qr(d instanceof yu?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&gh(u.target)){const d=new he(u.target.path);this.It(d).has(l)||this.Et(l,d)||this.et(l,d,ft.newNoDocument(d,e))}o.Be&&(t.set(l,o.ke()),o.qe())}}));let r=Ue();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((d=>{const f=this.ot(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const i=new oc(e,t,this.Ye,this.je,r);return this.je=Rn(),this.Je=Ld(),this.He=Ld(),this.Ye=new ut(Me),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new _E,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new st(Me),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new st(Me),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||se("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new _E),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ld(){return new ut(he.comparator)}function wE(){return new ut(he.comparator)}const tF={asc:"ASCENDING",desc:"DESCENDING"},nF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},rF={and:"AND",or:"OR"};class iF{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mm(n,e){return n.useProto3Json||ec(e)?e:{value:e}}function ja(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sF(n,e){return ja(n,e.toTimestamp())}function Ct(n){return Te(!!n,49232),Re.fromTimestamp((function(t){const r=pi(t);return new nt(r.seconds,r.nanos)})(n))}function Gg(n,e){return Vm(n,e).canonicalString()}function Vm(n,e){const t=(function(i){return new qe(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ZI(n){const e=qe.fromString(n);return Te(uS(e),10190,{key:e.toString()}),e}function Ku(n,e){return Gg(n.databaseId,e.path)}function Br(n,e){const t=ZI(e);if(t.get(1)!==n.databaseId.projectId)throw new re(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new re(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(nS(t))}function eS(n,e){return Gg(n.databaseId,e)}function tS(n){const e=ZI(n);return e.length===4?qe.emptyPath():nS(e)}function Lm(n){return new qe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nS(n){return Te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function EE(n,e,t){return{name:Ku(n,e),fields:t.value.mapValue.fields}}function rS(n,e,t){const r=Br(n,e.name),i=Ct(e.updateTime),o=e.createTime?Ct(e.createTime):Re.min(),l=new Xt({mapValue:{fields:e.fields}}),u=ft.newFoundDocument(r,i,o,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function oF(n,e){return"found"in e?(function(r,i){Te(!!i.found,43571),i.found.name,i.found.updateTime;const o=Br(r,i.found.name),l=Ct(i.found.updateTime),u=i.found.createTime?Ct(i.found.createTime):Re.min(),d=new Xt({mapValue:{fields:i.found.fields}});return ft.newFoundDocument(o,l,u,d)})(n,e):"missing"in e?(function(r,i){Te(!!i.missing,3894),Te(!!i.readTime,22933);const o=Br(r,i.missing),l=Ct(i.readTime);return ft.newNoDocument(o,l)})(n,e):ye(7234,{result:e})}function aF(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:ye(39313,{state:f})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(f,y){return f.useProto3Json?(Te(y===void 0||typeof y=="string",58123),Tt.fromBase64String(y||"")):(Te(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),Tt.fromUint8Array(y||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(f){const y=f.code===void 0?Y.UNKNOWN:jI(f.code);return new re(y,f.message||"")})(l);t=new YI(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Br(n,r.document.name),o=Ct(r.document.updateTime),l=r.document.createTime?Ct(r.document.createTime):Re.min(),u=new Xt({mapValue:{fields:r.document.fields}}),d=ft.newFoundDocument(i,o,l,u),f=r.targetIds||[],y=r.removedTargetIds||[];t=new Yd(f,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Br(n,r.document),o=r.readTime?Ct(r.readTime):Re.min(),l=ft.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Yd([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Br(n,r.document),o=r.removedTargetIds||[];t=new Yd([],o,i,null)}else{if(!("filter"in e))return ye(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,l=new XL(i,o),u=r.targetId;t=new QI(u,l)}}return t}function Wu(n,e){let t;if(e instanceof ll)t={update:EE(n,e.key,e.value)};else if(e instanceof ul)t={delete:Ku(n,e.key)};else if(e instanceof wi)t={update:EE(n,e.key,e.data),updateMask:fF(e.fieldMask)};else{if(!(e instanceof Lg))return ye(16599,{Vt:e.type});t={verify:Ku(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(o,l){const u=l.transform;if(u instanceof Ka)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof go)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof yo)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Wa)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw ye(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:sF(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ye(27497)})(n,e.precondition)),t}function Fm(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?yt.updateTime(Ct(o.updateTime)):o.exists!==void 0?yt.exists(o.exists):yt.none()})(e.currentDocument):yt.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(l,u){let d=null;if("setToServerValue"in u)Te(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),d=new Ka;else if("appendMissingElements"in u){const y=u.appendMissingElements.values||[];d=new go(y)}else if("removeAllFromArray"in u){const y=u.removeAllFromArray.values||[];d=new yo(y)}else"increment"in u?d=new Wa(l,u.increment):ye(16584,{proto:u});const f=gt.fromServerFormat(u.fieldPath);return new sc(f,d)})(n,i))):[];if(e.update){e.update.name;const i=Br(n,e.update.name),o=new Xt({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(d){const f=d.fieldPaths||[];return new Cn(f.map((y=>gt.fromServerFormat(y))))})(e.updateMask);return new wi(i,o,l,t,r)}return new ll(i,o,t,r)}if(e.delete){const i=Br(n,e.delete);return new ul(i,t)}if(e.verify){const i=Br(n,e.verify);return new Lg(i,t)}return ye(1463,{proto:e})}function lF(n,e){return n&&n.length>0?(Te(e!==void 0,14353),n.map((t=>(function(i,o){let l=i.updateTime?Ct(i.updateTime):Ct(o);return l.isEqual(Re.min())&&(l=Ct(o)),new JL(l,i.transformResults||[])})(t,e)))):[]}function iS(n,e){return{documents:[eS(n,e.path)]}}function sS(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=eS(n,i);const o=(function(f){if(f.length!==0)return lS(it.create(f,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const l=(function(f){if(f.length!==0)return f.map((y=>(function(E){return{field:xa(E.field),direction:cF(E.dir)}})(y)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=Mm(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(e.endAt)),{ft:t,parent:i}}function oS(n){let e=tS(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Te(r===1,65062);const y=t.from[0];y.allDescendants?i=y.collectionId:e=e.child(y.collectionId)}let o=[];t.where&&(o=(function(v){const E=aS(v);return E instanceof it&&bg(E)?E.getFilters():[E]})(t.where));let l=[];t.orderBy&&(l=(function(v){return v.map((E=>(function(N){return new $u(Ia(N.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(E)))})(t.orderBy));let u=null;t.limit&&(u=(function(v){let E;return E=typeof v=="object"?v.value:v,ec(E)?null:E})(t.limit));let d=null;t.startAt&&(d=(function(v){const E=!!v.before,S=v.values||[];return new ms(S,E)})(t.startAt));let f=null;return t.endAt&&(f=(function(v){const E=!v.before,S=v.values||[];return new ms(S,E)})(t.endAt)),bI(e,i,l,o,u,"F",d,f)}function uF(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function aS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ia(t.unaryFilter.field);return ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ia(t.unaryFilter.field);return ze.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ia(t.unaryFilter.field);return ze.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ia(t.unaryFilter.field);return ze.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ze.create(Ia(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return it.create(t.compositeFilter.filters.map((r=>aS(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ye(1026)}})(t.compositeFilter.op))})(n):ye(30097,{filter:n})}function cF(n){return tF[n]}function dF(n){return nF[n]}function hF(n){return rF[n]}function xa(n){return{fieldPath:n.canonicalString()}}function Ia(n){return gt.fromServerFormat(n.fieldPath)}function lS(n){return n instanceof ze?(function(t){if(t.op==="=="){if(sE(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NAN"}};if(iE(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(sE(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NOT_NAN"}};if(iE(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xa(t.field),op:dF(t.op),value:t.value}}})(n):n instanceof it?(function(t){const r=t.getFilters().map((i=>lS(i)));return r.length===1?r[0]:{compositeFilter:{op:hF(t.op),filters:r}}})(n):ye(54877,{filter:n})}function fF(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function uS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ci{constructor(e,t,r,i,o=Re.min(),l=Re.min(),u=Tt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new ci(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cS{constructor(e){this.yt=e}}function pF(n,e){let t;if(e.document)t=rS(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=he.fromSegments(e.noDocument.path),i=_o(e.noDocument.readTime);t=ft.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ye(56709);{const r=he.fromSegments(e.unknownDocument.path),i=_o(e.unknownDocument.version);t=ft.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const o=new nt(i[0],i[1]);return Re.fromTimestamp(o)})(e.readTime)),t}function TE(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_h(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(o,l){return{name:Ku(o,l.key),fields:l.data.value.mapValue.fields,updateTime:ja(o,l.version.toTimestamp()),createTime:ja(o,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:vo(e.version)};else{if(!e.isUnknownDocument())return ye(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:vo(e.version)}}return r}function _h(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function vo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _o(n){const e=new nt(n.seconds,n.nanoseconds);return Re.fromTimestamp(e)}function io(n,e){const t=(e.baseMutations||[]).map((o=>Fm(n.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const l=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map((o=>Fm(n.yt,o))),i=nt.fromMillis(e.localWriteTimeMs);return new Fg(e.batchId,i,t,r)}function vu(n){const e=_o(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?_o(n.lastLimboFreeSnapshotVersion):Re.min();let r;return r=(function(o){return o.documents!==void 0})(n.query)?(function(o){const l=o.documents.length;return Te(l===1,1966,{count:l}),yn(al(tS(o.documents[0])))})(n.query):(function(o){return yn(oS(o))})(n.query),new ci(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Tt.fromBase64String(n.resumeToken))}function dS(n,e){const t=vo(e.snapshotVersion),r=vo(e.lastLimboFreeSnapshotVersion);let i;i=gh(e.target)?iS(n.yt,e.target):sS(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:mo(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function qg(n){const e=oS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?vh(e,e.limit,"L"):e}function jp(n,e){return new Og(e.largestBatchId,Fm(n.yt,e.overlayMutation))}function xE(n,e){const t=e.path.lastSegment();return[n,cn(e.path.popLast()),t]}function IE(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:vo(r.readTime),documentKey:cn(r.documentKey.path),largestBatchId:r.largestBatchId}}class mF{getBundleMetadata(e,t){return SE(e).get(t).next((r=>{if(r)return(function(o){return{id:o.bundleId,createTime:_o(o.createTime),version:o.version}})(r)}))}saveBundleMetadata(e,t){return SE(e).put((function(i){return{bundleId:i.id,createTime:vo(Ct(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return AE(e).get(t).next((r=>{if(r)return(function(o){return{name:o.name,query:qg(o.bundledQuery),readTime:_o(o.readTime)}})(r)}))}saveNamedQuery(e,t){return AE(e).put((function(i){return{name:i.name,readTime:vo(Ct(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function SE(n){return Ot(n,Bh)}function AE(n){return Ot(n,Gh)}class jh{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new jh(e,r)}getOverlay(e,t){return uu(e).get(xE(this.userId,t)).next((r=>r?jp(this.serializer,r):null))}getOverlays(e,t){const r=Ur();return $.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((o,l)=>{const u=new Og(t,l);i.push(this.St(e,u))})),$.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((l=>i.add(cn(l.getCollectionPath()))));const o=[];return i.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);o.push(uu(e).Z(Sm,u))})),$.waitFor(o)}getOverlaysForCollection(e,t,r){const i=Ur(),o=cn(t),l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return uu(e).J(Sm,l).next((u=>{for(const d of u){const f=jp(this.serializer,d);i.set(f.getKey(),f)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const o=Ur();let l;const u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return uu(e).ee({index:cI,range:u},((d,f,y)=>{const v=jp(this.serializer,f);o.size()<i||v.largestBatchId===l?(o.set(v.getKey(),v),l=v.largestBatchId):y.done()})).next((()=>o))}St(e,t){return uu(e).put((function(i,o,l){const[u,d,f]=xE(o,l.mutation.key);return{userId:o,collectionPath:d,documentId:f,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Wu(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function uu(n){return Ot(n,qh)}class gF{bt(e){return Ot(e,Rg)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Tt.fromUint8Array(r):Tt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class so{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(mt(e.integerValue));else if("doubleValue"in e){const r=mt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Uu(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=pi(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(mi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?TI(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):$h(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ye(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=za,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(mt(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),he.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}so.Kt=new so;const ga=255;function yF(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function CE(n){const e=64-(function(r){let i=0;for(let o=0;o<8;++o){const l=yF(255&r[o]);if(i+=l,l!==8)break}return i})(n);return Math.ceil(e/8)}class vF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=CE(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=CE(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(ga),this.sn(255)}_n(){this.an(ga),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,o,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ga?(this.sn(ga),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ga?(this.an(ga),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class _F{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class wF{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class cu{constructor(){this.cn=new vF,this.ln=new _F(this.cn),this.hn=new wF(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class oo{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new oo(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Xd(this.En),directionalValue:Xd(this.dn),orderedDocumentKey:Xd(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Xi(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=RE(n.En,e.En),t!==0?t:(t=RE(n.dn,e.dn),t!==0?t:he.comparator(n.In,e.In)))}function RE(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Xd(n){return Sx()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function NE(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class PE{constructor(e){this.mn=new st(((t,r)=>gt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Te(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Tm(e);if(t!==void 0&&!this.wn(t))return!1;const r=to(e);let i=new Set,o=0,l=0;for(;o<r.length&&this.wn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!i.has(u.field.canonicalString())){const d=r[o];if(!this.Sn(u,d)||!this.bn(this.fn[l++],d))return!1}++o}for(;o<r.length;++o){const u=r[o];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new st(gt.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Hd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Hd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Hd(r.field,r.dir==="asc"?0:1)));return new hh(hh.UNKNOWN_ID,this.collectionId,t,Fu.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function hS(n){if(Te(n instanceof ze||n instanceof it,20012),n instanceof ze){if(n instanceof kI){const t=n.value.arrayValue?.values?.map((r=>ze.create(n.field,"==",r)))||[];return it.create(t,"or")}return n}const e=n.filters.map((t=>hS(t)));return it.create(e,n.op)}function EF(n){if(n.getFilters().length===0)return[];const e=Bm(hS(n));return Te(fS(e),7391),Um(e)||Om(e)?[e]:e.getFilters()}function Um(n){return n instanceof ze}function Om(n){return n instanceof it&&bg(n)}function fS(n){return Um(n)||Om(n)||(function(t){if(t instanceof it&&Pm(t)){for(const r of t.getFilters())if(!Um(r)&&!Om(r))return!1;return!0}return!1})(n)}function Bm(n){if(Te(n instanceof ze||n instanceof it,34018),n instanceof ze)return n;if(n.filters.length===1)return Bm(n.filters[0]);const e=n.filters.map((r=>Bm(r)));let t=it.create(e,n.op);return t=wh(t),fS(t)?t:(Te(t instanceof it,64498),Te($a(t),40251),Te(t.filters.length>1,57927),t.filters.reduce(((r,i)=>zg(r,i))))}function zg(n,e){let t;return Te(n instanceof ze||n instanceof it,38388),Te(e instanceof ze||e instanceof it,25473),t=n instanceof ze?e instanceof ze?(function(i,o){return it.create([i,o],"and")})(n,e):kE(n,e):e instanceof ze?kE(e,n):(function(i,o){if(Te(i.filters.length>0&&o.filters.length>0,48005),$a(i)&&$a(o))return RI(i,o.getFilters());const l=Pm(i)?i:o,u=Pm(i)?o:i,d=l.filters.map((f=>zg(f,u)));return it.create(d,"or")})(n,e),wh(t)}function kE(n,e){if($a(e))return RI(e,n.getFilters());{const t=e.filters.map((r=>zg(n,r)));return it.create(t,"or")}}function wh(n){if(Te(n instanceof ze||n instanceof it,11850),n instanceof ze)return n;const e=n.getFilters();if(e.length===1)return wh(e[0]);if(AI(n))return n;const t=e.map((i=>wh(i))),r=[];return t.forEach((i=>{i instanceof ze?r.push(i):i instanceof it&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:it.create(r,n.op)}class TF{constructor(){this.Cn=new Hg}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(Gn.min())}updateCollectionGroup(e,t,r){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class Hg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new st(qe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new st(qe.comparator)).toArray()}}const bE="IndexedDbIndexManager",Fd=new Uint8Array(0);class xF{constructor(e,t){this.databaseId=t,this.vn=new Hg,this.Fn=new _i((r=>mo(r)),((r,i)=>nc(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const o={collectionId:r,parent:cn(i)};return DE(e).put(o)}return $.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Jx(t),""],!1,!0);return DE(e).J(i).next((o=>{for(const l of o){if(l.collectionId!==t)break;r.push(Fr(l.parent))}return r}))}addFieldIndex(e,t){const r=du(e),i=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete i.indexId;const o=r.add(i);if(t.indexState){const l=va(e);return o.next((u=>{l.put(IE(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const r=du(e),i=va(e),o=ya(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=du(e),r=ya(e),i=va(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return $.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const o=new PE(r).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const r=ya(e);let i=!0;const o=new Map;return $.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{i&&(i=!!u),o.set(l,u)})))).next((()=>{if(i){let l=Ue();const u=[];return $.forEach(o,((d,f)=>{se(bE,`Using index ${(function(H){return`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map((ee=>`${ee.fieldPath}:${ee.kind}`)).join(",")}`})(d)} to execute ${mo(t)}`);const y=(function(H,ee){const te=Tm(ee);if(te===void 0)return null;for(const j of yh(H,te.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(f,d),v=(function(H,ee){const te=new Map;for(const j of to(ee))for(const b of yh(H,j.fieldPath))switch(b.op){case"==":case"in":te.set(j.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return te.set(j.fieldPath.canonicalString(),b.value),Array.from(te.values())}return null})(f,d),E=(function(H,ee){const te=[];let j=!0;for(const b of to(ee)){const R=b.kind===0?cE(H,b.fieldPath,H.startAt):dE(H,b.fieldPath,H.startAt);te.push(R.value),j&&(j=R.inclusive)}return new ms(te,j)})(f,d),S=(function(H,ee){const te=[];let j=!0;for(const b of to(ee)){const R=b.kind===0?dE(H,b.fieldPath,H.endAt):cE(H,b.fieldPath,H.endAt);te.push(R.value),j&&(j=R.inclusive)}return new ms(te,j)})(f,d),N=this.On(d,f,E),M=this.On(d,f,S),k=this.Nn(d,f,v),B=this.Bn(d.indexId,y,N,E.inclusive,M,S.inclusive,k);return $.forEach(B,(q=>r.Y(q,t.limit).next((H=>{H.forEach((ee=>{const te=he.fromSegments(ee.documentKey);l.has(te)||(l=l.add(te),u.push(te))}))}))))})).next((()=>u))}return $.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=EF(it.create(e.filters,"and")).map((r=>bm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,o,l,u){const d=(t!=null?t.length:1)*Math.max(r.length,o.length),f=d/(t!=null?t.length:1),y=[];for(let v=0;v<d;++v){const E=t?this.Ln(t[v/f]):Fd,S=this.kn(e,E,r[v%f],i),N=this.qn(e,E,o[v%f],l),M=u.map((k=>this.kn(e,E,k,!0)));y.push(...this.createRange(S,N,M))}return y}kn(e,t,r,i){const o=new oo(e,he.empty(),t,r);return i?o:o.An()}qn(e,t,r,i){const o=new oo(e,he.empty(),t,r);return i?o.An():o}xn(e,t){const r=new PE(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((o=>{let l=null;for(const u of o)r.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return $.forEach(i,(o=>this.xn(e,o).next((l=>{l?r!==0&&l.fields.length<(function(d){let f=new st(gt.comparator),y=!1;for(const v of d.filters)for(const E of v.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?y=!0:f=f.add(E.field));for(const v of d.orderBy)v.field.isKeyField()||(f=f.add(v.field));return f.size+(y?1:0)})(o)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new cu;for(const i of to(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const l=r.Pn(i.kind);so.Kt.Dt(o,l)}return r.un()}Ln(e){const t=new cu;return so.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new cu;return so.Kt.Dt(po(this.databaseId,t),r.Pn((function(o){const l=to(o);return l.length===0?0:l[l.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new cu);let o=0;for(const l of to(e)){const u=r[o++];for(const d of i)if(this.Un(t,l.fieldPath)&&Hu(u))i=this.Kn(i,l,u);else{const f=d.Pn(l.kind);so.Kt.Dt(u,f)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],o=[];for(const l of r.arrayValue.values||[])for(const u of i){const d=new cu;d.seed(u.un()),so.Kt.Dt(l,d.Pn(t.kind)),o.push(d)}return o}Un(e,t){return!!e.filters.find((r=>r instanceof ze&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=du(e),i=va(e);return(t?r.J(Im,IDBKeyRange.bound(t,t)):r.J()).next((o=>{const l=[];return $.forEach(o,(u=>i.get([u.indexId,this.uid]).next((d=>{l.push((function(y,v){const E=v?new Fu(v.sequenceNumber,new Gn(_o(v.readTime),new he(Fr(v.documentKey)),v.largestBatchId)):Fu.empty(),S=y.fields.map((([N,M])=>new Hd(gt.fromServerFormat(N),M)));return new hh(y.indexId,y.collectionGroup,S,E)})(u,d))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Me(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=du(e),o=va(e);return this.Gn(e).next((l=>i.J(Im,IDBKeyRange.bound(t,t)).next((u=>$.forEach(u,(d=>o.put(IE(d.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return $.forEach(t,((i,o)=>{const l=r.get(i.collectionGroup);return(l?$.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((u=>(r.set(i.collectionGroup,u),$.forEach(u,(d=>this.zn(e,i,d).next((f=>{const y=this.jn(o,d);return f.isEqual(y)?$.resolve():this.Jn(e,o,d,f,y)})))))))}))}Hn(e,t,r,i){return ya(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return ya(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=ya(e);let o=new st(Xi);return i.ee({index:uI,range:IDBKeyRange.only([r.indexId,this.uid,Xd(this.$n(r,t))])},((l,u)=>{o=o.add(new oo(r.indexId,t,NE(u.arrayValue),NE(u.directionalValue)))})).next((()=>o))}jn(e,t){let r=new st(Xi);const i=this.Qn(t,e);if(i==null)return r;const o=Tm(t);if(o!=null){const l=e.data.field(o.fieldPath);if(Hu(l))for(const u of l.arrayValue.values||[])r=r.add(new oo(t.indexId,e.key,this.Ln(u),i))}else r=r.add(new oo(t.indexId,e.key,Fd,i));return r}Jn(e,t,r,i,o){se(bE,"Updating index entries for document '%s'",t.key);const l=[];return(function(d,f,y,v,E){const S=d.getIterator(),N=f.getIterator();let M=ma(S),k=ma(N);for(;M||k;){let B=!1,q=!1;if(M&&k){const H=y(M,k);H<0?q=!0:H>0&&(B=!0)}else M!=null?q=!0:B=!0;B?(v(k),k=ma(N)):q?(E(M),M=ma(S)):(M=ma(S),k=ma(N))}})(i,o,Xi,(u=>{l.push(this.Hn(e,t,r,u))}),(u=>{l.push(this.Yn(e,t,r,u))})),$.waitFor(l)}Gn(e){let t=1;return va(e).ee({index:lI,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,o)=>{o.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,u)=>Xi(l,u))).filter(((l,u,d)=>!u||Xi(l,d[u-1])!==0));const i=[];i.push(e);for(const l of r){const u=Xi(l,e),d=Xi(l,t);if(u===0)i[0]=e.An();else if(u>0&&d<0)i.push(l),i.push(l.An());else if(d>0)break}i.push(t);const o=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const u=i[l].Vn(this.uid,Fd,he.empty()),d=i[l+1].Vn(this.uid,Fd,he.empty());o.push(IDBKeyRange.bound(u,d))}return o}Zn(e,t){return Xi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ME)}getMinOffset(e,t){return $.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||ye(44426))))).next(ME)}}function DE(n){return Ot(n,Gu)}function ya(n){return Ot(n,Au)}function du(n){return Ot(n,Cg)}function va(n){return Ot(n,Su)}function ME(n){Te(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Ig(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Gn(e.readTime,e.documentKey,t)}const VE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pS=41943040;class an{static withCacheSize(e){return new an(e,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function mS(n,e,t){const r=n.store(dr),i=n.store(Oa),o=[],l=IDBKeyRange.only(t.batchId);let u=0;const d=r.ee({range:l},((y,v,E)=>(u++,E.delete())));o.push(d.next((()=>{Te(u===1,47070,{batchId:t.batchId})})));const f=[];for(const y of t.mutations){const v=sI(e,y.key.path,t.batchId);o.push(i.delete(v)),f.push(y.key)}return $.waitFor(o).next((()=>f))}function Eh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ye(14731);e=n.noDocument}return JSON.stringify(e).length}an.DEFAULT_COLLECTION_PERCENTILE=10,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,an.DEFAULT=new an(pS,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),an.DISABLED=new an(-1,0,0);class Jh{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Te(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Jh(o,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zi(e).ee({index:lo,range:r},((i,o,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const o=Sa(e),l=Zi(e);return l.add({}).next((u=>{Te(typeof u=="number",49019);const d=new Fg(u,t,r,i),f=(function(S,N,M){const k=M.baseMutations.map((q=>Wu(S.yt,q))),B=M.mutations.map((q=>Wu(S.yt,q)));return{userId:N,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:k,mutations:B}})(this.serializer,this.userId,d),y=[];let v=new st(((E,S)=>Me(E.canonicalString(),S.canonicalString())));for(const E of i){const S=sI(this.userId,E.key.path,u);v=v.add(E.key.path.popLast()),y.push(l.put(f)),y.push(o.put(S,rL))}return v.forEach((E=>{y.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Xn[u]=d.keys()})),$.waitFor(y).next((()=>d))}))}lookupMutationBatch(e,t){return Zi(e).get(t).next((r=>r?(Te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),io(this.serializer,r)):null))}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Zi(e).ee({index:lo,range:i},((l,u,d)=>{u.userId===this.userId&&(Te(u.batchId>=r,47524,{tr:r}),o=io(this.serializer,u)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=as;return Zi(e).ee({index:lo,range:t,reverse:!0},((i,o,l)=>{r=o.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,as],[this.userId,Number.POSITIVE_INFINITY]);return Zi(e).J(lo,t).next((r=>r.map((i=>io(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=$d(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Sa(e).ee({range:i},((l,u,d)=>{const[f,y,v]=l,E=Fr(y);if(f===this.userId&&t.path.isEqual(E))return Zi(e).get(v).next((S=>{if(!S)throw ye(61480,{nr:l,batchId:v});Te(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:v}),o.push(io(this.serializer,S))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new st(Me);const i=[];return t.forEach((o=>{const l=$d(this.userId,o.path),u=IDBKeyRange.lowerBound(l),d=Sa(e).ee({range:u},((f,y,v)=>{const[E,S,N]=f,M=Fr(S);E===this.userId&&o.path.isEqual(M)?r=r.add(N):v.done()}));i.push(d)})),$.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,o=$d(this.userId,r),l=IDBKeyRange.lowerBound(o);let u=new st(Me);return Sa(e).ee({range:l},((d,f,y)=>{const[v,E,S]=d,N=Fr(E);v===this.userId&&r.isPrefixOf(N)?N.length===i&&(u=u.add(S)):y.done()})).next((()=>this.rr(e,u)))}rr(e,t){const r=[],i=[];return t.forEach((o=>{i.push(Zi(e).get(o).next((l=>{if(l===null)throw ye(35274,{batchId:o});Te(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:o}),r.push(io(this.serializer,l))})))})),$.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return mS(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),$.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return $.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return Sa(e).ee({range:r},((o,l,u)=>{if(o[0]===this.userId){const d=Fr(o[1]);i.push(d)}else u.done()})).next((()=>{Te(i.length===0,56720,{sr:i.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return gS(e,this.userId,t)}_r(e){return yS(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:as,lastStreamToken:""}))}}function gS(n,e,t){const r=$d(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r);let l=!1;return Sa(n).ee({range:o,X:!0},((u,d,f)=>{const[y,v,E]=u;y===e&&v===i&&(l=!0),f.done()})).next((()=>l))}function Zi(n){return Ot(n,dr)}function Sa(n){return Ot(n,Oa)}function yS(n){return Ot(n,Ou)}class wo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wo(0)}static cr(){return new wo(-1)}}class IF{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new wo(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Re.fromTimestamp(new nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>_a(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Te(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const o=[];return _a(e).ee(((l,u)=>{const d=vu(u);d.sequenceNumber<=t&&r.get(d.targetId)===null&&(i++,o.push(this.removeTargetData(e,d)))})).next((()=>$.waitFor(o))).next((()=>i))}forEachTarget(e,t){return _a(e).ee(((r,i)=>{const o=vu(i);t(o)}))}lr(e){return LE(e).get(mh).next((t=>(Te(t!==null,2888),t)))}hr(e,t){return LE(e).put(mh,t)}Pr(e,t){return _a(e).put(dS(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=mo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return _a(e).ee({range:i,index:aI},((l,u,d)=>{const f=vu(u);nc(t,f.target)&&(o=f,d.done())})).next((()=>o))}addMatchingKeys(e,t,r){const i=[],o=ns(e);return t.forEach((l=>{const u=cn(l.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,l))})),$.waitFor(i)}removeMatchingKeys(e,t,r){const i=ns(e);return $.forEach(t,(o=>{const l=cn(o.path);return $.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,o)])}))}removeMatchingKeysForTargetId(e,t){const r=ns(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ns(e);let o=Ue();return i.ee({range:r,X:!0},((l,u,d)=>{const f=Fr(l[1]),y=new he(f);o=o.add(y)})).next((()=>o))}containsKey(e,t){const r=cn(t.path),i=IDBKeyRange.bound([r],[Jx(r)],!1,!0);let o=0;return ns(e).ee({index:Ag,X:!0,range:i},(([l,u],d,f)=>{l!==0&&(o++,f.done())})).next((()=>o>0))}At(e,t){return _a(e).get(t).next((r=>r?vu(r):null))}}function _a(n){return Ot(n,Ba)}function LE(n){return Ot(n,ho)}function ns(n){return Ot(n,Ga)}const FE="LruGarbageCollector",SF=1048576;function UE([n,e],[t,r]){const i=Me(n,t);return i===0?Me(e,r):i}class AF{constructor(e){this.Ir=e,this.buffer=new st(UE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();UE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class vS{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){se(FE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Es(t)?se(FE,"Ignoring IndexedDB error during garbage collection: ",t):await ws(t)}await this.Vr(3e5)}))}}class CF{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return $.resolve(An.ce);const r=new AF(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(se("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(VE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(se("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VE):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,l,u,d,f;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,l=Date.now(),this.nthSequenceNumber(e,i)))).next((v=>(r=v,u=Date.now(),this.removeTargets(e,r,t)))).next((v=>(o=v,d=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(f=Date.now(),Ea()<=Ke.DEBUG&&se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-y}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${v} documents in `+(f-d)+`ms
Total Duration: ${f-y}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v}))))}}function _S(n,e){return new CF(n,e)}class RF{constructor(e,t){this.db=e,this.garbageCollector=_S(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Ud(e,r)}removeReference(e,t,r){return Ud(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ud(e,t)}br(e,t){return(function(i,o){let l=!1;return yS(i).te((u=>gS(i,u,o).next((d=>(d&&(l=!0),$.resolve(!d)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.Sr(e,((l,u)=>{if(u<=t){const d=this.br(e,l).next((f=>{if(!f)return o++,r.getEntry(e,l).next((()=>(r.removeEntry(l,Re.min()),ns(e).delete((function(v){return[0,cn(v.path)]})(l)))))}));i.push(d)}})).next((()=>$.waitFor(i))).next((()=>r.apply(e))).next((()=>o))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ud(e,t)}Sr(e,t){const r=ns(e);let i,o=An.ce;return r.ee({index:Ag},(([l,u],{path:d,sequenceNumber:f})=>{l===0?(o!==An.ce&&t(new he(Fr(i)),o),o=f,i=d):o=An.ce})).next((()=>{o!==An.ce&&t(new he(Fr(i)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ud(n,e){return ns(n).put((function(r,i){return{targetId:0,path:cn(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class wS{constructor(){this.changes=new _i((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?$.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NF{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Xs(e).put(r)}removeEntry(e,t,r){return Xs(e).delete((function(o,l){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],_h(l),u[u.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=ft.newInvalidDocument(t);return Xs(e).ee({index:Kd,range:IDBKeyRange.only(hu(t))},((i,o)=>{r=this.Cr(t,o)})).next((()=>r))}vr(e,t){let r={size:0,document:ft.newInvalidDocument(t)};return Xs(e).ee({index:Kd,range:IDBKeyRange.only(hu(t))},((i,o)=>{r={document:this.Cr(t,o),size:Eh(o)}})).next((()=>r))}getEntries(e,t){let r=Rn();return this.Fr(e,t,((i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l)})).next((()=>r))}Mr(e,t){let r=Rn(),i=new ut(he.comparator);return this.Fr(e,t,((o,l)=>{const u=this.Cr(o,l);r=r.insert(o,u),i=i.insert(o,Eh(l))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return $.resolve();let i=new st(GE);t.forEach((d=>i=i.add(d)));const o=IDBKeyRange.bound(hu(i.first()),hu(i.last())),l=i.getIterator();let u=l.getNext();return Xs(e).ee({index:Kd,range:o},((d,f,y)=>{const v=he.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;u&&GE(u,v)<0;)r(u,null),u=l.getNext();u&&u.isEqual(v)&&(r(u,f),u=l.hasNext()?l.getNext():null),u?y.j(hu(u)):y.done()})).next((()=>{for(;u;)r(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,o){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),_h(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xs(e).J(IDBKeyRange.bound(u,d,!0)).next((f=>{o?.incrementDocumentReadCount(f.length);let y=Rn();for(const v of f){const E=this.Cr(he.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);E.isFoundDocument()&&(ic(t,E)||i.has(E.key))&&(y=y.insert(E.key,E))}return y}))}getAllFromCollectionGroup(e,t,r,i){let o=Rn();const l=BE(t,r),u=BE(t,Gn.max());return Xs(e).ee({index:oI,range:IDBKeyRange.bound(l,u,!0)},((d,f,y)=>{const v=this.Cr(he.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);o=o.insert(v.key,v),o.size===i&&y.done()})).next((()=>o))}newChangeBuffer(e){return new PF(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return OE(e).get(xm).next((t=>(Te(!!t,20021),t)))}Dr(e,t){return OE(e).put(xm,t)}Cr(e,t){if(t){const r=pF(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Re.min())))return r}return ft.newInvalidDocument(e)}}function ES(n){return new NF(n)}class PF extends wS{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new _i((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new st(((o,l)=>Me(o.canonicalString(),l.canonicalString())));return this.changes.forEach(((o,l)=>{const u=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,u.readTime)),l.isValidDocument()){const d=TE(this.Nr.serializer,l);i=i.add(o.path.popLast());const f=Eh(d);r+=f-u.size,t.push(this.Nr.addEntry(e,o,d))}else if(r-=u.size,this.trackRemovals){const d=TE(this.Nr.serializer,l.convertToNoDocument(Re.min()));t.push(this.Nr.addEntry(e,o,d))}})),i.forEach((o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Nr.updateMetadata(e,r)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((o,l)=>{this.Br.set(o,{size:l,readTime:r.get(o).readTime})})),r)))}}function OE(n){return Ot(n,Bu)}function Xs(n){return Ot(n,ph)}function hu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function BE(n,e){const t=e.documentKey.path.toArray();return[n,_h(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function GE(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=Me(t[o],r[o]),i)return i;return i=Me(t.length,r.length),i||(i=Me(t[t.length-2],r[r.length-2]),i||Me(t[t.length-1],r[r.length-1]))}class kF{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class TS{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Nu(r.mutation,i,Cn.empty(),nt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ue()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ue()){const i=Ur();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let l=gu();return o.forEach(((u,d)=>{l=l.insert(u,d.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=Ur();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ue())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,r,i){let o=Rn();const l=Ru(),u=(function(){return Ru()})();return t.forEach(((d,f)=>{const y=r.get(f.key);i.has(f.key)&&(y===void 0||y.mutation instanceof wi)?o=o.insert(f.key,f):y!==void 0?(l.set(f.key,y.mutation.getFieldMask()),Nu(y.mutation,f,y.mutation.getFieldMask(),nt.now())):l.set(f.key,Cn.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((f,y)=>l.set(f,y))),t.forEach(((f,y)=>u.set(f,new kF(y,l.get(f)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Ru();let i=new ut(((l,u)=>l-u)),o=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((d=>{const f=t.get(d);if(f===null)return;let y=r.get(d)||Cn.empty();y=u.applyToLocalView(f,y),r.set(d,y);const v=(i.get(u.batchId)||Ue()).add(d);i=i.insert(u.batchId,v)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),f=d.key,y=d.value,v=UI();y.forEach((E=>{if(!o.has(E)){const S=$I(t.get(E),r.get(E));S!==null&&v.set(E,S),o=o.add(E)}})),l.push(this.documentOverlayCache.saveOverlays(e,f,v))}return $.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(l){return he.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Dg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const l=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):$.resolve(Ur());let u=Ua,d=o;return l.next((f=>$.forEach(f,((y,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(y)?$.resolve():this.remoteDocumentCache.getEntry(e,y).next((E=>{d=d.insert(y,E)}))))).next((()=>this.populateOverlays(e,f,o))).next((()=>this.computeViews(e,d,f,Ue()))).next((y=>({batchId:u,changes:FI(y)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next((r=>{let i=gu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let l=gu();return this.indexManager.getCollectionParents(e,o).next((u=>$.forEach(u,(d=>{const f=(function(v,E){return new vi(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next((y=>{y.forEach(((v,E)=>{l=l.insert(v,E)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((l=>{o.forEach(((d,f)=>{const y=f.getKey();l.get(y)===null&&(l=l.insert(y,ft.newInvalidDocument(y)))}));let u=gu();return l.forEach(((d,f)=>{const y=o.get(d);y!==void 0&&Nu(y.mutation,f,Cn.empty(),nt.now()),ic(t,f)&&(u=u.insert(d,f))})),u}))}}class bF{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ct(i.createTime)}})(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:qg(i.bundledQuery),readTime:Ct(i.readTime)}})(t)),$.resolve()}}class DF{constructor(){this.overlays=new ut(he.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ur();return $.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.St(e,t,o)})),$.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,t,r){const i=Ur(),o=t.length+1,l=new he(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const d=u.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>r&&i.set(d.getKey(),d)}return $.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ut(((f,y)=>f-y));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let y=o.get(f.largestBatchId);y===null&&(y=Ur(),o=o.insert(f.largestBatchId,y)),y.set(f.getKey(),f)}}const u=Ur(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((f,y)=>u.set(f,y))),!(u.size()>=i)););return $.resolve(u)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Og(t,r));let o=this.qr.get(t);o===void 0&&(o=Ue(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}}class MF{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}class $g{constructor(){this.Qr=new st(Ht.$r),this.Ur=new st(Ht.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ht(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ht(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new he(new qe([])),r=new Ht(t,e),i=new Ht(t,e+1),o=[];return this.Ur.forEachInRange([r,i],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new he(new qe([])),r=new Ht(t,e),i=new Ht(t,e+1);let o=Ue();return this.Ur.forEachInRange([r,i],(l=>{o=o.add(l.key)})),o}containsKey(e){const t=new Ht(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ht{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return he.comparator(e.key,t.key)||Me(e.Yr,t.Yr)}static Kr(e,t){return Me(e.Yr,t.Yr)||he.comparator(e.key,t.key)}}class VF{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new st(Ht.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Fg(o,t,r,i);this.mutationQueue.push(l);for(const u of i)this.Zr=this.Zr.add(new Ht(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return $.resolve(l)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),o=i<0?0:i;return $.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?as:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ht(t,0),i=new Ht(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],(l=>{const u=this.Xr(l.Yr);o.push(u)})),$.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new st(Me);return t.forEach((i=>{const o=new Ht(i,0),l=new Ht(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{r=r.add(u.Yr)}))})),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;he.isDocumentKey(o)||(o=o.child(""));const l=new Ht(new he(o),0);let u=new st(Me);return this.Zr.forEachWhile((d=>{const f=d.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(u=u.add(d.Yr)),!0)}),l),$.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(t.mutations,(i=>{const o=new Ht(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ht(t,0),i=this.Zr.firstAfterOrEqual(r);return $.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class LF{constructor(e){this.ri=e,this.docs=(function(){return new ut(he.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return $.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(t))}getEntries(e,t){let r=Rn();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():ft.newInvalidDocument(i))})),$.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Rn();const l=t.path,u=new he(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:f,value:{document:y}}=d.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||Ig(eI(y),r)<=0||(i.has(y.key)||ic(t,y))&&(o=o.insert(y.key,y.mutableCopy()))}return $.resolve(o)}getAllFromCollectionGroup(e,t,r,i){ye(9500)}ii(e,t){return $.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new FF(this)}getSize(e){return $.resolve(this.size)}}class FF extends wS{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class UF{constructor(e){this.persistence=e,this.si=new _i((t=>mo(t)),nc),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.oi=0,this._i=new $g,this.targetCount=0,this.ai=wo.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new wo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),$.waitFor(o).next((()=>i))}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return $.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),$.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((l=>{o.push(i.markPotentiallyOrphaned(e,l))})),$.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return $.resolve(r)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}class Kg{constructor(e,t){this.ui={},this.overlays={},this.ci=new An(0),this.li=!1,this.li=!0,this.hi=new MF,this.referenceDelegate=e(this),this.Pi=new UF(this),this.indexManager=new TF,this.remoteDocumentCache=(function(i){return new LF(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new cS(t),this.Ii=new bF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new DF,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new VF(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){se("MemoryPersistence","Starting transaction:",e);const i=new OF(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(e,t){return $.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class OF extends nI{constructor(e){super(),this.currentSequenceNumber=e}}class Qh{constructor(e){this.persistence=e,this.Ri=new $g,this.Vi=null}static mi(e){return new Qh(e)}get fi(){if(this.Vi)return this.Vi;throw ye(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),$.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,(r=>{const i=he.fromPath(r);return this.gi(e,i).next((o=>{o||t.removeEntry(i,Re.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Th{constructor(e,t){this.persistence=e,this.pi=new _i((r=>cn(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=_S(this,t)}static mi(e,t){return new Th(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return $.forEach(this.pi,((r,i)=>this.br(e,r,i).next((o=>o?$.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,(l=>this.br(e,l,t).next((u=>{u||(r++,o.removeEntry(l,Re.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=jd(e.data.value)),t}br(e,t,r){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class BF{constructor(e){this.serializer=e}k(e,t,r,i){const o=new Oh("createOrUpgrade",t);r<1&&i>=1&&((function(d){d.createObjectStore(tc)})(e),(function(d){d.createObjectStore(Ou,{keyPath:nL}),d.createObjectStore(dr,{keyPath:Xw,autoIncrement:!0}).createIndex(lo,Zw,{unique:!0}),d.createObjectStore(Oa)})(e),qE(e),(function(d){d.createObjectStore(no)})(e));let l=$.resolve();return r<3&&i>=3&&(r!==0&&((function(d){d.deleteObjectStore(Ga),d.deleteObjectStore(Ba),d.deleteObjectStore(ho)})(e),qE(e)),l=l.next((()=>(function(d){const f=d.store(ho),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Re.min().toTimestamp(),targetCount:0};return f.put(mh,y)})(o)))),r<4&&i>=4&&(r!==0&&(l=l.next((()=>(function(d,f){return f.store(dr).J().next((v=>{d.deleteObjectStore(dr),d.createObjectStore(dr,{keyPath:Xw,autoIncrement:!0}).createIndex(lo,Zw,{unique:!0});const E=f.store(dr),S=v.map((N=>E.put(N)));return $.waitFor(S)}))})(e,o)))),l=l.next((()=>{(function(d){d.createObjectStore(qa,{keyPath:dL})})(e)}))),r<5&&i>=5&&(l=l.next((()=>this.yi(o)))),r<6&&i>=6&&(l=l.next((()=>((function(d){d.createObjectStore(Bu)})(e),this.wi(o))))),r<7&&i>=7&&(l=l.next((()=>this.Si(o)))),r<8&&i>=8&&(l=l.next((()=>this.bi(e,o)))),r<9&&i>=9&&(l=l.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(l=l.next((()=>this.Di(o)))),r<11&&i>=11&&(l=l.next((()=>{(function(d){d.createObjectStore(Bh,{keyPath:hL})})(e),(function(d){d.createObjectStore(Gh,{keyPath:fL})})(e)}))),r<12&&i>=12&&(l=l.next((()=>{(function(d){const f=d.createObjectStore(qh,{keyPath:wL});f.createIndex(Sm,EL,{unique:!1}),f.createIndex(cI,TL,{unique:!1})})(e)}))),r<13&&i>=13&&(l=l.next((()=>(function(d){const f=d.createObjectStore(ph,{keyPath:iL});f.createIndex(Kd,sL),f.createIndex(oI,oL)})(e))).next((()=>this.Ci(e,o))).next((()=>e.deleteObjectStore(no)))),r<14&&i>=14&&(l=l.next((()=>this.Fi(e,o)))),r<15&&i>=15&&(l=l.next((()=>(function(d){d.createObjectStore(Cg,{keyPath:pL,autoIncrement:!0}).createIndex(Im,mL,{unique:!1}),d.createObjectStore(Su,{keyPath:gL}).createIndex(lI,yL,{unique:!1}),d.createObjectStore(Au,{keyPath:vL}).createIndex(uI,_L,{unique:!1})})(e)))),r<16&&i>=16&&(l=l.next((()=>{t.objectStore(Su).clear()})).next((()=>{t.objectStore(Au).clear()}))),r<17&&i>=17&&(l=l.next((()=>{(function(d){d.createObjectStore(Rg,{keyPath:xL})})(e)}))),r<18&&i>=18&&Sx()&&(l=l.next((()=>{t.objectStore(Su).clear()})).next((()=>{t.objectStore(Au).clear()}))),l}wi(e){let t=0;return e.store(no).ee(((r,i)=>{t+=Eh(i)})).next((()=>{const r={byteSize:t};return e.store(Bu).put(xm,r)}))}yi(e){const t=e.store(Ou),r=e.store(dr);return t.J().next((i=>$.forEach(i,(o=>{const l=IDBKeyRange.bound([o.userId,as],[o.userId,o.lastAcknowledgedBatchId]);return r.J(lo,l).next((u=>$.forEach(u,(d=>{Te(d.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=io(this.serializer,d);return mS(e,o.userId,f).next((()=>{}))}))))}))))}Si(e){const t=e.store(Ga),r=e.store(no);return e.store(ho).get(mh).next((i=>{const o=[];return r.ee(((l,u)=>{const d=new qe(l),f=(function(v){return[0,cn(v)]})(d);o.push(t.get(f).next((y=>y?$.resolve():(v=>t.put({targetId:0,path:cn(v),sequenceNumber:i.highestListenSequenceNumber}))(d))))})).next((()=>$.waitFor(o)))}))}bi(e,t){e.createObjectStore(Gu,{keyPath:cL});const r=t.store(Gu),i=new Hg,o=l=>{if(i.add(l)){const u=l.lastSegment(),d=l.popLast();return r.put({collectionId:u,parent:cn(d)})}};return t.store(no).ee({X:!0},((l,u)=>{const d=new qe(l);return o(d.popLast())})).next((()=>t.store(Oa).ee({X:!0},(([l,u,d],f)=>{const y=Fr(u);return o(y.popLast())}))))}Di(e){const t=e.store(Ba);return t.ee(((r,i)=>{const o=vu(i),l=dS(this.serializer,o);return t.put(l)}))}Ci(e,t){const r=t.store(no),i=[];return r.ee(((o,l)=>{const u=t.store(ph),d=(function(v){return v.document?new he(qe.fromString(v.document.name).popFirst(5)):v.noDocument?he.fromSegments(v.noDocument.path):v.unknownDocument?he.fromSegments(v.unknownDocument.path):ye(36783)})(l).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(u.put(f))})).next((()=>$.waitFor(i)))}Fi(e,t){const r=t.store(dr),i=ES(this.serializer),o=new Kg(Qh.mi,this.serializer.yt);return r.J().next((l=>{const u=new Map;return l.forEach((d=>{let f=u.get(d.userId)??Ue();io(this.serializer,d).keys().forEach((y=>f=f.add(y))),u.set(d.userId,f)})),$.forEach(u,((d,f)=>{const y=new $t(f),v=jh.wt(this.serializer,y),E=o.getIndexManager(y),S=Jh.wt(y,this.serializer,E,o.referenceDelegate);return new TS(i,S,v,E).recalculateAndSaveOverlaysForDocumentKeys(new Am(t,An.ce),d).next()}))}))}}function qE(n){n.createObjectStore(Ga,{keyPath:lL}).createIndex(Ag,uL,{unique:!0}),n.createObjectStore(Ba,{keyPath:"targetId"}).createIndex(aI,aL,{unique:!0}),n.createObjectStore(ho)}const es="IndexedDbPersistence",Jp=18e5,Qp=5e3,Yp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",xS="main";class Wg{constructor(e,t,r,i,o,l,u,d,f,y,v=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=o,this.window=l,this.document=u,this.xi=f,this.Oi=y,this.Ni=v,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=E=>Promise.resolve(),!Wg.v())throw new re(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new RF(this,i),this.$i=t+xS,this.serializer=new cS(d),this.Ui=new Or(this.$i,this.Ni,new BF(this.serializer)),this.hi=new gF,this.Pi=new IF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ES(this.serializer),this.Ii=new mF,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,y===!1&&At(es,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(Y.FAILED_PRECONDITION,Yp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new An(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Od(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Es(e))return se(es,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return se(es,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return fu(e).get(pa).next((t=>$.resolve(this.es(t))))}ts(e){return Od(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Jp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Ot(t,qa);return r.J().next((i=>{const o=this.ss(i,Jp),l=i.filter((u=>o.indexOf(u)===-1));return $.forEach(l,(u=>r.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):fu(e).get(pa).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Qp)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new re(Y.FAILED_PRECONDITION,Yp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Od(e).J().next((r=>this.ss(r,Qp).find((i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&se(es,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[tc,qa],(e=>{const t=new Am(e,An.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Od(e).J().next((t=>this.ss(t,Jp).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Jh.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xF(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return jh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){se(es,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===18?AL:d===17?pI:d===16?SL:d===15?Ng:d===14?fI:d===13?hI:d===12?IL:d===11?dI:void ye(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,i,o,(u=>(l=new Am(u,this.ci?this.ci.next():An.ce),t==="readwrite-primary"?this.Hi(l).next((d=>!!d||this.Yi(l))).next((d=>{if(!d)throw At(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new re(Y.FAILED_PRECONDITION,tI);return r(l)})).next((d=>this.Xi(l).next((()=>d)))):this.Is(l).next((()=>r(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return fu(e).get(pa).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Qp)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new re(Y.FAILED_PRECONDITION,Yp)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fu(e).put(pa,t)}static v(){return Or.v()}Zi(e){const t=fu(e);return t.get(pa).next((r=>this.es(r)?(se(es,"Releasing primary lease."),t.delete(pa)):$.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(At(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Ix()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return se(es,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return At(es,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){At("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fu(n){return Ot(n,tc)}function Od(n){return Ot(n,qa)}function jg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Jg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Ue(),i=Ue();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Jg(e,t.fromCache,r,i)}}class GF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class IS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Ix()?8:rI(ch())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.ys(e,t).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,t,i,r).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new GF;return this.Ss(e,t,l).next((u=>{if(o.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>o.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Ea()<=Ke.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Ta(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(Ea()<=Ke.DEBUG&&se("QueryEngine","Query:",Ta(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Ea()<=Ke.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Ta(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(t))):$.resolve())}ys(e,t){if(hE(t))return $.resolve(null);let r=yn(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=vh(t,null,"F"),r=yn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const l=Ue(...o);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,r).next((d=>{const f=this.Ds(t,u);return this.Cs(t,f,l,d.readTime)?this.ys(e,vh(t,null,"F")):this.vs(e,f,t,d)}))))})))))}ws(e,t,r,i){return hE(t)||i.isEqual(Re.min())?$.resolve(null):this.ps.getDocuments(e,r).next((o=>{const l=this.Ds(t,o);return this.Cs(t,l,r,i)?$.resolve(null):(Ea()<=Ke.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ta(t)),this.vs(e,l,t,Zx(i,Ua)).next((u=>u)))}))}Ds(e,t){let r=new st(VI(e));return t.forEach(((i,o)=>{ic(e,o)&&(r=r.add(o))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return Ea()<=Ke.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Ta(t)),this.ps.getDocumentsMatchingQuery(e,t,Gn.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((l=>{o=o.insert(l.key,l)})),o)))}}const Qg="LocalStore",qF=3e8;class zF{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new ut(Me),this.xs=new _i((o=>mo(o)),nc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new TS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function SS(n,e,t,r){return new zF(n,e,t,r)}async function AS(n,e){const t=pe(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const l=[],u=[];let d=Ue();for(const f of i){l.push(f.batchId);for(const y of f.mutations)d=d.add(y.key)}for(const f of o){u.push(f.batchId);for(const y of f.mutations)d=d.add(y.key)}return t.localDocuments.getDocuments(r,d).next((f=>({Ls:f,removedBatchIds:l,addedBatchIds:u})))}))}))}function HF(n,e){const t=pe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,d,f,y){const v=f.batch,E=v.keys();let S=$.resolve();return E.forEach((N=>{S=S.next((()=>y.getEntry(d,N))).next((M=>{const k=f.docVersions.get(N);Te(k!==null,48541),M.version.compareTo(k)<0&&(v.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),y.addEntry(M)))}))})),S.next((()=>u.mutationQueue.removeMutationBatch(d,v)))})(t,r,e,o).next((()=>o.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let d=Ue();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(d=d.add(u.batch.mutations[f].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function CS(n){const e=pe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function $F(n,e){const t=pe(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const u=[];e.targetChanges.forEach(((y,v)=>{const E=i.get(v);if(!E)return;u.push(t.Pi.removeMatchingKeys(o,y.removedDocuments,v).next((()=>t.Pi.addMatchingKeys(o,y.addedDocuments,v))));let S=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Tt.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,r)),i=i.insert(v,S),(function(M,k,B){return M.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=qF?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(E,S,y)&&u.push(t.Pi.updateTargetData(o,S))}));let d=Rn(),f=Ue();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,y))})),u.push(RS(o,l,e.documentUpdates).next((y=>{d=y.ks,f=y.qs}))),!r.isEqual(Re.min())){const y=t.Pi.getLastRemoteSnapshotVersion(o).next((v=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));u.push(y)}return $.waitFor(u).next((()=>l.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,f))).next((()=>d))})).then((o=>(t.Ms=i,o)))}function RS(n,e,t){let r=Ue(),i=Ue();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let l=Rn();return t.forEach(((u,d)=>{const f=o.get(u);d.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),d.isNoDocument()&&d.version.isEqual(Re.min())?(e.removeEntry(u,d.readTime),l=l.insert(u,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),l=l.insert(u,d)):se(Qg,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",d.version)})),{ks:l,qs:i}}))}function KF(n,e){const t=pe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=as),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ja(n,e){const t=pe(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((o=>o?(i=o,$.resolve(i)):t.Pi.allocateTargetId(r).next((l=>(i=new ci(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Qa(n,e,t){const r=pe(n),i=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Es(l))throw l;se(Qg,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function xh(n,e,t){const r=pe(n);let i=Re.min(),o=Ue();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(d,f,y){const v=pe(d),E=v.xs.get(y);return E!==void 0?$.resolve(v.Ms.get(E)):v.Pi.getTargetData(f,y)})(r,l,yn(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,u.targetId).next((d=>{o=d}))})).next((()=>r.Fs.getDocumentsMatchingQuery(l,e,t?i:Re.min(),t?o:Ue()))).next((u=>(kS(r,MI(e),u),{documents:u,Qs:o})))))}function NS(n,e){const t=pe(n),r=pe(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(o=>r.At(o,e).next((l=>l?l.target:null))))}function PS(n,e){const t=pe(n),r=t.Os.get(e)||Re.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,Zx(r,Ua),Number.MAX_SAFE_INTEGER))).then((i=>(kS(t,e,i),i)))}function kS(n,e,t){let r=n.Os.get(e)||Re.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Os.set(e,r)}async function WF(n,e,t,r){const i=pe(n);let o=Ue(),l=Rn();for(const f of t){const y=e.$s(f.metadata.name);f.document&&(o=o.add(y));const v=e.Us(f);v.setReadTime(e.Ks(f.metadata.readTime)),l=l.insert(y,v)}const u=i.Ns.newChangeBuffer({trackRemovals:!0}),d=await Ja(i,(function(y){return yn(al(qe.fromString(`__bundle__/docs/${y}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(f=>RS(f,u,l).next((y=>(u.apply(f),y))).next((y=>i.Pi.removeMatchingKeysForTargetId(f,d.targetId).next((()=>i.Pi.addMatchingKeys(f,o,d.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(f,y.ks,y.qs))).next((()=>y.ks))))))}async function jF(n,e,t=Ue()){const r=await Ja(n,yn(qg(e.bundledQuery))),i=pe(n);return i.persistence.runTransaction("Save named query","readwrite",(o=>{const l=Ct(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ii.saveNamedQuery(o,e);const u=r.withResumeToken(Tt.EMPTY_BYTE_STRING,l);return i.Ms=i.Ms.insert(u.targetId,u),i.Pi.updateTargetData(o,u).next((()=>i.Pi.removeMatchingKeysForTargetId(o,r.targetId))).next((()=>i.Pi.addMatchingKeys(o,t,r.targetId))).next((()=>i.Ii.saveNamedQuery(o,e)))}))}const bS="firestore_clients";function zE(n,e){return`${bS}_${n}_${e}`}const DS="firestore_mutations";function HE(n,e,t){let r=`${DS}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const MS="firestore_targets";function Xp(n,e){return`${MS}_${n}_${e}`}const Lr="SharedClientState";class Ih{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ws(e,t,r){const i=JSON.parse(r);let o,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(o=new re(i.error.code,i.error.message))),l?new Ih(e,t,i.state,o):(At(Lr,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new re(r.error.code,r.error.message))),o?new Pu(e,r.state,i):(At(Lr,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=Mg();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=iI(r.activeTargetIds[l]),o=o.add(r.activeTargetIds[l]);return i?new Sh(e,o):(At(Lr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Yg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Yg(t.clientId,t.onlineState):(At(Lr,`Failed to parse online state: ${e}`),null)}}class Gm{constructor(){this.activeTargetIds=Mg()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zp{constructor(e,t,r,i,o){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new ut(Me),this.started=!1,this.Xs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=zE(this.persistenceKey,this.Js),this.no=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Gm),this.ro=new RegExp(`^${bS}_${l}_([^_]*)$`),this.io=new RegExp(`^${DS}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${MS}_${l}_(\\d+)$`),this.oo=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this._o=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem(zE(this.persistenceKey,r));if(i){const o=Sh.Ws(r,i);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Xp(this.persistenceKey,e));if(i){const o=Pu.Ws(e,i);o&&(r=o.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Xp(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.Po(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return se(Lr,"READ",e,t),t}setItem(e,t){se(Lr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){se(Lr,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(se(Lr,"EVENT",t.key,t.newValue),t.key===this.eo)return void At("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(o){let l=An.ce;if(o!=null)try{const u=JSON.parse(o);Te(typeof u=="number",30636,{So:o}),l=u}catch(u){At(Lr,"Failed to read sequence number from WebStorage",u)}return l})(t.newValue);r!==An.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const i=new Ih(this.currentUser,e,t,r),o=HE(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Gs())}Po(e){const t=HE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const i=Xp(this.persistenceKey,e),o=new Pu(e,t,r);this.setItem(i,o.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return Sh.Ws(r,t)}fo(e,t){const r=this.io.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Ih.Ws(new $t(o),i,t)}yo(e,t){const r=this.so.exec(e),i=Number(r[1]);return Pu.Ws(i,t)}uo(e){return Yg.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);se(Lr,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),o=this.lo(r),l=[],u=[];return o.forEach((d=>{i.has(d)||l.push(d)})),i.forEach((d=>{o.has(d)||u.push(d)})),this.syncEngine.Fo(l,u).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=Mg();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class VS{constructor(){this.Mo=new Gm,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Gm,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class JF{Oo(e){}shutdown(){}}const $E="ConnectivityMonitor";class KE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){se($E,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){se($E,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Bd=null;function qm(){return Bd===null?Bd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bd++,"0x"+Bd.toString(16)}const em="RestConnection",QF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YF{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Cm?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){const l=qm(),u=this.zo(e,t.toUriEncodedString());se(em,`Sending RPC '${e}' ${l}:`,u,r);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,i,o);const{host:f}=new URL(u),y=fg(f);return this.Jo(e,u,d,r,y).then((v=>(se(em,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw qr(em,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",r),v}))}Ho(e,t,r,i,o,l){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ol})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}zo(e,t){const r=QF[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class XF{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const on="WebChannelConnection";class ZF extends YF{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){const l=qm();return new Promise(((u,d)=>{const f=new qx;f.setWithCredentials(!0),f.listenOnce(zx.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case zd.NO_ERROR:const v=f.getResponseJson();se(on,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case zd.TIMEOUT:se(on,`RPC '${e}' ${l} timed out`),d(new re(Y.DEADLINE_EXCEEDED,"Request time out"));break;case zd.HTTP_ERROR:const E=f.getStatus();if(se(on,`RPC '${e}' ${l} failed with status:`,E,"response text:",f.getResponseText()),E>0){let S=f.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S?.error;if(N&&N.status&&N.message){const M=(function(B){const q=B.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(q)>=0?q:Y.UNKNOWN})(N.status);d(new re(M,N.message))}else d(new re(Y.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new re(Y.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{l_:e,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{se(on,`RPC '${e}' ${l} completed.`)}}));const y=JSON.stringify(i);se(on,`RPC '${e}' ${l} sending request:`,i),f.send(t,"POST",y,r,15)}))}T_(e,t,r){const i=qm(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Kx(),u=$x(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const y=o.join("");se(on,`Creating RPC '${e}' stream ${i}: ${y}`,d);const v=l.createWebChannel(y,d);this.I_(v);let E=!1,S=!1;const N=new XF({Yo:k=>{S?se(on,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(E||(se(on,`Opening RPC '${e}' stream ${i} transport.`),v.open(),E=!0),se(on,`RPC '${e}' stream ${i} sending:`,k),v.send(k))},Zo:()=>v.close()}),M=(k,B,q)=>{k.listen(B,(H=>{try{q(H)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return M(v,mu.EventType.OPEN,(()=>{S||(se(on,`RPC '${e}' stream ${i} transport opened.`),N.o_())})),M(v,mu.EventType.CLOSE,(()=>{S||(S=!0,se(on,`RPC '${e}' stream ${i} transport closed`),N.a_(),this.E_(v))})),M(v,mu.EventType.ERROR,(k=>{S||(S=!0,qr(on,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),N.a_(new re(Y.UNAVAILABLE,"The operation could not be completed")))})),M(v,mu.EventType.MESSAGE,(k=>{if(!S){const B=k.data[0];Te(!!B,16349);const q=B,H=q?.error||q[0]?.error;if(H){se(on,`RPC '${e}' stream ${i} received error:`,H);const ee=H.status;let te=(function(R){const P=Mt[R];if(P!==void 0)return jI(P)})(ee),j=H.message;te===void 0&&(te=Y.INTERNAL,j="Unknown error status: "+ee+" with message "+H.message),S=!0,N.a_(new re(te,j)),v.close()}else se(on,`RPC '${e}' stream ${i} received:`,B),N.u_(B)}})),M(u,Hx.STAT_EVENT,(k=>{k.stat===wm.PROXY?se(on,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===wm.NOPROXY&&se(on,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{N.__()}),0),N}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function LS(){return typeof window<"u"?window:null}function Zd(){return typeof document<"u"?document:null}function lc(n){return new iF(n,!0)}class Xg{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&se("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const WE="PersistentStream";class FS{constructor(e,t,r,i,o,l,u,d){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Xg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Y.RESOURCE_EXHAUSTED?(At(t.toString()),At("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new re(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return se(WE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(se(WE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class e4 extends FS{constructor(e,t,r,i,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=aF(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Re.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Re.min():l.readTime?Ct(l.readTime):Re.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Lm(this.serializer),t.addTarget=(function(o,l){let u;const d=l.target;if(u=gh(d)?{documents:iS(o,d)}:{query:sS(o,d).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=XI(o,l.resumeToken);const f=Mm(o,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(Re.min())>0){u.readTime=ja(o,l.snapshotVersion.toTimestamp());const f=Mm(o,l.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,e);const r=uF(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Lm(this.serializer),t.removeTarget=e,this.q_(t)}}class t4 extends FS{constructor(e,t,r,i,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=lF(e.writeResults,e.commitTime),r=Ct(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Lm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Wu(this.serializer,r)))};this.q_(t)}}class n4{}class r4 extends n4{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,Vm(t,r),i,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(Y.UNKNOWN,o.toString())}))}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,Vm(t,r),i,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new re(Y.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class i4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(At(t),this.aa=!1):se("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Eo="RemoteStore";class s4{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{r.enqueueAndForget((async()=>{xs(this)&&(se(Eo,"Restarting streams for network reachability change."),await(async function(d){const f=pe(d);f.Ea.add(4),await cl(f),f.Ra.set("Unknown"),f.Ea.delete(4),await uc(f)})(this))}))})),this.Ra=new i4(r,i)}}async function uc(n){if(xs(n))for(const e of n.da)await e(!0)}async function cl(n){for(const e of n.da)await e(!1)}function Yh(n,e){const t=pe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ty(t)?ey(t):hl(t).O_()&&Zg(t,e))}function Ya(n,e){const t=pe(n),r=hl(t);t.Ia.delete(e),r.O_()&&US(t,e),t.Ia.size===0&&(r.O_()?r.L_():xs(t)&&t.Ra.set("Unknown"))}function Zg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hl(n).Y_(e)}function US(n,e){n.Va.Ue(e),hl(n).Z_(e)}function ey(n){n.Va=new eF({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),hl(n).start(),n.Ra.ua()}function ty(n){return xs(n)&&!hl(n).x_()&&n.Ia.size>0}function xs(n){return pe(n).Ea.size===0}function OS(n){n.Va=void 0}async function o4(n){n.Ra.set("Online")}async function a4(n){n.Ia.forEach(((e,t)=>{Zg(n,e)}))}async function l4(n,e){OS(n),ty(n)?(n.Ra.ha(e),ey(n)):n.Ra.set("Unknown")}async function u4(n,e,t){if(n.Ra.set("Online"),e instanceof YI&&e.state===2&&e.cause)try{await(async function(i,o){const l=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.Va.removeTarget(u))})(n,e)}catch(r){se(Eo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ah(n,r)}else if(e instanceof Yd?n.Va.Ze(e):e instanceof QI?n.Va.st(e):n.Va.tt(e),!t.isEqual(Re.min()))try{const r=await CS(n.localStore);t.compareTo(r)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const y=o.Ia.get(f);y&&o.Ia.set(f,y.withResumeToken(d.resumeToken,l))}})),u.targetMismatches.forEach(((d,f)=>{const y=o.Ia.get(d);if(!y)return;o.Ia.set(d,y.withResumeToken(Tt.EMPTY_BYTE_STRING,y.snapshotVersion)),US(o,d);const v=new ci(y.target,d,f,y.sequenceNumber);Zg(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){se(Eo,"Failed to raise snapshot:",r),await Ah(n,r)}}async function Ah(n,e,t){if(!Es(e))throw e;n.Ea.add(1),await cl(n),n.Ra.set("Offline"),t||(t=()=>CS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{se(Eo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await uc(n)}))}function BS(n,e){return e().catch((t=>Ah(n,t,e)))}async function dl(n){const e=pe(n),t=gs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:as;for(;c4(e);)try{const i=await KF(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,d4(e,i)}catch(i){await Ah(e,i)}GS(e)&&qS(e)}function c4(n){return xs(n)&&n.Ta.length<10}function d4(n,e){n.Ta.push(e);const t=gs(n);t.O_()&&t.X_&&t.ea(e.mutations)}function GS(n){return xs(n)&&!gs(n).x_()&&n.Ta.length>0}function qS(n){gs(n).start()}async function h4(n){gs(n).ra()}async function f4(n){const e=gs(n);for(const t of n.Ta)e.ea(t.mutations)}async function p4(n,e,t){const r=n.Ta.shift(),i=Ug.from(r,e,t);await BS(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await dl(n)}async function m4(n,e){e&&gs(n).X_&&await(async function(r,i){if((function(l){return WI(l)&&l!==Y.ABORTED})(i.code)){const o=r.Ta.shift();gs(r).B_(),await BS(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i))),await dl(r)}})(n,e),GS(n)&&qS(n)}async function jE(n,e){const t=pe(n);t.asyncQueue.verifyOperationInProgress(),se(Eo,"RemoteStore received new credentials");const r=xs(t);t.Ea.add(3),await cl(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await uc(t)}async function zm(n,e){const t=pe(n);e?(t.Ea.delete(2),await uc(t)):e||(t.Ea.add(2),await cl(t),t.Ra.set("Unknown"))}function hl(n){return n.ma||(n.ma=(function(t,r,i){const o=pe(t);return o.sa(),new e4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:o4.bind(null,n),t_:a4.bind(null,n),r_:l4.bind(null,n),H_:u4.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ty(n)?ey(n):n.Ra.set("Unknown")):(await n.ma.stop(),OS(n))}))),n.ma}function gs(n){return n.fa||(n.fa=(function(t,r,i){const o=pe(t);return o.sa(),new t4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:h4.bind(null,n),r_:m4.bind(null,n),ta:f4.bind(null,n),na:p4.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await dl(n)):(await n.fa.stop(),n.Ta.length>0&&(se(Eo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ny{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Zt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const l=Date.now()+r,u=new ny(e,t,l,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fl(n,e){if(At("AsyncQueue",`${e}: ${n}`),Es(n))return new re(Y.UNAVAILABLE,`${e}: ${n}`);throw n}class ka{static emptySet(e){return new ka(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||he.comparator(t.key,r.key):(t,r)=>he.comparator(t.key,r.key),this.keyedMap=gu(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ka)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ka;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class JE{constructor(){this.ga=new ut(he.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ye(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Xa{constructor(e,t,r,i,o,l,u,d,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,o){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Xa(e,t,ka.emptySet(t),l,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class g4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class y4{constructor(){this.queries=QE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=pe(t),o=i.queries;i.queries=QE(),o.forEach(((l,u)=>{for(const d of u.Sa)d.onError(r)}))})(this,new re(Y.ABORTED,"Firestore shutting down"))}}function QE(){return new _i((n=>DI(n)),rc)}async function ry(n,e){const t=pe(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.ba()&&e.Da()&&(r=2):(o=new g4,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const u=fl(l,`Initialization of query '${Ta(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&sy(t)}async function iy(n,e){const t=pe(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function v4(n,e){const t=pe(n);let r=!1;for(const i of e){const o=i.query,l=t.queries.get(o);if(l){for(const u of l.Sa)u.Fa(i)&&(r=!0);l.wa=i}}r&&sy(t)}function _4(n,e,t){const r=pe(n),i=r.queries.get(e);if(i)for(const o of i.Sa)o.onError(t);r.queries.delete(e)}function sy(n){n.Ca.forEach((e=>{e.next()}))}var Hm,YE;(YE=Hm||(Hm={})).Ma="default",YE.Cache="cache";class oy{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Xa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Hm.Cache}}class w4{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class XE{constructor(e){this.serializer=e}$s(e){return Br(this.serializer,e)}Us(e){return e.metadata.exists?rS(this.serializer,e.document,!1):ft.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Ct(e)}}class E4{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=zS(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=qe.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new XE(this.serializer);for(const i of e)if(i.metadata.queries){const o=r.$s(i.metadata.name);for(const l of i.metadata.queries){const u=(t.get(l)||Ue()).add(o);t.set(l,u)}}return t}async ja(e){const t=await WF(e,new XE(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const i of this.Ka)await jF(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function zS(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class HS{constructor(e){this.key=e}}class $S{constructor(e){this.key=e}}class KS{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ue(),this.mutatedKeys=Ue(),this.eu=VI(e),this.tu=new ka(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new JE,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,l=i,u=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((y,v)=>{const E=i.get(y),S=ic(this.query,v)?v:null,N=!!E&&this.mutatedKeys.has(E.key),M=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let k=!1;E&&S?E.data.isEqual(S.data)?N!==M&&(r.track({type:3,doc:S}),k=!0):this.su(E,S)||(r.track({type:2,doc:S}),k=!0,(d&&this.eu(S,d)>0||f&&this.eu(S,f)<0)&&(u=!0)):!E&&S?(r.track({type:0,doc:S}),k=!0):E&&!S&&(r.track({type:1,doc:E}),k=!0,(d||f)&&(u=!0)),k&&(S?(l=l.add(S),o=M?o.add(y):o.delete(y)):(l=l.delete(y),o=o.delete(y)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const y=this.query.limitType==="F"?l.last():l.first();l=l.delete(y.key),o=o.delete(y.key),r.track({type:1,doc:y})}return{tu:l,iu:r,Cs:u,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((y,v)=>(function(S,N){const M=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Rt:k})}};return M(S)-M(N)})(y.type,v.type)||this.eu(y.doc,v.doc))),this.ou(r),i=i??!1;const u=t&&!i?this._u():[],d=this.Xa.size===0&&this.current&&!i?1:0,f=d!==this.Za;return this.Za=d,l.length!==0||f?{snapshot:new Xa(this.query,e.tu,o,l,e.mutatedKeys,d===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new JE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ue(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new $S(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new HS(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ue();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Is="SyncEngine";class T4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class x4{constructor(e){this.key=e,this.hu=!1}}class I4{constructor(e,t,r,i,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new _i((u=>DI(u)),rc),this.Iu=new Map,this.Eu=new Set,this.du=new ut(he.comparator),this.Au=new Map,this.Ru=new $g,this.Vu={},this.mu=new Map,this.fu=wo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function S4(n,e,t=!0){const r=Xh(n);let i;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await WS(r,e,t,!0),i}async function A4(n,e){const t=Xh(n);await WS(t,e,!0,!1)}async function WS(n,e,t,r){const i=await Ja(n.localStore,yn(e)),o=i.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t);let u;return r&&(u=await ay(n,e,o,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&Yh(n.remoteStore,i),u}async function ay(n,e,t,r,i){n.pu=(v,E,S)=>(async function(M,k,B,q){let H=k.view.ru(B);H.Cs&&(H=await xh(M.localStore,k.query,!1).then((({documents:b})=>k.view.ru(b,H))));const ee=q&&q.targetChanges.get(k.targetId),te=q&&q.targetMismatches.get(k.targetId)!=null,j=k.view.applyChanges(H,M.isPrimaryClient,ee,te);return $m(M,k.targetId,j.au),j.snapshot})(n,v,E,S);const o=await xh(n.localStore,e,!0),l=new KS(e,o.Qs),u=l.ru(o.documents),d=ac.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=l.applyChanges(u,n.isPrimaryClient,d);$m(n,t,f.au);const y=new T4(e,t,l);return n.Tu.set(e,y),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),f.snapshot}async function C4(n,e,t){const r=pe(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter((l=>!rc(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Qa(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ya(r.remoteStore,i.targetId),Za(r,i.targetId)})).catch(ws)):(Za(r,i.targetId),await Qa(r.localStore,i.targetId,!0))}async function R4(n,e){const t=pe(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ya(t.remoteStore,r.targetId))}async function N4(n,e,t){const r=dy(n);try{const i=await(function(l,u){const d=pe(l),f=nt.now(),y=u.reduce(((S,N)=>S.add(N.key)),Ue());let v,E;return d.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let N=Rn(),M=Ue();return d.Ns.getEntries(S,y).next((k=>{N=k,N.forEach(((B,q)=>{q.isValidDocument()||(M=M.add(B))}))})).next((()=>d.localDocuments.getOverlayedDocuments(S,N))).next((k=>{v=k;const B=[];for(const q of u){const H=YL(q,v.get(q.key).overlayedDocument);H!=null&&B.push(new wi(q.key,H,II(H.value.mapValue),yt.exists(!0)))}return d.mutationQueue.addMutationBatch(S,f,B,u)})).next((k=>{E=k;const B=k.applyToLocalDocumentSet(v,M);return d.documentOverlayCache.saveOverlays(S,k.batchId,B)}))})).then((()=>({batchId:E.batchId,changes:FI(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(l,u,d){let f=l.Vu[l.currentUser.toKey()];f||(f=new ut(Me)),f=f.insert(u,d),l.Vu[l.currentUser.toKey()]=f})(r,i.batchId,t),await Ei(r,i.changes),await dl(r.remoteStore)}catch(i){const o=fl(i,"Failed to persist write");t.reject(o)}}async function jS(n,e){const t=pe(n);try{const r=await $F(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const l=t.Au.get(o);l&&(Te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?Te(l.hu,14607):i.removedDocuments.size>0&&(Te(l.hu,42227),l.hu=!1))})),await Ei(t,r,e)}catch(r){await ws(r)}}function ZE(n,e,t){const r=pe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const d=pe(l);d.onlineState=u;let f=!1;d.queries.forEach(((y,v)=>{for(const E of v.Sa)E.va(u)&&(f=!0)})),f&&sy(d)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function P4(n,e,t){const r=pe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),o=i&&i.key;if(o){let l=new ut(he.comparator);l=l.insert(o,ft.newNoDocument(o,Re.min()));const u=Ue().add(o),d=new oc(Re.min(),new Map,new ut(Me),l,u);await jS(r,d),r.du=r.du.remove(o),r.Au.delete(e),cy(r)}else await Qa(r.localStore,e,!1).then((()=>Za(r,e,t))).catch(ws)}async function k4(n,e){const t=pe(n),r=e.batch.batchId;try{const i=await HF(t.localStore,e);uy(t,r,null),ly(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ei(t,i)}catch(i){await ws(i)}}async function b4(n,e,t){const r=pe(n);try{const i=await(function(l,u){const d=pe(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let y;return d.mutationQueue.lookupMutationBatch(f,u).next((v=>(Te(v!==null,37113),y=v.keys(),d.mutationQueue.removeMutationBatch(f,v)))).next((()=>d.mutationQueue.performConsistencyCheck(f))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(f,y,u))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,y))).next((()=>d.localDocuments.getDocuments(f,y)))}))})(r.localStore,e);uy(r,e,t),ly(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ei(r,i)}catch(i){await ws(i)}}async function D4(n,e){const t=pe(n);xs(t.remoteStore)||se(Is,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(l){const u=pe(l);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(d=>u.mutationQueue.getHighestUnacknowledgedBatchId(d)))})(t.localStore);if(r===as)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=fl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function ly(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function uy(n,e,t){const r=pe(n);let i=r.Vu[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Za(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||JS(n,r)}))}function JS(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ya(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),cy(n))}function $m(n,e,t){for(const r of t)r instanceof HS?(n.Ru.addReference(r.key,e),M4(n,r)):r instanceof $S?(se(Is,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||JS(n,r.key)):ye(19791,{wu:r})}function M4(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(se(Is,"New document in limbo: "+t),n.Eu.add(r),cy(n))}function cy(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new he(qe.fromString(e)),r=n.fu.next();n.Au.set(r,new x4(t)),n.du=n.du.insert(t,r),Yh(n.remoteStore,new ci(yn(al(t.path)),r,"TargetPurposeLimboResolution",An.ce))}}async function Ei(n,e,t){const r=pe(n),i=[],o=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,d)=>{l.push(r.pu(d,e,t).then((f=>{if((f||t)&&r.isPrimaryClient){const y=f?!f.fromCache:t?.targetChanges.get(d.targetId)?.current;r.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(f){i.push(f);const y=Jg.As(d.targetId,f);o.push(y)}})))})),await Promise.all(l),r.Pu.H_(i),await(async function(d,f){const y=pe(d);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>$.forEach(f,(E=>$.forEach(E.Es,(S=>y.persistence.referenceDelegate.addReference(v,E.targetId,S))).next((()=>$.forEach(E.ds,(S=>y.persistence.referenceDelegate.removeReference(v,E.targetId,S)))))))))}catch(v){if(!Es(v))throw v;se(Qg,"Failed to update sequence numbers: "+v)}for(const v of f){const E=v.targetId;if(!v.fromCache){const S=y.Ms.get(E),N=S.snapshotVersion,M=S.withLastLimboFreeSnapshotVersion(N);y.Ms=y.Ms.insert(E,M)}}})(r.localStore,o))}async function V4(n,e){const t=pe(n);if(!t.currentUser.isEqual(e)){se(Is,"User change. New user:",e.toKey());const r=await AS(t.localStore,e);t.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((d=>{d.reject(new re(Y.CANCELLED,l))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ei(t,r.Ls)}}function L4(n,e){const t=pe(n),r=t.Au.get(e);if(r&&r.hu)return Ue().add(r.key);{let i=Ue();const o=t.Iu.get(e);if(!o)return i;for(const l of o){const u=t.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}async function F4(n,e){const t=pe(n),r=await xh(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&$m(t,e.targetId,i.au),i}async function U4(n,e){const t=pe(n);return PS(t.localStore,e).then((r=>Ei(t,r)))}async function O4(n,e,t,r){const i=pe(n),o=await(function(u,d){const f=pe(u),y=pe(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",(v=>y.er(v,d).next((E=>E?f.localDocuments.getDocuments(v,E):$.resolve(null)))))})(i.localStore,e);o!==null?(t==="pending"?await dl(i.remoteStore):t==="acknowledged"||t==="rejected"?(uy(i,e,r||null),ly(i,e),(function(u,d){pe(pe(u).mutationQueue).ir(d)})(i.localStore,e)):ye(6720,"Unknown batchState",{Su:t}),await Ei(i,o)):se(Is,"Cannot apply mutation batch with id: "+e)}async function B4(n,e){const t=pe(n);if(Xh(t),dy(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await eT(t,r.toArray());t.gu=!0,await zm(t.remoteStore,!0);for(const o of i)Yh(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((o,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then((()=>(Za(t,l),Qa(t.localStore,l,!0)))),Ya(t.remoteStore,l)})),await i,await eT(t,r),(function(l){const u=pe(l);u.Au.forEach(((d,f)=>{Ya(u.remoteStore,f)})),u.Ru.Jr(),u.Au=new Map,u.du=new ut(he.comparator)})(t),t.gu=!1,await zm(t.remoteStore,!1)}}async function eT(n,e,t){const r=pe(n),i=[],o=[];for(const l of e){let u;const d=r.Iu.get(l);if(d&&d.length!==0){u=await Ja(r.localStore,yn(d[0]));for(const f of d){const y=r.Tu.get(f),v=await F4(r,y);v.snapshot&&o.push(v.snapshot)}}else{const f=await NS(r.localStore,l);u=await Ja(r.localStore,f),await ay(r,QS(f),l,!1,u.resumeToken)}i.push(u)}return r.Pu.H_(o),i}function QS(n){return bI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function G4(n){return(function(t){return pe(pe(t).persistence).Ts()})(pe(n).localStore)}async function q4(n,e,t,r){const i=pe(n);if(i.gu)return void se(Is,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const l=await PS(i.localStore,MI(o[0])),u=oc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Tt.EMPTY_BYTE_STRING);await Ei(i,l,u);break}case"rejected":await Qa(i.localStore,e,!0),Za(i,e,r);break;default:ye(64155,t)}}async function z4(n,e,t){const r=Xh(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){se(Is,"Adding an already active target "+i);continue}const o=await NS(r.localStore,i),l=await Ja(r.localStore,o);await ay(r,QS(o),l.targetId,!1,l.resumeToken),Yh(r.remoteStore,l)}for(const i of t)r.Iu.has(i)&&await Qa(r.localStore,i,!1).then((()=>{Ya(r.remoteStore,i),Za(r,i)})).catch(ws)}}function Xh(n){const e=pe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=L4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=P4.bind(null,e),e.Pu.H_=v4.bind(null,e.eventManager),e.Pu.yu=_4.bind(null,e.eventManager),e}function dy(n){const e=pe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=k4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=b4.bind(null,e),e}function H4(n,e,t){const r=pe(n);(async function(o,l,u){try{const d=await l.getMetadata();if(await(function(S,N){const M=pe(S),k=Ct(N.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",(B=>M.Ii.getBundleMetadata(B,N.id))).then((B=>!!B&&B.createTime.compareTo(k)>=0))})(o.localStore,d))return await l.close(),u._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(d)),Promise.resolve(new Set);u._updateProgress(zS(d));const f=new E4(d,l.serializer);let y=await l.bu();for(;y;){const E=await f.Ga(y);E&&u._updateProgress(E),y=await l.bu()}const v=await f.ja(o.localStore);return await Ei(o,v.Ha,void 0),await(function(S,N){const M=pe(S);return M.persistence.runTransaction("Save bundle","readwrite",(k=>M.Ii.saveBundleMetadata(k,N)))})(o.localStore,d),u._completeWith(v.progress),Promise.resolve(v.Ja)}catch(d){return qr(Is,`Loading bundle failed with ${d}`),u._failWith(d),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return SS(this.persistence,new IS,e.initialUser,this.serializer)}Cu(e){return new Kg(Qh.mi,this.serializer)}Du(e){return new VS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ju.provider={build:()=>new ju};class $4 extends ju{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Te(this.persistence.referenceDelegate instanceof Th,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new vS(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?an.withCacheSize(this.cacheSizeBytes):an.DEFAULT;return new Kg((r=>Th.mi(r,t)),this.serializer)}}class YS extends ju{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await dy(this.xu.syncEngine),await dl(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return SS(this.persistence,new IS,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new vS(r,e.asyncQueue,t)}Mu(e,t){const r=new eL(t,this.persistence);return new ZV(e.asyncQueue,r)}Cu(e){const t=jg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?an.withCacheSize(this.cacheSizeBytes):an.DEFAULT;return new Wg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,LS(),Zd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new VS}}class K4 extends YS{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Zp&&(this.sharedClientState.syncEngine={Co:O4.bind(null,t),vo:q4.bind(null,t),Fo:z4.bind(null,t),Ts:G4.bind(null,t),Do:U4.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await B4(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=LS();if(!Zp.v(t))throw new re(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=jg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Zp(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ju{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ZE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=V4.bind(null,this.syncEngine),await zm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new y4})()}createDatastore(e){const t=lc(e.databaseInfo.databaseId),r=(function(o){return new ZF(o)})(e.databaseInfo);return(function(o,l,u,d){return new r4(o,l,u,d)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,l,u){return new s4(r,i,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>ZE(this.syncEngine,t,0)),(function(){return KE.v()?new KE:new JF})())}createSyncEngine(e,t){return(function(i,o,l,u,d,f,y){const v=new I4(i,o,l,u,d,f);return y&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=pe(t);se(Eo,"RemoteStore shutting down."),r.Ea.add(5),await cl(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ju.provider={build:()=>new Ju};function tT(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Zh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):At("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class W4{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Zt,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(r);return new w4(JSON.parse(i),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class j4{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new re(Y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,o){const l=pe(i),u={documents:o.map((v=>Ku(l.serializer,v)))},d=await l.Ho("BatchGetDocuments",l.serializer.databaseId,qe.emptyPath(),u,o.length),f=new Map;d.forEach((v=>{const E=oF(l.serializer,v);f.set(E.key.toString(),E)}));const y=[];return o.forEach((v=>{const E=f.get(v.toString());Te(!!E,55234,{key:v}),y.push(E)})),y})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ul(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=he.fromPath(r);this.mutations.push(new Lg(i,this.precondition(i)))})),await(async function(r,i){const o=pe(r),l={writes:i.map((u=>Wu(o.serializer,u)))};await o.Go("Commit",o.serializer.databaseId,qe.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ye(50498,{Gu:e.constructor.name});t=Re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new re(Y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Re.min())?yt.exists(!1):yt.updateTime(t):yt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Re.min()))throw new re(Y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yt.updateTime(t)}return yt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class J4{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.zu=r.maxAttempts,this.M_=new Xg(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new j4(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Yu(i)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!ec(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!WI(t)}return!1}}const ys="FirestoreClient";class Q4{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=$t.UNAUTHENTICATED,this.clientId=Tg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async l=>{se(ys,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(se(ys,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=fl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function tm(n,e){n.asyncQueue.verifyOperationInProgress(),se(ys,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await AS(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function nT(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hy(n);se(ys,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>jE(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>jE(e.remoteStore,i))),n._onlineComponents=e}async function hy(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){se(ys,"Using user provided OfflineComponentProvider");try{await tm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Y.FAILED_PRECONDITION||i.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;qr("Error using user provided cache. Falling back to memory cache: "+t),await tm(n,new ju)}}else se(ys,"Using default OfflineComponentProvider"),await tm(n,new $4(void 0));return n._offlineComponents}async function ef(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(se(ys,"Using user provided OnlineComponentProvider"),await nT(n,n._uninitializedComponentsProvider._online)):(se(ys,"Using default OnlineComponentProvider"),await nT(n,new Ju))),n._onlineComponents}function XS(n){return hy(n).then((e=>e.persistence))}function fy(n){return hy(n).then((e=>e.localStore))}function ZS(n){return ef(n).then((e=>e.remoteStore))}function py(n){return ef(n).then((e=>e.syncEngine))}function Y4(n){return ef(n).then((e=>e.datastore))}async function el(n){const e=await ef(n),t=e.eventManager;return t.onListen=S4.bind(null,e.syncEngine),t.onUnlisten=C4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=A4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=R4.bind(null,e.syncEngine),t}function X4(n){return n.asyncQueue.enqueue((async()=>{const e=await XS(n),t=await ZS(n);return e.setNetworkEnabled(!0),(function(i){const o=pe(i);return o.Ea.delete(0),uc(o)})(t)}))}function Z4(n){return n.asyncQueue.enqueue((async()=>{const e=await XS(n),t=await ZS(n);return e.setNetworkEnabled(!1),(async function(i){const o=pe(i);o.Ea.add(0),await cl(o),o.Ra.set("Offline")})(t)}))}function eU(n,e){const t=new Zt;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,o,l){try{const u=await(function(f,y){const v=pe(f);return v.persistence.runTransaction("read document","readonly",(E=>v.localDocuments.getDocument(E,y)))})(i,o);u.isFoundDocument()?l.resolve(u):u.isNoDocument()?l.resolve(null):l.reject(new re(Y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const d=fl(u,`Failed to get document '${o} from cache`);l.reject(d)}})(await fy(n),e,t))),t.promise}function eA(n,e,t={}){const r=new Zt;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,d,f){const y=new Zh({next:E=>{y.Nu(),l.enqueueAndForget((()=>iy(o,v)));const S=E.docs.has(u);!S&&E.fromCache?f.reject(new re(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&d&&d.source==="server"?f.reject(new re(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(E)},error:E=>f.reject(E)}),v=new oy(al(u.path),y,{includeMetadataChanges:!0,qa:!0});return ry(o,v)})(await el(n),n.asyncQueue,e,t,r))),r.promise}function tU(n,e){const t=new Zt;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,o,l){try{const u=await xh(i,o,!0),d=new KS(o,u.Qs),f=d.ru(u.documents),y=d.applyChanges(f,!1);l.resolve(y.snapshot)}catch(u){const d=fl(u,`Failed to execute query '${o} against cache`);l.reject(d)}})(await fy(n),e,t))),t.promise}function tA(n,e,t={}){const r=new Zt;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,d,f){const y=new Zh({next:E=>{y.Nu(),l.enqueueAndForget((()=>iy(o,v))),E.fromCache&&d.source==="server"?f.reject(new re(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(E)},error:E=>f.reject(E)}),v=new oy(u,y,{includeMetadataChanges:!0,qa:!0});return ry(o,v)})(await el(n),n.asyncQueue,e,t,r))),r.promise}function nU(n,e){const t=new Zh(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,o){pe(i).Ca.add(o),o.next()})(await el(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,o){pe(i).Ca.delete(o)})(await el(n),t)))}}function rU(n,e,t,r){const i=(function(l,u){let d;return d=typeof l=="string"?JI().encode(l):l,(function(y,v){return new W4(y,v)})((function(y,v){if(y instanceof Uint8Array)return tT(y,v);if(y instanceof ArrayBuffer)return tT(new Uint8Array(y),v);if(y instanceof ReadableStream)return y.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(d),u)})(t,lc(e));n.asyncQueue.enqueueAndForget((async()=>{H4(await py(n),i,r)}))}function iU(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const o=pe(r);return o.persistence.runTransaction("Get named query","readonly",(l=>o.Ii.getNamedQuery(l,i)))})(await fy(n),e)))}function nA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const rT=new Map;const rA="firestore.googleapis.com",iT=!0;class sT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rA,this.ssl=iT}else this.host=e.host,this.ssl=e.ssl??iT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SF)throw new re(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nA(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cc{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new GV;switch(r.type){case"firstParty":return new $V(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=rT.get(t);r&&(se("ComponentProvider","Removing Datastore"),rT.delete(t),r.terminate())})(this),Promise.resolve()}}function sU(n,e,t,r={}){n=Xe(n,cc);const i=fg(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;i&&(iM(`https://${u}`),lM("Firestore",!0)),o.host!==rA&&o.host!==u&&qr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:u,ssl:i,emulatorOptions:r};if(!Da(d,l)&&(n._setSettings(d),r.mockUserToken)){let f,y;if(typeof r.mockUserToken=="string")f=r.mockUserToken,y=$t.MOCK_USER;else{f=sM(r.mockUserToken,n._app?.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new re(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new $t(v)}n._authCredentials=new qV(new jx(f,y))}}let _n=class iA{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new iA(this.firestore,e,this._query)}},lt=class _u{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ls(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _u(this.firestore,e,this._key)}toJSON(){return{type:_u._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Zu(t,_u._jsonSchema))return new _u(e,r||null,new he(qe.fromString(t.referencePath)))}};lt._jsonSchemaVersion="firestore/documentReference/1.0",lt._jsonSchema={type:Vt("string",lt._jsonSchemaVersion),referencePath:Vt("string")};let ls=class sA extends _n{constructor(e,t,r){super(e,t,al(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new lt(this.firestore,null,new he(e))}withConverter(e){return new sA(this.firestore,e,this._path)}};function oA(n,e,...t){if(n=Lt(n),xg("collection","path",e),n instanceof cc){const r=qe.fromString(e,...t);return Ww(r),new ls(n,null,r)}{if(!(n instanceof lt||n instanceof ls))throw new re(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(qe.fromString(e,...t));return Ww(r),new ls(n.firestore,null,r)}}function oU(n,e){if(n=Xe(n,cc),xg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new re(Y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new _n(n,null,(function(r){return new vi(qe.emptyPath(),r)})(e))}function Ch(n,e,...t){if(n=Lt(n),arguments.length===1&&(e=Tg.newId()),xg("doc","path",e),n instanceof cc){const r=qe.fromString(e,...t);return Kw(r),new lt(n,null,new he(r))}{if(!(n instanceof lt||n instanceof ls))throw new re(Y.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(qe.fromString(e,...t));return Kw(r),new lt(n.firestore,n instanceof ls?n.converter:null,new he(r))}}function aA(n,e){return n=Lt(n),e=Lt(e),(n instanceof lt||n instanceof ls)&&(e instanceof lt||e instanceof ls)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function lA(n,e){return n=Lt(n),e=Lt(e),n instanceof _n&&e instanceof _n&&n.firestore===e.firestore&&rc(n._query,e._query)&&n.converter===e.converter}const oT="AsyncQueue";class aT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Xg(this,"async_queue_retry"),this._c=()=>{const r=Zd();r&&se(oT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Zd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Zd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Zt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Es(e))throw e;se(oT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,At("INTERNAL UNHANDLED ERROR: ",lT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=ny.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&ye(47125,{Pc:lT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function lT(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Km(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}class aU{constructor(){this._progressObserver={},this._taskCompletionResolver=new Zt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const lU=-1;let Nt=class extends cc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new aT,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aT(e),this._firestoreClient=void 0,await e}}};function dn(n){if(n._terminated)throw new re(Y.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||uA(n),n._firestoreClient}function uA(n){const e=n._freezeSettings(),t=(function(i,o,l,u){return new NL(i,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,nA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Q4(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}function uU(n,e){qr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return cA(n,Ju.provider,{build:r=>new YS(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function cU(n){qr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();cA(n,Ju.provider,{build:t=>new K4(t,e.cacheSizeBytes)})}function cA(n,e,t){if((n=Xe(n,Nt))._firestoreClient||n._terminated)throw new re(Y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new re(Y.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},uA(n)}function dU(n){if(n._initialized&&!n._terminated)throw new re(Y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Zt;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Or.v())return Promise.resolve();const i=r+xS;await Or.delete(i)})(jg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function hU(n){return(function(t){const r=new Zt;return t.asyncQueue.enqueueAndForget((async()=>D4(await py(t),r))),r.promise})(dn(n=Xe(n,Nt)))}function fU(n){return X4(dn(n=Xe(n,Nt)))}function pU(n){return Z4(dn(n=Xe(n,Nt)))}function mU(n,e){const t=dn(n=Xe(n,Nt)),r=new aU;return rU(t,n._databaseId,e,r),r}function gU(n,e){return iU(dn(n=Xe(n,Nt)),e).then((t=>t?new _n(n,null,t.query):null))}class ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ln(Tt.fromBase64String(e))}catch(t){throw new re(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ln(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zu(e,ln._jsonSchema))return ln.fromBase64String(e.bytes)}}ln._jsonSchemaVersion="firestore/bytes/1.0",ln._jsonSchema={type:Vt("string",ln._jsonSchemaVersion),bytes:Vt("string")};let vs=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new re(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let So=class{constructor(e){this._methodName=e}};class pr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new re(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new re(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pr._jsonSchemaVersion}}static fromJSON(e){if(Zu(e,pr._jsonSchema))return new pr(e.latitude,e.longitude)}}pr._jsonSchemaVersion="firestore/geoPoint/1.0",pr._jsonSchema={type:Vt("string",pr._jsonSchemaVersion),latitude:Vt("number"),longitude:Vt("number")};class Gr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Gr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zu(e,Gr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Gr(e.vectorValues);throw new re(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Gr._jsonSchemaVersion="firestore/vectorValue/1.0",Gr._jsonSchema={type:Vt("string",Gr._jsonSchemaVersion),vectorValues:Vt("object")};const yU=/^__.*__$/;class vU{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new wi(e,this.data,this.fieldMask,t,this.fieldTransforms):new ll(e,this.data,t,this.fieldTransforms)}}class dA{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new wi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{Ac:n})}}class tf{constructor(e,t,r,i,o,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new tf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(hA(this.Ac)&&yU.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class _U{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||lc(e)}Cc(e,t,r,i=!1){return new tf({Ac:e,methodName:t,Dc:r,path:gt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ao(n){const e=n._freezeSettings(),t=lc(n._databaseId);return new _U(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nf(n,e,t,r,i,o={}){const l=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);Ey("Data must be an object, but it was:",l,r);const u=mA(r,l);let d,f;if(o.merge)d=new Cn(l.fieldMask),f=l.fieldTransforms;else if(o.mergeFields){const y=[];for(const v of o.mergeFields){const E=Wm(e,v,t);if(!l.contains(E))throw new re(Y.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);yA(y,E)||y.push(E)}d=new Cn(y),f=l.fieldTransforms.filter((v=>d.covers(v.field)))}else d=null,f=l.fieldTransforms;return new vU(new Xt(u),d,f)}class dc extends So{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dc}}function fA(n,e,t){return new tf({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class my extends So{_toFieldTransform(e){return new sc(e.path,new Ka)}isEqual(e){return e instanceof my}}class gy extends So{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=fA(this,e,!0),r=this.vc.map((o=>Co(o,t))),i=new go(r);return new sc(e.path,i)}isEqual(e){return e instanceof gy&&Da(this.vc,e.vc)}}class yy extends So{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=fA(this,e,!0),r=this.vc.map((o=>Co(o,t))),i=new yo(r);return new sc(e.path,i)}isEqual(e){return e instanceof yy&&Da(this.vc,e.vc)}}class vy extends So{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Wa(e.serializer,BI(e.serializer,this.Fc));return new sc(e.path,t)}isEqual(e){return e instanceof vy&&this.Fc===e.Fc}}function _y(n,e,t,r){const i=n.Cc(1,e,t);Ey("Data must be an object, but it was:",i,r);const o=[],l=Xt.empty();Ts(r,((d,f)=>{const y=Ty(e,d,t);f=Lt(f);const v=i.yc(y);if(f instanceof dc)o.push(y);else{const E=Co(f,v);E!=null&&(o.push(y),l.set(y,E))}}));const u=new Cn(o);return new dA(l,u,i.fieldTransforms)}function wy(n,e,t,r,i,o){const l=n.Cc(1,e,t),u=[Wm(e,r,t)],d=[i];if(o.length%2!=0)throw new re(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)u.push(Wm(e,o[E])),d.push(o[E+1]);const f=[],y=Xt.empty();for(let E=u.length-1;E>=0;--E)if(!yA(f,u[E])){const S=u[E];let N=d[E];N=Lt(N);const M=l.yc(S);if(N instanceof dc)f.push(S);else{const k=Co(N,M);k!=null&&(f.push(S),y.set(S,k))}}const v=new Cn(f);return new dA(y,v,l.fieldTransforms)}function pA(n,e,t,r=!1){return Co(t,n.Cc(r?4:3,e))}function Co(n,e){if(gA(n=Lt(n)))return Ey("Unsupported field value:",e,n),mA(n,e);if(n instanceof So)return(function(r,i){if(!hA(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const o=[];let l=0;for(const u of r){let d=Co(u,i.wc(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return BI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=nt.fromDate(r);return{timestampValue:ja(i.serializer,o)}}if(r instanceof nt){const o=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ja(i.serializer,o)}}if(r instanceof pr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ln)return{bytesValue:XI(i.serializer,r._byteString)};if(r instanceof lt){const o=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(o))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Gg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Gr)return(function(l,u){return{mapValue:{fields:{[Pg]:{stringValue:kg},[za]:{arrayValue:{values:l.toArray().map((f=>{if(typeof f!="number")throw u.Sc("VectorValues must only contain numeric values.");return Vg(u.serializer,f)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Uh(r)}`)})(n,e)}function mA(n,e){const t={};return mI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ts(n,((r,i)=>{const o=Co(i,e.mc(r));o!=null&&(t[r]=o)})),{mapValue:{fields:t}}}function gA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof pr||n instanceof ln||n instanceof lt||n instanceof So||n instanceof Gr)}function Ey(n,e,t){if(!gA(t)||!Yx(t)){const r=Uh(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Wm(n,e,t){if((e=Lt(e))instanceof vs)return e._internalPath;if(typeof e=="string")return Ty(n,e);throw Rh("Field path arguments must be of type string or ",n,!1,void 0,t)}const wU=new RegExp("[~\\*/\\[\\]]");function Ty(n,e,t){if(e.search(wU)>=0)throw Rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vs(...e.split("."))._internalPath}catch{throw Rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rh(n,e,t,r,i){const o=r&&!r.isEmpty(),l=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${r}`),l&&(d+=` in document ${i}`),d+=")"),new re(Y.INVALID_ARGUMENT,u+n+d)}function yA(n,e){return n.some((t=>t.isEqual(e)))}class Qu{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new EU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class EU extends Qu{data(){return super.data()}}function rf(n,e){return typeof e=="string"?Ty(n,e):e instanceof vs?e._internalPath:e._delegate._internalPath}function vA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new re(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xy{}class hc extends xy{}function ts(n,e,...t){let r=[];e instanceof xy&&r.push(e),r=r.concat(t),(function(o){const l=o.filter((d=>d instanceof Iy)).length,u=o.filter((d=>d instanceof sf)).length;if(l>1||l>0&&u>0)throw new re(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class sf extends hc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new sf(e,t,r)}_apply(e){const t=this._parse(e);return wA(e._query,t),new _n(e.firestore,e.converter,Dm(e._query,t))}_parse(e){const t=Ao(e.firestore);return(function(o,l,u,d,f,y,v){let E;if(f.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new re(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){cT(v,y);const N=[];for(const M of v)N.push(uT(d,o,M));E={arrayValue:{values:N}}}else E=uT(d,o,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||cT(v,y),E=pA(u,l,v,y==="in"||y==="not-in");return ze.create(f,y,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function TU(n,e,t){const r=e,i=rf("where",n);return sf._create(i,r,t)}class Iy extends xy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Iy(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:it.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let l=i;const u=o.getFlattenedFilters();for(const d of u)wA(l,d),l=Dm(l,d)})(e._query,t),new _n(e.firestore,e.converter,Dm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Sy extends hc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Sy(e,t)}_apply(e){const t=(function(i,o,l){if(i.startAt!==null)throw new re(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new re(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $u(o,l)})(e._query,this._field,this._direction);return new _n(e.firestore,e.converter,(function(i,o){const l=i.explicitOrderBy.concat([o]);return new vi(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function xU(n,e="asc"){const t=e,r=rf("orderBy",n);return Sy._create(r,t)}class of extends hc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new of(e,t,r)}_apply(e){return new _n(e.firestore,e.converter,vh(e._query,this._limit,this._limitType))}}function IU(n){return Xx("limit",n),of._create("limit",n,"F")}function SU(n){return Xx("limitToLast",n),of._create("limitToLast",n,"L")}class af extends hc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new af(e,t,r)}_apply(e){const t=_A(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,(function(i,o){return new vi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)})(e._query,t))}}function AU(...n){return af._create("startAt",n,!0)}function CU(...n){return af._create("startAfter",n,!1)}class lf extends hc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new lf(e,t,r)}_apply(e){const t=_A(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,(function(i,o){return new vi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)})(e._query,t))}}function RU(...n){return lf._create("endBefore",n,!1)}function NU(...n){return lf._create("endAt",n,!0)}function _A(n,e,t,r){if(t[0]=Lt(t[0]),t[0]instanceof Qu)return(function(o,l,u,d,f){if(!d)throw new re(Y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const y=[];for(const v of Pa(o))if(v.field.isKeyField())y.push(po(l,d.key));else{const E=d.data.field(v.field);if(zh(E))throw new re(Y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const S=v.field.canonicalString();throw new re(Y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}y.push(E)}return new ms(y,f)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Ao(n.firestore);return(function(l,u,d,f,y,v){const E=l.explicitOrderBy;if(y.length>E.length)throw new re(Y.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let N=0;N<y.length;N++){const M=y[N];if(E[N].field.isKeyField()){if(typeof M!="string")throw new re(Y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!Dg(l)&&M.indexOf("/")!==-1)throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const k=l.path.child(qe.fromString(M));if(!he.isDocumentKey(k))throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);const B=new he(k);S.push(po(u,B))}else{const k=pA(d,f,M);S.push(k)}}return new ms(S,v)})(n._query,n.firestore._databaseId,i,e,t,r)}}function uT(n,e,t){if(typeof(t=Lt(t))=="string"){if(t==="")throw new re(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dg(e)&&t.indexOf("/")!==-1)throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(qe.fromString(t));if(!he.isDocumentKey(r))throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return po(n,new he(r))}if(t instanceof lt)return po(n,t._key);throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Uh(t)}.`)}function cT(n,e){if(!Array.isArray(n)||n.length===0)throw new re(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wA(n,e){const t=(function(i,o){for(const l of i)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new re(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Ay{convertValue(e,t="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ts(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){const t=e.fields?.[za].arrayValue?.values?.map((r=>mt(r.doubleValue)));return new Gr(t)}convertGeoPoint(e){return new pr(mt(e.latitude),mt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(qu(e));default:return null}}convertTimestamp(e){const t=pi(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=qe.fromString(e);Te(uS(r),9688,{name:e});const i=new hs(r.get(1),r.get(3)),o=new he(r.popFirst(5));return i.isEqual(t)||At(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function uf(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class PU extends Ay{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new lt(this.firestore,null,t)}}class uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Zn=class EA extends Qu{constructor(e,t,r,i,o,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(rf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=EA._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Zn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zn._jsonSchema={type:Vt("string",Zn._jsonSchemaVersion),bundleSource:Vt("string","DocumentSnapshot"),bundleName:Vt("string"),bundle:Vt("string")};let ku=class extends Zn{data(e={}){return super.data(e)}},mr=class TA{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new uo(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new ku(this._firestore,this._userDataWriter,r.key,r,new uo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new re(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const d=new ku(i._firestore,i._userDataWriter,u.doc.key,u.doc,new uo(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const d=new ku(i._firestore,i._userDataWriter,u.doc.key,u.doc,new uo(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,y=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),y=l.indexOf(u.doc.key)),{type:kU(u.type),doc:d,oldIndex:f,newIndex:y}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=TA._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function kU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:n})}}function xA(n,e){return n instanceof Zn&&e instanceof Zn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof mr&&e instanceof mr&&n._firestore===e._firestore&&lA(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function bU(n){n=Xe(n,lt);const e=Xe(n.firestore,Nt);return eA(dn(e),n._key).then((t=>Cy(e,n,t)))}mr._jsonSchemaVersion="firestore/querySnapshot/1.0",mr._jsonSchema={type:Vt("string",mr._jsonSchemaVersion),bundleSource:Vt("string","QuerySnapshot"),bundleName:Vt("string"),bundle:Vt("string")};class Ro extends Ay{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new lt(this.firestore,null,t)}}function DU(n){n=Xe(n,lt);const e=Xe(n.firestore,Nt),t=dn(e),r=new Ro(e);return eU(t,n._key).then((i=>new Zn(e,r,n._key,i,new uo(i!==null&&i.hasLocalMutations,!0),n.converter)))}function MU(n){n=Xe(n,lt);const e=Xe(n.firestore,Nt);return eA(dn(e),n._key,{source:"server"}).then((t=>Cy(e,n,t)))}function VU(n){n=Xe(n,_n);const e=Xe(n.firestore,Nt),t=dn(e),r=new Ro(e);return vA(n._query),tA(t,n._query).then((i=>new mr(e,r,n,i)))}function LU(n){n=Xe(n,_n);const e=Xe(n.firestore,Nt),t=dn(e),r=new Ro(e);return tU(t,n._query).then((i=>new mr(e,r,n,i)))}function FU(n){n=Xe(n,_n);const e=Xe(n.firestore,Nt),t=dn(e),r=new Ro(e);return tA(t,n._query,{source:"server"}).then((i=>new mr(e,r,n,i)))}function dT(n,e,t){n=Xe(n,lt);const r=Xe(n.firestore,Nt),i=uf(n.converter,e,t);return fc(r,[nf(Ao(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,yt.none())])}function hT(n,e,t,...r){n=Xe(n,lt);const i=Xe(n.firestore,Nt),o=Ao(i);let l;return l=typeof(e=Lt(e))=="string"||e instanceof vs?wy(o,"updateDoc",n._key,e,t,r):_y(o,"updateDoc",n._key,e),fc(i,[l.toMutation(n._key,yt.exists(!0))])}function UU(n){return fc(Xe(n.firestore,Nt),[new ul(n._key,yt.none())])}function OU(n,e){const t=Xe(n.firestore,Nt),r=Ch(n),i=uf(n.converter,e);return fc(t,[nf(Ao(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,yt.exists(!1))]).then((()=>r))}function IA(n,...e){n=Lt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Km(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Km(e[r])){const d=e[r];e[r]=d.next?.bind(d),e[r+1]=d.error?.bind(d),e[r+2]=d.complete?.bind(d)}let o,l,u;if(n instanceof lt)l=Xe(n.firestore,Nt),u=al(n._key.path),o={next:d=>{e[r]&&e[r](Cy(l,n,d))},error:e[r+1],complete:e[r+2]};else{const d=Xe(n,_n);l=Xe(d.firestore,Nt),u=d._query;const f=new Ro(l);o={next:y=>{e[r]&&e[r](new mr(l,f,d,y))},error:e[r+1],complete:e[r+2]},vA(n._query)}return(function(f,y,v,E){const S=new Zh(E),N=new oy(y,S,v);return f.asyncQueue.enqueueAndForget((async()=>ry(await el(f),N))),()=>{S.Nu(),f.asyncQueue.enqueueAndForget((async()=>iy(await el(f),N)))}})(dn(l),u,i,o)}function BU(n,e){return nU(dn(n=Xe(n,Nt)),Km(e)?e:{next:e})}function fc(n,e){return(function(r,i){const o=new Zt;return r.asyncQueue.enqueueAndForget((async()=>N4(await py(r),i,o))),o.promise})(dn(n),e)}function Cy(n,e,t){const r=t.docs.get(e._key),i=new Ro(n);return new Zn(n,i,e._key,r,new uo(t.hasPendingWrites,t.fromCache),e.converter)}const GU={maxAttempts:5};let qU=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ao(e)}set(e,t,r){this._verifyNotCommitted();const i=is(e,this._firestore),o=uf(i.converter,t,r),l=nf(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(l.toMutation(i._key,yt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const o=is(e,this._firestore);let l;return l=typeof(t=Lt(t))=="string"||t instanceof vs?wy(this._dataReader,"WriteBatch.update",o._key,t,r,i):_y(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(l.toMutation(o._key,yt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=is(e,this._firestore);return this._mutations=this._mutations.concat(new ul(t._key,yt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new re(Y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function is(n,e){if((n=Lt(n)).firestore!==e)throw new re(Y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class zU{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ao(e)}get(e){const t=is(e,this._firestore),r=new PU(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return ye(24041);const o=i[0];if(o.isFoundDocument())return new Qu(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new Qu(this._firestore,r,t._key,null,t.converter);throw ye(18433,{doc:o})}))}set(e,t,r){const i=is(e,this._firestore),o=uf(i.converter,t,r),l=nf(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const o=is(e,this._firestore);let l;return l=typeof(t=Lt(t))=="string"||t instanceof vs?wy(this._dataReader,"Transaction.update",o._key,t,r,i):_y(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,l),this}delete(e){const t=is(e,this._firestore);return this._transaction.delete(t._key),this}}let HU=class extends zU{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=is(e,this._firestore),r=new Ro(this._firestore);return super.get(e).then((i=>new Zn(this._firestore,r,t._key,i._document,new uo(!1,!1),t.converter)))}};function $U(n,e,t){n=Xe(n,Nt);const r={...GU,...t};return(function(o){if(o.maxAttempts<1)throw new re(Y.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(o,l,u){const d=new Zt;return o.asyncQueue.enqueueAndForget((async()=>{const f=await Y4(o);new J4(o.asyncQueue,f,u,l,d).ju()})),d.promise})(dn(n),(i=>e(new HU(n,i))),r)}function KU(){return new dc("deleteField")}function WU(){return new my("serverTimestamp")}function jU(...n){return new gy("arrayUnion",n)}function JU(...n){return new yy("arrayRemove",n)}function QU(n){return new vy("increment",n)}(function(e,t=!0){(function(i){ol=i})(vg),La(new fo("firestore",((r,{instanceIdentifier:i,options:o})=>{const l=r.getProvider("app").getImmediate(),u=new Nt(new zV(r.getProvider("auth-internal")),new KV(l,r.getProvider("app-check-internal")),(function(f,y){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new re(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(f.options.projectId,y)})(l,i),l);return o={useFetchStreams:t,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),di(qw,zw,e),di(qw,zw,"esm2020")})();const YU="@firebase/firestore-compat",XU="0.4.3";function Ry(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new re("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function fT(){if(typeof Uint8Array>"u")throw new re("unimplemented","Uint8Arrays are not available in this environment.")}function pT(){if(!CL())throw new re("unimplemented","Blobs are unavailable in Firestore in this environment.")}let SA=class jm{constructor(e){this._delegate=e}static fromBase64String(e){return pT(),new jm(ln.fromBase64String(e))}static fromUint8Array(e){return fT(),new jm(ln.fromUint8Array(e))}toBase64(){return pT(),this._delegate.toBase64()}toUint8Array(){return fT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Jm(n){return ZU(n,["next","error","complete"])}function ZU(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class e3{enableIndexedDbPersistence(e,t){return uU(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return cU(e._delegate)}clearIndexedDbPersistence(e){return dU(e._delegate)}}class AA{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof hs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&qr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sU(this._delegate,e,t,r)}enableNetwork(){return fU(this._delegate)}disableNetwork(){return pU(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Qx("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return hU(this._delegate)}onSnapshotsInSync(e){return BU(this._delegate,e)}get app(){if(!this._appCompat)throw new re("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new tl(this,oA(this._delegate,e))}catch(t){throw gn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Yn(this,Ch(this._delegate,e))}catch(t){throw gn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mn(this,oU(this._delegate,e))}catch(t){throw gn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return $U(this._delegate,t=>e(new CA(this,t)))}batch(){return dn(this._delegate),new RA(new qU(this._delegate,e=>fc(this._delegate,e)))}loadBundle(e){return mU(this._delegate,e)}namedQuery(e){return gU(this._delegate,e).then(t=>t?new mn(this,t):null)}}class cf extends Ay{constructor(e){super(),this.firestore=e}convertBytes(e){return new SA(new ln(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Yn.forKey(t,this.firestore,null)}}function t3(n){OV(n)}class CA{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new cf(e)}get(e){const t=co(e);return this._delegate.get(t).then(r=>new Yu(this._firestore,new Zn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=co(e);return r?(Ry("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=co(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=co(e);return this._delegate.delete(t),this}}class RA{constructor(e){this._delegate=e}set(e,t,r){const i=co(e);return r?(Ry("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=co(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=co(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class To{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new ku(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xu(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=To.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new To(e,new cf(e),t),i.set(t,o)),o}}To.INSTANCES=new WeakMap;class Yn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cf(e)}static forPath(e,t,r){if(e.length%2!==0)throw new re("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Yn(t,new lt(t._delegate,r,new he(e)))}static forKey(e,t,r){return new Yn(t,new lt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new tl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new tl(this.firestore,oA(this._delegate,e))}catch(t){throw gn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Lt(e),e instanceof lt?aA(this._delegate,e):!1}set(e,t){t=Ry("DocumentReference.set",t);try{return t?dT(this._delegate,e,t):dT(this._delegate,e)}catch(r){throw gn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?hT(this._delegate,e):hT(this._delegate,e,t,...r)}catch(i){throw gn(i,"updateDoc()","DocumentReference.update()")}}delete(){return UU(this._delegate)}onSnapshot(...e){const t=NA(e),r=PA(e,i=>new Yu(this.firestore,new Zn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return IA(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=DU(this._delegate):e?.source==="server"?t=MU(this._delegate):t=bU(this._delegate),t.then(r=>new Yu(this.firestore,new Zn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Yn(this.firestore,e?this._delegate.withConverter(To.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function gn(n,e,t){return n.message=n.message.replace(e,t),n}function NA(n){for(const e of n)if(typeof e=="object"&&!Jm(e))return e;return{}}function PA(n,e){let t;return Jm(n[0])?t=n[0]:Jm(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Yu{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Yn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return xA(this._delegate,e._delegate)}}class Xu extends Yu{data(e){const t=this._delegate.data(e);return this._delegate._converter||BV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class mn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cf(e)}where(e,t,r){try{return new mn(this.firestore,ts(this._delegate,TU(e,t,r)))}catch(i){throw gn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new mn(this.firestore,ts(this._delegate,xU(e,t)))}catch(r){throw gn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new mn(this.firestore,ts(this._delegate,IU(e)))}catch(t){throw gn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new mn(this.firestore,ts(this._delegate,SU(e)))}catch(t){throw gn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new mn(this.firestore,ts(this._delegate,AU(...e)))}catch(t){throw gn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new mn(this.firestore,ts(this._delegate,CU(...e)))}catch(t){throw gn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new mn(this.firestore,ts(this._delegate,RU(...e)))}catch(t){throw gn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new mn(this.firestore,ts(this._delegate,NU(...e)))}catch(t){throw gn(t,"endAt()","Query.endAt()")}}isEqual(e){return lA(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=LU(this._delegate):e?.source==="server"?t=FU(this._delegate):t=VU(this._delegate),t.then(r=>new Qm(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=NA(e),r=PA(e,i=>new Qm(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return IA(this._delegate,t,r)}withConverter(e){return new mn(this.firestore,e?this._delegate.withConverter(To.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class n3{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Xu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Qm{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new mn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Xu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new n3(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Xu(this._firestore,r))})}isEqual(e){return xA(this._delegate,e._delegate)}}class tl extends mn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Yn(this.firestore,e):null}doc(e){try{return e===void 0?new Yn(this.firestore,Ch(this._delegate)):new Yn(this.firestore,Ch(this._delegate,e))}catch(t){throw gn(t,"doc()","CollectionReference.doc()")}}add(e){return OU(this._delegate,e).then(t=>new Yn(this.firestore,t))}isEqual(e){return aA(this._delegate,e._delegate)}withConverter(e){return new tl(this.firestore,e?this._delegate.withConverter(To.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function co(n){return Xe(n,lt)}class Ny{constructor(...e){this._delegate=new vs(...e)}static documentId(){return new Ny(gt.keyField().canonicalString())}isEqual(e){return e=Lt(e),e instanceof vs?this._delegate._internalPath.isEqual(e._internalPath):!1}}class ao{static serverTimestamp(){const e=WU();return e._methodName="FieldValue.serverTimestamp",new ao(e)}static delete(){const e=KU();return e._methodName="FieldValue.delete",new ao(e)}static arrayUnion(...e){const t=jU(...e);return t._methodName="FieldValue.arrayUnion",new ao(t)}static arrayRemove(...e){const t=JU(...e);return t._methodName="FieldValue.arrayRemove",new ao(t)}static increment(e){const t=QU(e);return t._methodName="FieldValue.increment",new ao(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const r3={Firestore:AA,GeoPoint:pr,Timestamp:nt,Blob:SA,Transaction:CA,WriteBatch:RA,DocumentReference:Yn,DocumentSnapshot:Yu,Query:mn,QueryDocumentSnapshot:Xu,QuerySnapshot:Qm,CollectionReference:tl,FieldPath:Ny,FieldValue:ao,setLogLevel:t3,CACHE_SIZE_UNLIMITED:lU};function i3(n,e){n.INTERNAL.registerComponent(new fo("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...r3}))}function s3(n){i3(n,(e,t)=>new AA(e,t,new e3)),n.registerVersion(YU,XU)}s3(Tu);const o3=["AIzaSyCdu","-FAv6bQiaFJGZdescMJJKcq7a8vre8"],a3={apiKey:o3.join(""),authDomain:"pastillo-app.firebaseapp.com",projectId:"pastillo-app",storageBucket:"pastillo-app.firebasestorage.app",messagingSenderId:"382249192976",appId:"1:382249192976:web:de235ec9d612324ca68495",measurementId:"G-SFE0D0Z1ZW"},l3=Tu.apps.length===0?Tu.initializeApp(a3):Tu.app(),Rt=l3.firestore();try{Rt.settings({experimentalForceLongPolling:!0})}catch{}Rt.enablePersistence({synchronizeTabs:!0}).catch(n=>{n.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):n.code==="unimplemented"&&console.warn("The current browser doesn't support all of the features needed to enable persistence.")});const df="reservations",eh="turnover",kA="expenses",Ym="settings",nl="personnel",u3=n=>Rt.collection(Ym).doc("main").onSnapshot(e=>{if(e.exists)n(e.data());else{const t={restaurantName:"Pastillo Butzbach",address:"Marktplatz 23, 35510 Butzbach",phone:"06033 974 7771",openingHours:"11:00 - 23:00",closedDay:"Sal: Kapal",adminPin:"0000",maxCapacityPerSlot:20,holidays:[],managerEmail:"info@pastillo.de"};Rt.collection(Ym).doc("main").set(t),n(t)}}),c3=async n=>{await Rt.collection(Ym).doc("main").update(n)},d3=async n=>{try{const e=await Rt.collection(df).add({...n,createdAt:Date.now()});return console.log(`Notification: New Reservation for ${n.name} on ${n.date} at ${n.time}. Emailing info@pastillo.de...`),e.id}catch(e){throw console.error("Error adding reservation: ",e),e}},h3=n=>Rt.collection(df).orderBy("createdAt","desc").onSnapshot(e=>{const t=e.docs.map(r=>({id:r.id,...r.data()}));n(t)}),f3=async(n,e)=>{await Rt.collection(df).doc(n).update({status:e})},p3=async n=>{await Rt.collection(df).doc(n).delete()},m3=async n=>{const e=await Rt.collection(eh).where("date","==",n.date).get();e.empty?await Rt.collection(eh).add({...n,createdAt:Date.now()}):await Rt.collection(eh).doc(e.docs[0].id).update({...n,createdAt:Date.now()})},g3=n=>Rt.collection(eh).orderBy("date","desc").onSnapshot(e=>{n(e.docs.map(t=>({id:t.id,...t.data()})))}),y3=async n=>{await Rt.collection(kA).add({...n,createdAt:Date.now()})},v3=n=>Rt.collection(kA).orderBy("createdAt","desc").onSnapshot(e=>{n(e.docs.map(t=>({id:t.id,...t.data()})))}),_3=n=>Rt.collection(nl).onSnapshot(e=>{n(e.docs.map(t=>({id:t.id,...t.data()})))}),w3=async n=>{await Rt.collection(nl).add({...n,payments:[]})},E3=async(n,e)=>{await Rt.collection(nl).doc(n).update(e)},T3=async n=>{await Rt.collection(nl).doc(n).delete()},x3=async(n,e)=>{const t=await Rt.collection(nl).doc(n).get();if(t.exists){const r=t.data(),i={...e,id:Math.random().toString()};await Rt.collection(nl).doc(n).update({payments:[...r.payments||[],i]})}},I3=({onSave:n,lang:e})=>{const[t,r]=_e.useState("ciro"),[i,o]=_e.useState(!1),[l,u]=_e.useState(!1),d=_e.useRef(null),f={tr:{turnover:"GNLK CRO",expense:"GDER EKLE",cash:"Nakit Ciro",card:"Kredi Kart Ciro",lieferando:"Lieferando",save:"KAYDET",scan:"Taramay Balat (AI)",analyzing:"AI Analiz Ediyor...",amount:"Tutar",category:"Kategori",desc:"Aklama",add:"GDER EKLE",catOptions:["Maa/Avans","Tedariki","Kira/Fatura","Vergi","Dier"],fileHint:"Resim veya PDF"},de:{turnover:"TAGESUMSATZ",expense:"AUSGABE HINZUFGEN",cash:"Bargeldumsatz",card:"Kartenzahlung",lieferando:"Lieferando",save:"SPEICHERN",scan:"Scan starten (KI)",analyzing:"KI analysiert...",amount:"Betrag",category:"Kategorie",desc:"Beschreibung",add:"HINZFGEN",catOptions:["Gehalt/Vorschuss","Lieferant","Miete/Nebenkosten","Steuer","Sonstiges"],fileHint:"Bild oder PDF"},en:{turnover:"DAILY TURNOVER",expense:"ADD EXPENSE",cash:"Cash Turnover",card:"Credit Card Turnover",lieferando:"Lieferando",save:"SAVE",scan:"Start Scan (AI)",analyzing:"AI Analyzing...",amount:"Amount",category:"Category",desc:"Description",add:"ADD EXPENSE",catOptions:["Salary/Advance","Supplier","Rent/Bills","Tax","Other"],fileHint:"Image or PDF"},es:{turnover:"VOLUMEN DIARIO",expense:"AADIR GASTO",cash:"Efectivo",card:"Tarjeta",lieferando:"Lieferando",save:"GUARDAR",scan:"Iniciar Escaneo (IA)",analyzing:"IA Analizando...",amount:"Monto",category:"Categora",desc:"Descripcin",add:"AADIR GASTO",catOptions:["Salario/Adelanto","Proveedor","Alquiler/Facturas","Impuestos","Otros"],fileHint:"Imagen o PDF"}},y=f[e]||f.de,[v,E]=_e.useState({cash:"",card:"",lieferando:""}),[S,N]=_e.useState({amount:"",description:"",category:y.catOptions[0]}),M=async()=>{u(!0);const q=new Date().toISOString().split("T")[0],H=parseFloat(v.cash)||0,ee=parseFloat(v.card)||0,te=parseFloat(v.lieferando)||0;await m3({date:q,cash:H,creditCard:ee,lieferando:te,total:H+ee+te}),u(!1),n()},k=async()=>{u(!0);const q=new Date().toISOString().split("T")[0];await y3({date:q,amount:parseFloat(S.amount)||0,description:S.description,category:S.category}),u(!1),n()},B=async q=>{const H=q.target.files?.[0];if(!H)return;o(!0);const ee=H.type||"image/jpeg",te=new FileReader;te.onloadend=async()=>{const j=te.result.split(",")[1],b=await jD(j,ee,e);b&&N({...S,amount:b.totalAmount.toString(),description:b.description,category:b.category}),o(!1)},te.readAsDataURL(H)};return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex bg-white/5 p-1.5 rounded-[2rem] border border-white/10",children:[w.jsx("button",{onClick:()=>r("ciro"),className:`flex-1 py-4 rounded-[1.8rem] text-[11px] font-black tracking-widest transition-all ${t==="ciro"?"bg-primary text-black":"text-white/30"}`,children:y.turnover}),w.jsx("button",{onClick:()=>r("gider"),className:`flex-1 py-4 rounded-[1.8rem] text-[11px] font-black tracking-widest transition-all ${t==="gider"?"bg-primary text-black":"text-white/30"}`,children:y.expense})]}),t==="ciro"?w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"glass p-8 rounded-[2.5rem] border border-white/5 space-y-8",children:[w.jsxs("div",{className:"space-y-3",children:[w.jsxs("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.3em] flex items-center gap-2",children:[w.jsx(eg,{size:12})," ",y.cash]}),w.jsx("input",{type:"number",placeholder:"0.00",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-6 px-6 text-4xl font-black text-white focus:outline-none",value:v.cash,onChange:q=>E({...v,cash:q.target.value})})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.3em] flex items-center gap-2",children:[w.jsx(xT,{size:12,className:"text-orange-400"})," ",y.lieferando]}),w.jsx("input",{type:"number",placeholder:"0.00",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-6 px-6 text-4xl font-black text-orange-400 focus:outline-none",value:v.lieferando,onChange:q=>E({...v,lieferando:q.target.value})})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.3em] flex items-center gap-2",children:[w.jsx(_T,{size:12})," ",y.card]}),w.jsx("input",{type:"number",placeholder:"0.00",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-6 px-6 text-4xl font-black text-white focus:outline-none",value:v.card,onChange:q=>E({...v,card:q.target.value})})]})]}),w.jsxs("button",{onClick:M,disabled:l,className:"w-full bg-primary text-black py-6 rounded-3xl font-black text-lg shadow-xl active:scale-95 transition-all flex justify-center items-center gap-2",children:[l?w.jsx(wu,{className:"animate-spin"}):w.jsx(A1,{size:24})," ",y.save]})]}):w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"glass p-8 rounded-[2.5rem] border border-white/5 space-y-6",children:[w.jsx("button",{onClick:()=>d.current?.click(),disabled:i,className:"w-full bg-white/5 border-2 border-dashed border-white/10 rounded-3xl py-12 flex flex-col items-center justify-center gap-4 active:bg-white/10 transition-colors",children:i?w.jsx(wu,{className:"animate-spin text-primary",size:40}):w.jsxs("div",{className:"flex flex-col items-center gap-2",children:[w.jsxs("div",{className:"flex gap-2 text-primary",children:[w.jsx(Zm,{size:32}),w.jsx(h1,{size:32})]}),w.jsx("span",{className:"text-xs font-black uppercase tracking-[0.2em] text-white/60",children:y.scan}),w.jsx("span",{className:"text-[9px] text-white/20 font-black uppercase tracking-widest",children:y.fileHint})]})}),w.jsx("input",{type:"file",accept:"image/*,application/pdf",capture:"environment",hidden:!0,ref:d,onChange:B}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest",children:y.amount}),w.jsx("input",{type:"number",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-black",value:S.amount,onChange:q=>N({...S,amount:q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest",children:y.category}),w.jsx("select",{className:"w-full bg-white/10 border border-white/10 rounded-2xl py-4 px-3 text-white text-xs font-black",value:S.category,onChange:q=>N({...S,category:q.target.value}),children:y.catOptions.map(q=>w.jsx("option",{value:q,children:q},q))})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest",children:y.desc}),w.jsx("input",{type:"text",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold",value:S.description,onChange:q=>N({...S,description:q.target.value})})]})]}),w.jsxs("button",{onClick:k,disabled:l,className:"w-full bg-white text-black py-6 rounded-3xl font-black text-lg shadow-xl active:scale-95 transition-all flex justify-center items-center gap-2",children:[l?w.jsx(wu,{className:"animate-spin"}):w.jsx(TT,{size:24})," ",y.add]})]})]})},S3=({lang:n,turnovers:e,expenses:t})=>{const[r,i]=gT.useState(!1),o={tr:{net:"Bugnk Net Kasa",income:"Gelir",expense:"Gider",cash:"Nakit",card:"Kredi Kart",lieferando:"Lieferando",recent:"Son Harcamalar",all:"TM",add:"LEM EKLE",export:"CSV AKTAR"},de:{net:"Netto-Kasse Heute",income:"Einnahmen",expense:"Ausgaben",cash:"Bargeld",card:"Kreditkarte",lieferando:"Lieferando",recent:"Letzte Ausgaben",all:"ALLE",add:"BUCHUNG ERFASSEN",export:"CSV EXPORT"},en:{net:"Today's Net Cash",income:"Income",expense:"Expenses",cash:"Cash",card:"Credit Card",lieferando:"Lieferando",recent:"Recent Expenses",all:"ALL",add:"NEW ENTRY",export:"EXPORT CSV"},es:{net:"Caja Neta Hoy",income:"Ingresos",expense:"Gastos",cash:"Efectivo",card:"Tarjeta",lieferando:"Lieferando",recent:"Gastos Recientes",all:"TODO",add:"NUEVA ENTRADA",export:"EXPORTAR CSV"}},l=o[n]||o.de,u=()=>{const y=["Date","Type","Amount","Category","Description"],v=e.map(B=>[B.date,"Turnover",B.total,"Revenue",`Cash: ${B.cash}, Card: ${B.creditCard}`]),E=t.map(B=>[B.date,"Expense",B.amount,B.category,B.description]),S=[y,...v,...E].map(B=>B.join(",")).join(`
`),N=new Blob([S],{type:"text/csv;charset=utf-8;"}),M=URL.createObjectURL(N),k=document.createElement("a");k.setAttribute("href",M),k.setAttribute("download",`Pastillo_Finance_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(k),k.click(),document.body.removeChild(k)},d=new Date().toISOString().split("T")[0],f=_e.useMemo(()=>{const y=e.find(E=>E.date===d)||{cash:0,creditCard:0,lieferando:0,total:0},v=t.filter(E=>E.date===d).reduce((E,S)=>E+S.amount,0);return{income:y.total,cash:y.cash,card:y.creditCard,lieferando:y.lieferando||0,expenses:v,net:y.total-v}},[e,t,d]);return r?w.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-300",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("h2",{className:"text-xl font-black text-white",children:l.add}),w.jsx("button",{onClick:()=>i(!1),className:"p-2 bg-white/5 rounded-full",children:w.jsx(Mu,{size:16})})]}),w.jsx(I3,{lang:n,onSave:()=>i(!1)})]}):w.jsxs("div",{className:"space-y-6 pb-24",children:[w.jsx("div",{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/40 rounded-[2.5rem] p-8 relative shadow-xl",children:w.jsxs("div",{className:"relative z-10",children:[w.jsx("p",{className:"text-black/60 text-[10px] font-black uppercase tracking-[0.2em] mb-1",children:l.net}),w.jsxs("h2",{className:"text-5xl font-black text-black tracking-tighter",children:["",f.net.toLocaleString()]}),w.jsxs("div",{className:"mt-8 grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"bg-black/5 rounded-[1.8rem] p-4 border border-black/5",children:[w.jsxs("div",{className:"flex items-center gap-2 text-black/60 mb-1",children:[w.jsx(th,{size:14,strokeWidth:3}),w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:l.income})]}),w.jsxs("p",{className:"text-xl font-black text-black",children:["",f.income.toLocaleString()]})]}),w.jsxs("div",{className:"bg-black/5 rounded-[1.8rem] p-4 border border-black/5",children:[w.jsxs("div",{className:"flex items-center gap-2 text-black/60 mb-1",children:[w.jsx(b1,{size:14,strokeWidth:3}),w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:l.expense})]}),w.jsxs("p",{className:"text-xl font-black text-black",children:["",f.expenses.toLocaleString()]})]})]})]})}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>i(!0),className:"flex-[2] bg-primary text-black py-4 rounded-2xl font-black text-xs uppercase tracking-widest active:scale-95 transition-all",children:l.add}),w.jsx("button",{onClick:u,className:"flex-1 bg-white/5 border border-white/10 text-white/40 py-4 rounded-2xl flex items-center justify-center hover:bg-white/10 transition-all",children:w.jsx(d1,{size:20})})]}),w.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[w.jsxs("div",{className:"glass p-4 rounded-[1.8rem] border border-white/5 flex flex-col items-center text-center",children:[w.jsx("div",{className:"p-2 bg-orange-500/20 rounded-xl w-fit mb-2 text-orange-500",children:w.jsx(eg,{size:18})}),w.jsx("p",{className:"text-white/30 text-[8px] font-black uppercase tracking-widest",children:l.cash}),w.jsxs("p",{className:"text-sm font-black text-white",children:["",f.cash.toLocaleString()]})]}),w.jsxs("div",{className:"glass p-4 rounded-[1.8rem] border border-white/5 flex flex-col items-center text-center",children:[w.jsx("div",{className:"p-2 bg-orange-400/20 rounded-xl w-fit mb-2 text-orange-400",children:w.jsx(xT,{size:18})}),w.jsx("p",{className:"text-white/30 text-[8px] font-black uppercase tracking-widest",children:"Lieferando"}),w.jsxs("p",{className:"text-sm font-black text-orange-400",children:["",f.lieferando.toLocaleString()]})]}),w.jsxs("div",{className:"glass p-4 rounded-[1.8rem] border border-white/5 flex flex-col items-center text-center",children:[w.jsx("div",{className:"p-2 bg-blue-500/20 rounded-xl w-fit mb-2 text-blue-500",children:w.jsx(_T,{size:18})}),w.jsx("p",{className:"text-white/30 text-[8px] font-black uppercase tracking-widest",children:l.card}),w.jsxs("p",{className:"text-sm font-black text-white",children:["",f.card.toLocaleString()]})]})]}),w.jsxs("div",{className:"space-y-4 pt-2",children:[w.jsxs("div",{className:"flex justify-between items-center px-1",children:[w.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-white/50",children:l.recent}),w.jsxs("button",{className:"text-primary text-[10px] font-black flex items-center gap-1",children:[l.all," ",w.jsx(t1,{size:14})]})]}),w.jsx("div",{className:"space-y-3",children:t.slice(0,5).map((y,v)=>w.jsxs("div",{className:"glass p-5 rounded-[1.8rem] flex items-center justify-between border border-white/5",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/5 flex items-center justify-center text-white/20",children:w.jsx(S1,{size:22})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-bold text-white tracking-tight",children:y.description}),w.jsxs("p",{className:"text-[10px] text-white/40 font-black uppercase tracking-widest mt-0.5",children:[y.category,"  ",y.date]})]})]}),w.jsxs("p",{className:"font-black text-red-400",children:["",y.amount]})]},v))})]})]})},A3=({reservations:n,onDelete:e,onStatusUpdate:t,lang:r})=>{const[i,o]=_e.useState(""),[l,u]=_e.useState("Alle"),[d,f]=_e.useState({field:"date",direction:"desc"}),y=_e.useMemo(()=>new Date().toISOString().split("T")[0],[]),[v,E]=_e.useState(y),S={tr:{title:"Ynetim Paneli",subTitle:"Rezervasyonlar",all:"Tm",search:"simle ara...",allStatus:"Tm Durumlar",confirmed:"Onayl",seated:"Masada",cancelled:"ptal",guests:"Misafir",tables:"Masa",actions:"lemler",deleteConfirm:"Bu rezervasyonu silmek istediinize emin misiniz?",cancelConfirm:"ptal etmek istiyor musunuz?",noRes:"Rezervasyon bulunamad.",present:"burada",colTime:"Saat",colDate:"Tarih",colName:"sim",colGuests:"Kii"},de:{title:"Verwaltung",subTitle:"Reservierungen",all:"Alle",search:"Suche nach Name...",allStatus:"Alle Status",confirmed:"Reserviert",seated:"Am Tisch",cancelled:"Storniert",guests:"Gste",tables:"Tische",actions:"Aktionen",deleteConfirm:"Diese Reservierung dauerhaft lschen?",cancelConfirm:"Mchten Sie diese Reservierung stornieren?",noRes:"Keine Reservierungen gefunden.",present:"anwesend",colTime:"Uhrzeit",colDate:"Datum",colName:"Name",colGuests:"Pers."},en:{title:"Management",subTitle:"Reservations",all:"All",search:"Search by name...",allStatus:"All Statuses",confirmed:"Confirmed",seated:"Seated",cancelled:"Cancelled",guests:"Guests",tables:"Tables",actions:"Actions",deleteConfirm:"Permanently delete this reservation?",cancelConfirm:"Do you want to cancel this reservation?",noRes:"No reservations found.",present:"present",colTime:"Time",colDate:"Date",colName:"Name",colGuests:"Guests"},es:{title:"Gestin",subTitle:"Reservas",all:"Todo",search:"Buscar por nombre...",allStatus:"Todos los estados",confirmed:"Confirmado",seated:"En mesa",cancelled:"Cancelado",guests:"Invitados",tables:"Mesas",actions:"Acciones",deleteConfirm:"Eliminar permanentemente esta reserva?",cancelConfirm:"Desea cancelar esta reserva?",noRes:"No se encontraron reservas.",present:"presente",colTime:"Hora",colDate:"Fecha",colName:"Nombre",colGuests:"Pers."}},N=S[r]||S.de,M=j=>{navigator.vibrate&&navigator.vibrate(50),t(j,"seated")},k=j=>{window.confirm(N.deleteConfirm)&&e(j)},B=j=>{f(b=>({field:j,direction:b.field===j&&b.direction==="asc"?"desc":"asc"})),navigator.vibrate&&navigator.vibrate(10)},q=_e.useMemo(()=>n.filter(j=>{const b=j.name.toLowerCase().includes(i.toLowerCase())||j.phone.includes(i),R=j.status||"confirmed",P=l==="Alle"?!0:R===l,L=v?j.date===v:!0;return b&&P&&L}),[n,i,l,v]),H=_e.useMemo(()=>{const{field:j,direction:b}=d;return[...q].sort((R,P)=>{let L=0;return j==="date"?(L=R.date.localeCompare(P.date),L===0&&(L=R.time.localeCompare(P.time))):j==="time"?(L=R.time.localeCompare(P.time),L===0&&(L=R.date.localeCompare(P.date))):j==="name"&&(L=R.name.localeCompare(P.name)),b==="asc"?L:-L})},[q,d]),ee=_e.useMemo(()=>{const j=q.filter(L=>L.status!=="cancelled"),b=j.filter(L=>L.status==="seated").reduce((L,F)=>L+F.guests,0),R=j.reduce((L,F)=>L+F.guests,0),P=j.length;return{totalGuests:R,seatedGuests:b,totalTables:P}},[q]),te=({field:j})=>d.field!==j?w.jsx(n1,{size:14,className:"opacity-30 ml-1"}):d.direction==="asc"?w.jsx(i1,{size:14,className:"ml-1 text-primary"}):w.jsx(e1,{size:14,className:"ml-1 text-primary"});return w.jsxs("div",{className:"flex flex-col gap-6 animate-in fade-in zoom-in duration-300 mb-24",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"bg-card-dark border border-white/5 rounded-xl p-5 shadow-lg relative overflow-hidden group",children:[w.jsx("p",{className:"text-white/50 text-xs font-bold uppercase tracking-wider mb-1",children:N.guests}),w.jsx("div",{className:"flex items-baseline gap-1",children:w.jsxs("h3",{className:"text-4xl font-black text-white",children:[ee.seatedGuests,w.jsxs("span",{className:"text-white/30 text-2xl",children:["/",ee.totalGuests]})]})}),w.jsxs("p",{className:"text-xs text-green-500 mt-1 font-medium",children:[ee.totalGuests>0?Math.round(ee.seatedGuests/ee.totalGuests*100):0,"% ",N.present]})]}),w.jsxs("div",{className:"bg-card-dark border border-white/5 rounded-xl p-5 shadow-lg relative overflow-hidden group",children:[w.jsx("p",{className:"text-white/50 text-xs font-bold uppercase tracking-wider mb-1",children:N.tables}),w.jsx("div",{className:"flex items-baseline gap-1",children:w.jsx("h3",{className:"text-4xl font-black text-white",children:ee.totalTables})})]})]}),w.jsxs("div",{className:"flex flex-col rounded-xl bg-card-dark shadow-2xl border border-white/5",children:[w.jsxs("div",{className:"p-6 sm:p-8",children:[w.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-6",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl sm:text-3xl font-black tracking-tighter text-white",children:N.title}),w.jsx("p",{className:"text-sm sm:text-base font-normal text-gray-400",children:v?`${N.subTitle}: ${new Date(v).toLocaleDateString(r==="tr"?"tr-TR":"de-DE")}`:N.all})]}),w.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[w.jsx("input",{type:"date",value:v,onChange:j=>E(j.target.value),className:"bg-white/5 border border-white/10 text-white text-sm rounded-lg focus:ring-primary focus:border-primary block w-full p-2.5 [color-scheme:dark]"}),v&&w.jsx("button",{onClick:()=>E(""),className:"p-2.5 text-gray-400 hover:text-white bg-white/5 rounded-lg border border-white/10 transition-colors",children:w.jsx(f1,{size:20})})]})]}),w.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[w.jsx("div",{className:"relative flex-grow",children:w.jsx("input",{value:i,onChange:j=>o(j.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 text-white placeholder-gray-400 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none h-12 pl-4 pr-4 text-base transition-all",placeholder:N.search,type:"text"})}),w.jsxs("select",{value:l,onChange:j=>u(j.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 text-white h-12 px-4 text-base sm:w-auto [color-scheme:dark]",children:[w.jsx("option",{value:"Alle",children:N.allStatus}),w.jsx("option",{value:"confirmed",children:N.confirmed}),w.jsx("option",{value:"seated",children:N.seated}),w.jsx("option",{value:"cancelled",children:N.cancelled})]})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full min-w-[800px] text-left text-sm",children:[w.jsx("thead",{className:"border-b border-t border-white/10 bg-white/5 text-xs uppercase text-gray-400",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 font-medium cursor-pointer hover:bg-white/10 transition-colors select-none",onClick:()=>B("time"),children:w.jsxs("div",{className:"flex items-center",children:[N.colTime," ",w.jsx(te,{field:"time"})]})}),w.jsx("th",{className:"px-6 py-4 font-medium cursor-pointer hover:bg-white/10 transition-colors select-none",onClick:()=>B("date"),children:w.jsxs("div",{className:"flex items-center",children:[N.colDate," ",w.jsx(te,{field:"date"})]})}),w.jsx("th",{className:"px-6 py-4 font-medium cursor-pointer hover:bg-white/10 transition-colors select-none",onClick:()=>B("name"),children:w.jsxs("div",{className:"flex items-center",children:[N.colName," ",w.jsx(te,{field:"name"})]})}),w.jsx("th",{className:"px-6 py-4 font-medium",children:N.colGuests}),w.jsx("th",{className:"px-6 py-4 font-medium",children:"Status"}),w.jsx("th",{className:"px-6 py-4 font-medium text-right",children:N.actions})]})}),w.jsx("tbody",{className:"divide-y divide-white/10",children:H.length===0?w.jsx("tr",{children:w.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:N.noRes})}):H.map(j=>w.jsxs("tr",{className:`hover:bg-white/5 transition-colors ${j.status==="seated"?"bg-success/5":""}`,children:[w.jsx("td",{className:"px-6 py-4 text-white font-bold text-base",children:j.time}),w.jsx("td",{className:"px-6 py-4 text-gray-400 font-medium",children:new Date(j.date).toLocaleDateString(r==="tr"?"tr-TR":"de-DE",{day:"2-digit",month:"2-digit"})}),w.jsx("td",{className:"px-6 py-4 text-white font-medium",children:j.name}),w.jsx("td",{className:"px-6 py-4 text-gray-300",children:w.jsx("span",{className:"bg-white/10 px-2 py-1 rounded text-xs font-bold",children:j.guests})}),w.jsxs("td",{className:"px-6 py-4",children:[(!j.status||j.status==="confirmed")&&w.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-500/10 px-2.5 py-0.5 text-xs font-medium text-blue-500 border border-blue-500/20",children:N.confirmed}),j.status==="seated"&&w.jsx("span",{className:"inline-flex items-center rounded-full bg-success/10 px-2.5 py-0.5 text-xs font-medium text-success border border-success/20",children:N.seated}),j.status==="cancelled"&&w.jsx("span",{className:"inline-flex items-center rounded-full bg-error/10 px-2.5 py-0.5 text-xs font-medium text-error border border-error/20",children:N.cancelled})]}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("div",{className:"flex items-center justify-end gap-2",children:[j.status==="confirmed"&&w.jsx("button",{onClick:()=>M(j.id),className:"flex items-center justify-center w-8 h-8 rounded-md text-success hover:bg-success/10 border border-success/20",children:w.jsx(D1,{size:18})}),w.jsx("a",{href:`tel:${j.phone}`,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white",children:w.jsx(Nh,{size:16})}),w.jsx("button",{onClick:()=>k(j.id),className:"w-8 h-8 flex items-center justify-center text-error hover:text-red-400",children:w.jsx(IT,{size:16})})]})})]},j.id))})]})})]})]})},C3=({reservations:n,turnovers:e,expenses:t,personnel:r,settings:i,lang:o})=>{const l={tr:{welcome:"Ho Geldin, Chef!",overview:"Genel Durum",todayTurnover:"Bugnk Ciro",todayRes:"Rezervasyonlar",staffCount:"Aktif Personel",weeklyTrend:"Haftalk Ciro Trendi",occupancy:"Anlk Doluluk",seated:"Masada",waiting:"Bekleyen",capacity:"Kapasite",guests:"Kii"},de:{welcome:"Willkommen, Chef!",overview:"bersicht",todayTurnover:"Umsatz Heute",todayRes:"Reservierungen",staffCount:"Mitarbeiter",weeklyTrend:"Wchentlicher Umsatztrend",occupancy:"Heutige Auslastung",seated:"Am Tisch",waiting:"Wartend",capacity:"Kapazitt",guests:"Pers."},en:{welcome:"Welcome, Boss!",overview:"Overview",todayTurnover:"Today's Turnover",todayRes:"Reservations",staffCount:"Staff Members",weeklyTrend:"Weekly Revenue Trend",occupancy:"Current Occupancy",seated:"Seated",waiting:"Waiting",capacity:"Capacity",guests:"Guests"},es:{welcome:"Bienvenido, Chef!",overview:"Resumen general",todayTurnover:"Volumen de hoy",todayRes:"Reservas",staffCount:"Personal activo",weeklyTrend:"Tendencia semanal",occupancy:"Ocupacin actual",seated:"En mesa",waiting:"En espera",capacity:"Capacidad",guests:"Invitados"}},u=l[o]||l.de,d=new Date().toISOString().split("T")[0],f=_e.useMemo(()=>{const y=e.find(B=>B.date===d)?.total||0,v=n.filter(B=>B.date===d&&B.status!=="cancelled"),E=v.filter(B=>B.status==="confirmed").reduce((B,q)=>B+q.guests,0),S=v.filter(B=>B.status==="seated").reduce((B,q)=>B+q.guests,0),N=Array.from({length:7},(B,q)=>{const H=new Date;H.setDate(H.getDate()-q);const ee=H.toISOString().split("T")[0],te=e.find(j=>j.date===ee)?.total||0;return{day:H.toLocaleDateString(o,{weekday:"short"}),value:te}}).reverse(),M=Math.max(...N.map(B=>B.value),500),k=Math.min(100,Math.round(S/(i.maxCapacityPerSlot||1)*100));return{todayTurnover:y,totalGuestsWaiting:E,seatedGuests:S,staffActive:r.length,last7Days:N,maxVal:M,occupancyRate:k}},[n,e,r,i.maxCapacityPerSlot,d,o]);return w.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700",children:[w.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:w.jsxs("div",{children:[w.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter",children:u.welcome}),w.jsxs("p",{className:"text-white/30 text-[11px] font-black uppercase tracking-[0.4em] mt-2 flex items-center gap-2",children:[w.jsx(YC,{size:14,className:"text-primary"})," ",u.overview,"  ",new Date().toLocaleDateString(o,{day:"numeric",month:"long",year:"numeric"})]})]})}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"glass p-8 rounded-[3rem] border border-white/5 space-y-6 relative overflow-hidden group hover:bg-white/[0.07] transition-all",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("div",{className:"p-4 bg-primary/10 rounded-2xl text-primary",children:w.jsx(th,{size:24})}),w.jsx("span",{className:"text-[10px] font-black text-green-500 bg-green-500/10 px-3 py-1 rounded-full uppercase tracking-widest",children:"LIVE"})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-white/30 text-[10px] font-black uppercase tracking-widest mb-1",children:u.todayTurnover}),w.jsxs("h3",{className:"text-4xl font-black text-white",children:["",f.todayTurnover.toLocaleString()]})]}),w.jsx("div",{className:"absolute -bottom-4 -right-4 opacity-[0.03] group-hover:scale-110 transition-transform",children:w.jsx(th,{size:140})})]}),w.jsxs("div",{className:"glass p-8 rounded-[3rem] border border-white/5 space-y-6 relative overflow-hidden group hover:bg-white/[0.07] transition-all",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("div",{className:"p-4 bg-primary/10 rounded-2xl text-primary",children:w.jsx(bu,{size:24})}),f.totalGuestsWaiting>0&&w.jsxs("span",{className:"text-[10px] font-black text-primary bg-primary/10 px-3 py-1 rounded-full animate-pulse",children:[f.totalGuestsWaiting," ",u.waiting]})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-white/30 text-[10px] font-black uppercase tracking-widest mb-1",children:u.todayRes}),w.jsxs("h3",{className:"text-4xl font-black text-white",children:[f.seatedGuests," ",w.jsxs("span",{className:"text-white/20 text-2xl font-black",children:["/ ",f.totalGuestsWaiting+f.seatedGuests]})]})]}),w.jsx("div",{className:"absolute -bottom-4 -right-4 opacity-[0.03] group-hover:scale-110 transition-transform",children:w.jsx(bu,{size:140})})]}),w.jsxs("div",{className:"glass p-8 rounded-[3rem] border border-white/5 space-y-6 relative overflow-hidden group hover:bg-white/[0.07] transition-all",children:[w.jsx("div",{className:"flex justify-between items-start",children:w.jsx("div",{className:"p-4 bg-primary/10 rounded-2xl text-primary",children:w.jsx(ba,{size:24})})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-white/30 text-[10px] font-black uppercase tracking-widest mb-1",children:u.staffCount}),w.jsx("h3",{className:"text-4xl font-black text-white",children:f.staffActive})]}),w.jsx("div",{className:"absolute -bottom-4 -right-4 opacity-[0.03] group-hover:scale-110 transition-transform",children:w.jsx(ba,{size:140})})]}),w.jsxs("div",{className:"lg:col-span-2 glass p-8 rounded-[3rem] border border-white/5 flex flex-col justify-between",children:[w.jsx("div",{className:"flex justify-between items-center mb-10",children:w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-white/40 flex items-center gap-2",children:[w.jsx(x1,{size:14,className:"text-primary"})," ",u.weeklyTrend]})}),w.jsx("div",{className:"flex items-end justify-between gap-4 h-48 px-2",children:f.last7Days.map((y,v)=>w.jsxs("div",{className:"flex-1 flex flex-col items-center gap-3",children:[w.jsx("div",{className:"relative w-full group flex items-end justify-center h-full",children:w.jsx("div",{className:"w-full max-w-[40px] bg-primary/20 rounded-t-xl group-hover:bg-primary/50 transition-all cursor-pointer relative",style:{height:`${Math.max(4,y.value/f.maxVal*100)}%`},children:w.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-white text-black text-[10px] font-black px-2 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-all whitespace-nowrap shadow-xl scale-90 group-hover:scale-100",children:["",y.value]})})}),w.jsx("span",{className:"text-[9px] font-black text-white/20 uppercase tracking-widest",children:y.day})]},v))})]}),w.jsxs("div",{className:"glass p-8 rounded-[3rem] border border-white/5 flex flex-col items-center justify-center space-y-4",children:[w.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-white/40",children:u.occupancy}),w.jsxs("div",{className:"relative w-44 h-44",children:[w.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[w.jsx("circle",{cx:"88",cy:"88",r:"78",stroke:"currentColor",strokeWidth:"12",fill:"transparent",className:"text-white/5"}),w.jsx("circle",{cx:"88",cy:"88",r:"78",stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:490,strokeDashoffset:490-490*(f.occupancyRate/100),className:"text-primary transition-all duration-1000 ease-out",strokeLinecap:"round"})]}),w.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[w.jsxs("span",{className:"text-4xl font-black text-white tracking-tighter",children:[f.occupancyRate,"%"]}),w.jsxs("p",{className:"text-[8px] font-black text-white/30 uppercase tracking-widest mt-1",children:[f.seatedGuests," / ",i.maxCapacityPerSlot," ",u.capacity]})]})]})]})]})]})},R3=({onSubmit:n,isLoading:e,existingReservations:t,lang:r,settings:i})=>{const o=()=>new Date().toISOString().split("T")[0],[l,u]=_e.useState({name:"",phone:"",date:o(),time:"",guests:2,notes:""}),[d,f]=_e.useState(null),y={tr:{date:"Tarih Sein",guests:"Kii Says",time:"Msait Saatler",name:"Ad Soyad",phone:"Telefon",submit:"Rezervasyon Yap",holiday:"Restoran bu tarihte kapaldr."},de:{date:"Datum whlen",guests:"Personenanzahl",time:"Verfgbare Zeiten",name:"Vor- und Nachname",phone:"Telefonnummer",submit:"Kostenpflichtig buchen",holiday:"Das Restaurant ist an diesem Tag geschlossen."},en:{date:"Select Date",guests:"Number of Guests",time:"Available Times",name:"Full Name",phone:"Phone Number",submit:"Book Table",holiday:"The restaurant is closed on this date."},es:{date:"Seleccionar fecha",guests:"Nmero de personas",time:"Horas disponibles",name:"Nombre y apellido",phone:"Nmero de telfono",submit:"Reservar mesa",holiday:"El restaurante est cerrado en esta fecha."}},v=y[r]||y.de,E=N=>{const M=N.target.value;i.holidays.includes(M)?f(v.holiday):f(null),u({...l,date:M,time:""})},S=_e.useMemo(()=>{if(d)return[];const N=[],M=11,k=22,B=l.date===o(),H=new Date().getHours(),ee=t.filter(te=>te.date===l.date&&te.status!=="cancelled");for(let te=M;te<=k;te++)[":00",":30"].forEach(j=>{const b=`${te}${j}`,R=te;ee.filter(L=>L.time===b).reduce((L,F)=>L+F.guests,0)+l.guests<=i.maxCapacityPerSlot&&(!B||R>H+1)&&N.push(b)});return N},[l.date,l.guests,t,d,i.maxCapacityPerSlot]);return w.jsx("div",{className:"glass p-6 sm:p-8 rounded-xl w-full mb-12 box-border",children:w.jsxs("form",{onSubmit:N=>{N.preventDefault(),n(l)},className:"space-y-8 max-w-full overflow-hidden",children:[w.jsxs("div",{className:"space-y-3 w-full",children:[w.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white/80",children:[w.jsx(bu,{size:16,className:"text-primary"})," ",v.date]}),w.jsx("input",{required:!0,type:"date",min:o(),className:"block w-full bg-white/5 border border-white/10 rounded-xl py-4 px-4 text-white text-base [color-scheme:dark] focus:ring-1 focus:ring-primary focus:outline-none",value:l.date,onChange:E}),d&&w.jsxs("p",{className:"text-red-400 text-sm flex items-center gap-2 mt-2 font-medium",children:[w.jsx(XC,{size:14})," ",d]})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white/80",children:[w.jsx(ba,{size:16,className:"text-primary"})," ",v.guests]}),w.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/10 rounded-xl p-2",children:[w.jsx("button",{type:"button",onClick:()=>u(N=>({...N,guests:Math.max(1,N.guests-1)})),className:"w-12 h-12 rounded-lg bg-white/10 flex items-center justify-center text-white active:scale-95 transition-all",children:w.jsx(E1,{size:20})}),w.jsx("div",{className:"flex-1 text-center",children:w.jsx("span",{className:"text-2xl font-bold text-white",children:l.guests})}),w.jsx("button",{type:"button",onClick:()=>u(N=>({...N,guests:N.guests+1})),className:"w-12 h-12 rounded-lg bg-white/10 flex items-center justify-center text-white active:scale-95 transition-all",children:w.jsx(TT,{size:20})})]})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white/80",children:[w.jsx(vT,{size:16,className:"text-primary"})," ",v.time]}),w.jsx("div",{className:"grid grid-cols-3 gap-2",children:S.map(N=>w.jsx("button",{type:"button",onClick:()=>u({...l,time:N}),className:`py-3 rounded-xl text-sm font-bold border transition-all ${l.time===N?"bg-primary text-black border-primary scale-[1.02] shadow-lg shadow-primary/20":"bg-white/5 text-white border-white/10"}`,children:N},N))})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"relative",children:[w.jsx(Du,{className:"absolute left-3 top-4 text-white/40",size:18}),w.jsx("input",{required:!0,type:"text",placeholder:v.name,className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-10 pr-4 text-white text-base focus:ring-1 focus:ring-primary focus:outline-none",value:l.name,onChange:N=>u({...l,name:N.target.value})})]}),w.jsxs("div",{className:"relative",children:[w.jsx(Nh,{className:"absolute left-3 top-4 text-white/40",size:18}),w.jsx("input",{required:!0,type:"tel",placeholder:v.phone,className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-10 pr-4 text-white text-base focus:ring-1 focus:ring-primary focus:outline-none",value:l.phone,onChange:N=>u({...l,phone:N.target.value})})]})]}),w.jsx("button",{type:"submit",disabled:e||!l.time,className:"w-full bg-primary hover:bg-primary/90 text-black py-4 rounded-xl font-extrabold text-lg disabled:opacity-50 active:scale-[0.98] transition-all shadow-xl shadow-primary/10",children:e?w.jsx(wu,{className:"animate-spin mx-auto"}):v.submit})]})})},N3=({lang:n,staff:e,settings:t})=>{const[r,i]=_e.useState(""),[o,l]=_e.useState(!1),[u,d]=_e.useState(!1),[f,y]=_e.useState(null),[v,E]=_e.useState(null),[S,N]=_e.useState(""),M=_e.useRef(null),[k,B]=_e.useState(!1),[q,H]=_e.useState(null),[ee,te]=_e.useState(1),[j,b]=_e.useState({x:0,y:0}),[R,P]=_e.useState(!1),[L,F]=_e.useState({x:0,y:0}),G=_e.useRef(null),D=_e.useRef(null),Fe={tr:{title:"Personel Ynetimi",count:"alan",add:"Yeni Kayt",edit:"Bilgileri Dzenle",search:"sim veya grev...",personalInfo:"Kiisel Bilgiler",legalInfo:"Resmi Bilgiler",bankInfo:"Banka Bilgileri",employmentInfo:" Bilgileri",firstName:"Ad",lastName:"Soyad",dob:"Doum Tarihi",pob:"Doum Yeri",address:"Adres",nationality:"Uyruk",healthIns:"Krankkasse (Salk Sig.)",taxId:"Steuer ID (Vergi No)",ssn:"SSN (Sosyal Gvenlik)",bank:"Banka Ad",iban:"IBAN",bic:"BIC/SWIFT",startDate:"e Giri Tarihi",baseSalary:"Net Maa",advances:"denen",remaining:"Kalan",save:"KAYDI TAMAMLA",update:"GNCELLEMELER KAYDET",cancel:"PTAL",roles:["ef","Garson","Mutfak","Komi","Barista","Temizlik"],deleteConfirm:"Bu personel kayd silinsin mi?",photo:"Profil Fotoraf",paySalary:"Maa de",giveAdvance:"Avans Ver",paymentHistory:"deme Gemii",type:{salary:"Maa",advance:"Avans"},paid:"DEND",addPayment:"deme Ekle",noHistory:"Bu aya ait deme kayd yok.",cropTitle:"Fotoraf Dzenle",cropConfirm:"KIRPMAYI ONAYLA",cropHint:"Fotoraf srkleyerek ve byterek hizalayn"},de:{title:"Personal",count:"Mitarbeiter",add:"Neu anlegen",edit:"Daten bearbeiten",search:"Name oder Position...",personalInfo:"Persnliche Daten",legalInfo:"Gesetzliche Informationen",bankInfo:"Bankverbindung",employmentInfo:"Arbeitsverhltnis",firstName:"Vorname",lastName:"Nachname",dob:"Geburtsdatum",pob:"Geburtsort",address:"Anschrift",nationality:"Staatsangehrigkeit",healthIns:"Krankkasse",taxId:"Steuer ID",ssn:"Sozialvers.Nr.",bank:"Bankname",iban:"IBAN",bic:"BIC",startDate:"Eintrittsdatum",baseSalary:"Netto-Gehalt",advances:"Gezahlt",remaining:"Rest",save:"REGISTRIERUNG ABSCHLIESSEN",update:"NDERUNGEN SPEICHERN",cancel:"ABBRECHEN",roles:["Kchenchef","Kellner","Kche","Hilfskraft","Barista","Reinigung"],deleteConfirm:"Mitarbeiter gerekten silinsin mi?",photo:"Profilbild",paySalary:"Gehalt zahlen",giveAdvance:"Vorschuss geben",paymentHistory:"Zahlungshistorie",type:{salary:"Gehalt",advance:"Vorschuss"},paid:"BEZAHLT",addPayment:"Zahlung erfassen",noHistory:"Keine Zahlungen in diesem Monat.",cropTitle:"Foto bearbeiten",cropConfirm:"ZUSCHNITT BESTTIGEN",cropHint:"Foto ziehen und zoomen zum Ausrichten"},en:{title:"Staff",count:"Staff Count",add:"Add Staff",edit:"Edit Profile",search:"Search staff...",personalInfo:"Personal Info",legalInfo:"Legal Information",bankInfo:"Bank Details",employmentInfo:"Employment Details",firstName:"First Name",lastName:"Last Name",dob:"Date of Birth",pob:"Place of Birth",address:"Address",nationality:"Nationality",healthIns:"Health Insurance",taxId:"Tax ID",ssn:"SSN (Social Security)",bank:"Bank Name",iban:"IBAN",bic:"BIC",startDate:"Start Date",baseSalary:"Net Salary",advances:"Paid",remaining:"Remaining",save:"COMPLETE REGISTRATION",update:"SAVE UPDATES",cancel:"CANCEL",roles:["Chef","Waiter","Kitchen","Assistant","Barista","Cleaning"],deleteConfirm:"Delete this staff record?",photo:"Profile Photo",paySalary:"Pay Salary",giveAdvance:"Give Advance",paymentHistory:"Payment History",type:{salary:"Salary",advance:"Advance"},paid:"PAID",addPayment:"Add Payment",noHistory:"No payments for this month.",cropTitle:"Edit Photo",cropConfirm:"CONFIRM CROP",cropHint:"Drag and zoom to align the photo"},es:{title:"Personal",count:"Nmero de empleados",add:"Aadir personal",edit:"Editar perfil",search:"Buscar personal...",personalInfo:"Informacin personal",legalInfo:"Informacin legal",bankInfo:"Informacin bancaria",employmentInfo:"Informacin laboral",firstName:"Nombre",lastName:"Apellido",dob:"Fecha de nacimiento",pob:"Lugar de nacimiento",address:"Direccin",nationality:"Nacionalidad",healthIns:"Seguro de salud",taxId:"ID fiscal",ssn:"Seguro Social",bank:"Nombre del banco",iban:"IBAN",bic:"BIC",startDate:"Fecha de inicio",baseSalary:"Salario neto",advances:"Pagado",remaining:"Restante",save:"COMPLETAR REGISTRO",update:"GUARDAR CAMBIOS",cancel:"CANCELAR",roles:["Chef","Camarero","Cocina","Ayudante","Barista","Limpieza"],deleteConfirm:"Eliminar este registro de personal?",photo:"Foto de perfil",paySalary:"Pagar salario",giveAdvance:"Dar adelanto",paymentHistory:"Historial de pagos",type:{salary:"Salario",advance:"Adelanto"},paid:"PAGADO",addPayment:"Aadir pago",noHistory:"No hay pagos para este mes.",cropTitle:"Editar foto",cropConfirm:"CONFIRMAR CORTE",cropHint:"Arrastra y haz zoom para alinear la foto"}},Z=Fe[n]||Fe.de,[fe,Ie]=_e.useState({firstName:"",lastName:"",dateOfBirth:"",placeOfBirth:"",address:"",nationality:"",healthInsurance:"",taxId:"",socialSecurityNumber:"",bankName:"",iban:"",bic:"",startDate:new Date().toISOString().split("T")[0],role:Z.roles[0],baseSalary:0,photo:void 0,phone:""}),ce=()=>{Ie({firstName:"",lastName:"",dateOfBirth:"",placeOfBirth:"",address:"",nationality:"",healthInsurance:"",taxId:"",socialSecurityNumber:"",bankName:"",iban:"",bic:"",startDate:new Date().toISOString().split("T")[0],role:Z.roles[0],baseSalary:0,photo:void 0,phone:""}),d(!1),l(!0)},Ce=()=>{f&&(Ie({...f}),d(!0),l(!0))},ge=ae=>{const je=ae.target.files?.[0];if(!je)return;const Pt=new FileReader;Pt.onloadend=()=>{H(Pt.result),B(!0),te(1),b({x:0,y:0})},Pt.readAsDataURL(je)},z=()=>{const ae=G.current,je=D.current;if(!ae||!je)return;const Pt=ae.getContext("2d");if(!Pt)return;const Bt=400;ae.width=Bt,ae.height=Bt,Pt.clearRect(0,0,Bt,Bt);const Nn=je.naturalWidth*ee,Hr=je.naturalHeight*ee,Ti=Bt/2,$r=Bt/2;Pt.drawImage(je,Ti-Nn/2+j.x,$r-Hr/2+j.y,Nn,Hr);const Ss=ae.toDataURL("image/jpeg",.8);Ie({...fe,photo:Ss}),B(!1),H(null)},ne=ae=>{P(!0);const je="touches"in ae?ae.touches[0].clientX:ae.clientX,Pt="touches"in ae?ae.touches[0].clientY:ae.clientY;F({x:je-j.x,y:Pt-j.y})},ke=ae=>{if(!R)return;const je="touches"in ae?ae.touches[0].clientX:ae.clientX,Pt="touches"in ae?ae.touches[0].clientY:ae.clientY;b({x:je-L.x,y:Pt-L.y})},De=()=>P(!1),Oe=async()=>{u&&fe.id?await E3(fe.id,fe):await w3(fe),l(!1),navigator.vibrate&&navigator.vibrate(50)},Be=async()=>{if(!f||!S)return;const ae=parseFloat(S),je={type:v,amount:ae,date:new Date().toISOString().split("T")[0],month:new Date().toISOString().slice(0,7)};await x3(f.id,je),E(null),N(""),navigator.vibrate&&navigator.vibrate(50)},We=new Date().toISOString().slice(0,7),He=ae=>{const Pt=ae.payments.filter(Nn=>Nn.month===We).reduce((Nn,Hr)=>Nn+Hr.amount,0),Bt=Math.max(0,ae.baseSalary-Pt);return{totalPaid:Pt,remaining:Bt,isFullyPaid:Bt<=0}},tt=_e.useMemo(()=>e.filter(ae=>`${ae.firstName} ${ae.lastName}`.toLowerCase().includes(r.toLowerCase())),[e,r]);if(o)return w.jsxs("div",{className:"space-y-6 pb-24 animate-in slide-in-from-bottom-4 duration-300",children:[k&&q&&w.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-2xl flex flex-col items-center justify-center p-6 animate-in fade-in duration-300",children:[w.jsxs("div",{className:"w-full max-w-sm space-y-8",children:[w.jsxs("div",{className:"text-center space-y-2",children:[w.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:Z.cropTitle}),w.jsx("p",{className:"text-[10px] text-white/30 font-black uppercase tracking-widest",children:Z.cropHint})]}),w.jsxs("div",{className:"relative w-full aspect-square bg-white/5 rounded-[3rem] overflow-hidden border border-white/10 touch-none cursor-move",onMouseDown:ne,onMouseMove:ke,onMouseUp:De,onMouseLeave:De,onTouchStart:ne,onTouchMove:ke,onTouchEnd:De,children:[w.jsx("img",{ref:D,src:q,alt:"Crop preview",className:"absolute pointer-events-none transition-transform duration-75",style:{transform:`translate(-50%, -50%) translate(${j.x}px, ${j.y}px) scale(${ee})`,top:"50%",left:"50%",maxWidth:"none"}}),w.jsx("div",{className:"absolute inset-0 border-4 border-primary/50 pointer-events-none rounded-[3rem] ring-[1000px] ring-black/60 shadow-[inset_0_0_100px_rgba(0,0,0,0.5)]"})]}),w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-4 bg-white/5 p-4 rounded-2xl border border-white/10",children:[w.jsx(ST,{className:"text-white/30",size:18}),w.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.01",value:ee,onChange:ae=>te(parseFloat(ae.target.value)),className:"flex-1 accent-primary h-1.5 bg-white/10 rounded-full appearance-none"})]}),w.jsxs("div",{className:"flex flex-col gap-3",children:[w.jsx("button",{onClick:z,className:"w-full bg-primary text-black py-5 rounded-2xl font-black text-sm tracking-widest active:scale-95 transition-all shadow-lg shadow-primary/20",children:Z.cropConfirm}),w.jsx("button",{onClick:()=>{B(!1),H(null)},className:"w-full py-3 text-white/30 font-black text-[10px] uppercase tracking-widest",children:Z.cancel})]})]})]}),w.jsx("canvas",{ref:G,style:{display:"none"}})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:u?Z.edit:Z.add}),w.jsx("button",{onClick:()=>l(!1),className:"p-3 bg-white/5 rounded-full border border-white/5",children:w.jsx(Mu,{size:20})})]}),w.jsxs("div",{className:"flex flex-col items-center mb-6",children:[w.jsxs("div",{onClick:()=>M.current?.click(),className:"w-32 h-32 rounded-[2.5rem] bg-white/5 border-2 border-dashed border-white/10 flex flex-col items-center justify-center overflow-hidden relative active:scale-95 transition-all group",children:[fe.photo?w.jsx("img",{src:fe.photo,className:"w-full h-full object-cover",alt:"Staff"}):w.jsx(wT,{className:"text-white/20",size:40}),w.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:w.jsx(Zm,{size:24,className:"text-primary"})})]}),w.jsx("input",{type:"file",ref:M,hidden:!0,accept:"image/*",onChange:ge}),w.jsx("p",{className:"mt-3 text-[10px] font-black text-white/30 uppercase tracking-widest",children:Z.photo})]}),w.jsxs("div",{className:"space-y-6",children:[w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[w.jsx(Du,{size:14})," ",Z.personalInfo]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("input",{placeholder:Z.firstName,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.firstName,onChange:ae=>Ie({...fe,firstName:ae.target.value})}),w.jsx("input",{placeholder:Z.lastName,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.lastName,onChange:ae=>Ie({...fe,lastName:ae.target.value})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[8px] font-black text-white/20 uppercase ml-2",children:Z.dob}),w.jsx("input",{type:"date",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold [color-scheme:dark] outline-none",value:fe.dateOfBirth,onChange:ae=>Ie({...fe,dateOfBirth:ae.target.value})})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[8px] font-black text-white/20 uppercase ml-2",children:Z.nationality}),w.jsx("input",{placeholder:Z.nationality,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.nationality,onChange:ae=>Ie({...fe,nationality:ae.target.value})})]})]}),w.jsx("input",{placeholder:Z.pob,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.placeOfBirth,onChange:ae=>Ie({...fe,placeOfBirth:ae.target.value})}),w.jsx("input",{placeholder:Z.address,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.address,onChange:ae=>Ie({...fe,address:ae.target.value})})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[w.jsx(nm,{size:14})," ",Z.legalInfo]}),w.jsx("input",{placeholder:Z.healthIns,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.healthInsurance,onChange:ae=>Ie({...fe,healthInsurance:ae.target.value})}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("input",{placeholder:Z.taxId,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.taxId,onChange:ae=>Ie({...fe,taxId:ae.target.value})}),w.jsx("input",{placeholder:Z.ssn,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.socialSecurityNumber,onChange:ae=>Ie({...fe,socialSecurityNumber:ae.target.value})})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[w.jsx(j_,{size:14})," ",Z.bankInfo]}),w.jsx("input",{placeholder:Z.bank,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.bankName,onChange:ae=>Ie({...fe,bankName:ae.target.value})}),w.jsx("input",{placeholder:Z.iban,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.iban,onChange:ae=>Ie({...fe,iban:ae.target.value})}),w.jsx("input",{placeholder:Z.bic,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.bic,onChange:ae=>Ie({...fe,bic:ae.target.value})})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[w.jsx(W_,{size:14})," ",Z.employmentInfo]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[8px] font-black text-white/20 uppercase ml-2",children:Z.startDate}),w.jsx("input",{type:"date",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold [color-scheme:dark] outline-none",value:fe.startDate,onChange:ae=>Ie({...fe,startDate:ae.target.value})})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[8px] font-black text-white/20 uppercase ml-2",children:Z.baseSalary}),w.jsx("input",{type:"number",placeholder:"0",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.baseSalary||"",onChange:ae=>Ie({...fe,baseSalary:Number(ae.target.value)})})]})]}),w.jsx("select",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold outline-none appearance-none",value:fe.role,onChange:ae=>Ie({...fe,role:ae.target.value}),children:Z.roles.map(ae=>w.jsx("option",{value:ae,className:"bg-background-dark",children:ae},ae))}),w.jsx("input",{placeholder:Z.phone,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 text-white font-bold focus:border-primary transition-all outline-none",value:fe.phone,onChange:ae=>Ie({...fe,phone:ae.target.value})})]}),w.jsx("button",{onClick:Oe,className:"w-full bg-primary text-black py-6 rounded-3xl font-black text-lg shadow-xl active:scale-95 transition-all",children:u?Z.update:Z.save})]})]});if(f){const ae=He(f);return w.jsxs("div",{className:"space-y-6 pb-24 animate-in zoom-in duration-300",children:[w.jsxs("div",{className:"flex items-center justify-between gap-4",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("button",{onClick:()=>y(null),className:"p-3 bg-white/5 rounded-full border border-white/5",children:w.jsx(Mu,{size:20})}),w.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-tight truncate max-w-[180px]",children:[f.firstName," ",f.lastName]})]}),w.jsxs("button",{onClick:Ce,className:"flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-xl text-primary active:scale-95 transition-all",children:[w.jsx(T1,{size:18}),w.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:Z.edit.split(" ")[0]})]})]}),w.jsx("div",{className:"flex justify-center mb-6",children:w.jsx("div",{className:"w-32 h-32 rounded-[2.5rem] border-4 border-primary/20 p-1 overflow-hidden shadow-2xl",children:f.photo?w.jsx("img",{src:f.photo,className:"w-full h-full object-cover rounded-[2.2rem]",alt:"Staff"}):w.jsx("div",{className:"w-full h-full bg-white/5 flex items-center justify-center rounded-[2.2rem] text-primary font-black text-4xl",children:f.firstName.charAt(0)})})}),w.jsxs("section",{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/40 p-6 rounded-[2.5rem] shadow-2xl space-y-6",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-black/60 text-[10px] font-black uppercase tracking-widest mb-1",children:Z.baseSalary}),w.jsxs("h3",{className:"text-5xl font-black text-black tracking-tighter",children:["",f.baseSalary.toLocaleString()]})]}),w.jsx("span",{className:"bg-black text-white px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest",children:f.role})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"bg-black/5 p-4 rounded-3xl border border-black/5",children:[w.jsx("p",{className:"text-black/60 text-[9px] font-black uppercase tracking-widest mb-1",children:Z.advances}),w.jsxs("p",{className:"text-xl font-black text-black",children:["",ae.totalPaid.toLocaleString()]})]}),w.jsxs("div",{className:"bg-black/10 p-4 rounded-3xl border border-black/10",children:[w.jsx("p",{className:`text-[9px] font-black uppercase tracking-widest mb-1 ${ae.isFullyPaid?"text-green-800":"text-black/60"}`,children:ae.isFullyPaid?Z.paid:Z.remaining}),w.jsxs("p",{className:"text-xl font-black text-black",children:["",ae.remaining.toLocaleString()]})]})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsxs("button",{onClick:()=>E("salary"),className:"flex-1 bg-black text-white py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-all",children:[w.jsx(s1,{size:14})," ",Z.paySalary]}),w.jsxs("button",{onClick:()=>E("advance"),className:"flex-1 bg-black/10 text-black py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest border border-black/10 flex items-center justify-center gap-2 active:scale-95 transition-all",children:[w.jsx(eg,{size:14})," ",Z.giveAdvance]})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[w.jsx(m1,{size:14})," ",Z.paymentHistory]}),w.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase",children:new Date().toLocaleDateString(n==="tr"?"tr-TR":"de-DE",{month:"long"})})]}),w.jsx("div",{className:"space-y-3",children:f.payments.filter(je=>je.month===We).length===0?w.jsx("p",{className:"text-center py-6 text-white/20 text-[10px] font-black uppercase tracking-widest",children:Z.noHistory}):f.payments.filter(je=>je.month===We).map(je=>w.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5 animate-in fade-in slide-in-from-right-4",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:`p-2 rounded-xl ${je.type==="salary"?"bg-green-500/10 text-green-500":"bg-orange-500/10 text-orange-500"}`,children:je.type==="salary"?w.jsx(ZC,{size:14}):w.jsx(r1,{size:14})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-white font-bold text-xs uppercase",children:Z.type[je.type]}),w.jsx("p",{className:"text-[8px] text-white/30 font-black uppercase mt-0.5",children:je.date})]})]}),w.jsxs("p",{className:"text-sm font-black text-white tracking-tight",children:["",je.amount.toLocaleString()]})]},je.id))})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl border border-white/5",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 flex items-center gap-2",children:[w.jsx(Du,{size:12})," ",Z.personalInfo]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.dob}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.dateOfBirth})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.pob}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.placeOfBirth})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.nationality}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.nationality})]}),w.jsx("div",{className:"pt-3 mt-1 border-t border-white/5 text-white/40 text-[11px] font-medium leading-relaxed italic",children:f.address})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl border border-white/5",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 flex items-center gap-2",children:[w.jsx(nm,{size:12})," ",Z.legalInfo]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.healthIns}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.healthInsurance})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.taxId}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.taxId})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.ssn}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.socialSecurityNumber})]})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl border border-white/5",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 flex items-center gap-2",children:[w.jsx(j_,{size:12})," ",Z.bankInfo]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.bank}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.bankName})]}),w.jsx("div",{className:"text-[13px] font-mono font-black text-primary bg-white/5 p-4 rounded-2xl break-all border border-white/5 ring-1 ring-white/10 leading-relaxed tracking-wider",children:f.iban}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.bic}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.bic})]})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4 shadow-xl border border-white/5",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 flex items-center gap-2",children:[w.jsx(W_,{size:12})," ",Z.employmentInfo]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.startDate}),w.jsx("span",{className:"text-white font-bold text-sm tracking-tight",children:f.startDate})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-white/20 text-[10px] font-black uppercase",children:Z.phone}),w.jsxs("a",{href:`tel:${f.phone}`,className:"text-primary font-bold text-sm flex items-center gap-1 tracking-tight",children:[w.jsx(Nh,{size:12})," ",f.phone]})]})]})]})]}),w.jsxs("button",{onClick:async()=>{window.confirm(Z.deleteConfirm)&&(await T3(f.id),y(null))},className:"w-full bg-red-500/10 text-red-500 py-5 rounded-3xl font-black text-[10px] uppercase tracking-widest border border-red-500/20 mt-8 flex items-center justify-center gap-2 active:scale-95 transition-all",children:[w.jsx(IT,{size:14})," SCL KAYDINI KALICI OLARAK SL"]}),v&&w.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-2xl z-[60] flex items-center justify-center p-6 animate-in fade-in duration-300",children:w.jsxs("div",{className:"glass w-full max-w-sm p-10 rounded-[3.5rem] border border-white/10 space-y-8 shadow-2xl animate-in zoom-in duration-300",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h3",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:Z.addPayment}),w.jsx("p",{className:"text-primary text-[10px] font-black uppercase tracking-[0.3em] mt-2 bg-primary/10 inline-block px-4 py-1 rounded-full",children:Z.type[v]})]}),w.jsxs("div",{className:"relative",children:[w.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-white/20 font-black text-3xl",children:""}),w.jsx("input",{autoFocus:!0,type:"number",className:"w-full bg-white/5 border border-white/10 rounded-3xl py-8 pl-16 pr-6 text-5xl font-black text-white focus:outline-none focus:border-primary transition-all text-center tracking-tighter",placeholder:"0",value:S,onChange:je=>N(je.target.value)})]}),w.jsxs("div",{className:"flex flex-col gap-3",children:[w.jsx("button",{onClick:Be,className:"w-full bg-primary text-black py-5 rounded-2xl font-black text-sm uppercase tracking-widest shadow-lg shadow-primary/20 active:scale-95 transition-all",children:Z.save}),w.jsx("button",{onClick:()=>E(null),className:"w-full py-4 text-white/30 font-black text-[10px] uppercase tracking-widest hover:text-white transition-colors",children:Z.cancel})]})]})})]})}return w.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[w.jsxs("div",{className:"flex justify-between items-end mb-2",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-3xl font-black tracking-tighter text-white uppercase leading-none",children:Z.title}),w.jsxs("p",{className:"text-[10px] text-white/30 font-black uppercase tracking-[0.2em] mt-1.5",children:[Z.count,": ",e.length]})]}),w.jsx("button",{onClick:ce,className:"bg-primary p-3.5 rounded-2xl text-black shadow-lg shadow-primary/10 active:scale-90 transition-all border border-primary/20",children:w.jsx(V1,{size:24})})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(C1,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-primary transition-colors",size:18}),w.jsx("input",{type:"text",placeholder:Z.search,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4.5 pl-14 pr-6 text-white font-bold focus:outline-none focus:border-primary/50 transition-all shadow-inner",value:r,onChange:ae=>i(ae.target.value)})]}),w.jsx("div",{className:"space-y-3",children:tt.length===0?w.jsxs("div",{className:"text-center py-20 bg-white/5 rounded-[2.5rem] border border-dashed border-white/10",children:[w.jsx(ba,{className:"mx-auto text-white/10 mb-3",size:48}),w.jsx("p",{className:"text-white/20 text-[10px] font-black uppercase tracking-widest",children:"Arama sonucu bulunamad"})]}):tt.map(ae=>w.jsxs("div",{onClick:()=>y(ae),className:"glass p-5 rounded-[2.2rem] border border-white/5 flex items-center justify-between group cursor-pointer active:scale-[0.98] transition-all hover:bg-white/[0.08] shadow-lg",children:[w.jsxs("div",{className:"flex items-center gap-5",children:[w.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden border border-white/5 shadow-inner",children:ae.photo?w.jsx("img",{src:ae.photo,className:"w-full h-full object-cover",alt:"Staff"}):w.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary/20 to-transparent flex items-center justify-center text-primary font-black text-2xl",children:ae.firstName.charAt(0)})}),w.jsxs("div",{children:[w.jsxs("h3",{className:"text-white font-bold text-lg tracking-tight leading-tight",children:[ae.firstName," ",ae.lastName]}),w.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[w.jsx("span",{className:"text-[8px] bg-primary/10 text-primary px-2 py-0.5 rounded-md font-black uppercase border border-primary/10 tracking-widest",children:ae.role}),w.jsxs("span",{className:"text-[8px] text-white/30 font-bold uppercase tracking-widest",children:["",ae.baseSalary.toLocaleString()]})]})]})]}),w.jsx("div",{className:"bg-white/5 p-2.5 rounded-xl group-hover:bg-primary/20 transition-all",children:w.jsx(yT,{className:"text-white/20 group-hover:text-primary transition-colors",size:20})})]},ae.id))})]})},P3=({lang:n})=>{const[e,t]=_e.useState(!1),r={tr:{title:"Uygulamay Ykle",desc:"En iyi deneyim iin Pastillo'yu ana ekrannza ekleyin.",step1:"1. Alttaki Payla butonuna basn",step2:'2. "Ana Ekrana Ekle"yi sein'},de:{title:"App installieren",desc:"Fgen Sie Pastillo zum Home-Bildschirm hinzu fr die beste Erfahrung.",step1:"1. Tippen Sie unten auf Teilen",step2:'2. Whlen Sie "Zum Home-Bildschirm"'},en:{title:"Install App",desc:"Add Pastillo to your home screen for the best experience.",step1:"1. Tap the Share button below",step2:'2. Select "Add to Home Screen"'},es:{title:"Instalar App",desc:"Aade Pastillo a tu pantalla de inicio para la mejor experiencia.",step1:"1. Toca el botn Compartir abajo",step2:'2. Selecciona "Aadir a Inicio"'}},i=r[n]||r.de;_e.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,u=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;if(l&&!u&&!sessionStorage.getItem("installPromptClosed")){const f=setTimeout(()=>t(!0),3e3);return()=>clearTimeout(f)}},[]);const o=()=>{t(!1),sessionStorage.setItem("installPromptClosed","true")};return e?w.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-4 animate-in slide-in-from-bottom duration-500",children:w.jsxs("div",{className:"bg-[#1c1c1c]/90 backdrop-blur-md border border-white/10 rounded-2xl p-5 shadow-2xl relative max-w-md mx-auto",children:[w.jsx("button",{onClick:o,className:"absolute top-3 right-3 text-white/30 hover:text-white transition-colors",children:w.jsx(Mu,{size:20})}),w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"bg-primary rounded-xl p-3 shrink-0",children:w.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/706/706164.png",className:"w-8 h-8 invert-0",alt:"Icon"})}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-bold text-white text-base",children:i.title}),w.jsx("p",{className:"text-sm text-white/70 leading-relaxed",children:i.desc})]})]}),w.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 flex flex-col gap-2",children:[w.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/60",children:[w.jsx("span",{className:"flex items-center justify-center w-6 h-6",children:w.jsx(N1,{size:18,className:"text-primary"})}),w.jsx("span",{children:i.step1})]}),w.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/60",children:[w.jsx("span",{className:"flex items-center justify-center w-6 h-6",children:w.jsx(I1,{size:18,className:"text-primary"})}),w.jsx("span",{children:i.step2})]})]}),w.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-[#1c1c1c]/90 border-r border-b border-white/10 rotate-45 transform"})]})}):null},k3=({lang:n,settings:e})=>{const[t,r]=_e.useState(e),[i,o]=_e.useState(""),[l,u]=_e.useState("idle"),d=_e.useRef(null),[f,y]=_e.useState(!1),[v,E]=_e.useState(null),[S,N]=_e.useState(1),[M,k]=_e.useState({x:0,y:0}),[B,q]=_e.useState(!1),[H,ee]=_e.useState({x:0,y:0}),te=_e.useRef(null),j=_e.useRef(null),b={tr:{branding:"Marka & Kimlik",contact:"letiim Bilgileri",system:"Sistem Ayarlar",name:"Restoran smi",logo:"Logo Ykle",address:"Adres",phone:"Telefon",hours:"alma Saatleri",closed:"Kapal Gn",pin:"Ynetici PIN",cap:"Max Kapasite",email:"E-posta",holidays:"Tatil Gnleri",save:"AYARLARI KAYDET",add:"Ekle",saved:"KAYDEDLD",cropTitle:"Logoyu Dzenle",cropConfirm:"KIRPMAYI ONAYLA",cropHint:"Logoyu srkleyerek ve byterek hizalayn"},de:{branding:"Markenidentitt",contact:"Kontaktinformationen",system:"Systemeinstellungen",name:"Restaurant Name",logo:"Logo hochladen",address:"Adresse",phone:"Telefon",hours:"ffnungszeiten",closed:"Ruhetag",pin:"Admin PIN",cap:"Max. Kapazitt",email:"Manager E-Mail",holidays:"Ruhetage",save:"EINSTELLUNGEN SPEICHERN",add:"Hinzufgen",saved:"GESPEICHERT",cropTitle:"Logo bearbeiten",cropConfirm:"ZUSCHNITT BESTTIGEN",cropHint:"Logo ziehen und zoomen zum Ausrichten"},en:{branding:"Branding",contact:"Contact Info",system:"System Settings",name:"Restaurant Name",logo:"Upload Logo",address:"Address",phone:"Phone",hours:"Opening Hours",closed:"Closed Day",pin:"Admin PIN",cap:"Max Capacity",email:"Email",holidays:"Holidays",save:"SAVE SETTINGS",add:"Add",saved:"SAVED",cropTitle:"Edit Logo",cropConfirm:"CONFIRM CROP",cropHint:"Drag and zoom to align the logo",cancel:"Cancel"},es:{branding:"Marca",contact:"Informacin de Contacto",system:"Configuracin del Sistema",name:"Nombre del Restaurante",logo:"Subir Logo",address:"Direccin",phone:"Telfono",hours:"Horario",closed:"Da Cerrado",pin:"PIN Admin",cap:"Capacidad Mx.",email:"Correo Electrnico",holidays:"Das Festivos",save:"GUARDAR AJUSTES",add:"Aadir",saved:"GUARDADO",cropTitle:"Editar Logo",cropConfirm:"CONFIRMAR RECORTE",cropHint:"Arrastre y ample para alinear el logo",cancel:"Cancelar"}},R=b[n]||b.de,P=Z=>{const fe=Z.target.files?.[0];if(!fe)return;const Ie=new FileReader;Ie.onloadend=()=>{E(Ie.result),y(!0),N(1),k({x:0,y:0})},Ie.readAsDataURL(fe)},L=()=>{const Z=te.current,fe=j.current;if(!Z||!fe)return;const Ie=Z.getContext("2d");if(!Ie)return;const ce=300;Z.width=ce,Z.height=ce,Ie.clearRect(0,0,ce,ce);const Ce=fe.naturalWidth*S,ge=fe.naturalHeight*S,z=ce/2,ne=ce/2;Ie.drawImage(fe,z-Ce/2+M.x,ne-ge/2+M.y,Ce,ge);const ke=Z.toDataURL("image/png");r({...t,restaurantLogo:ke}),y(!1),E(null)},F=Z=>{q(!0);const fe="touches"in Z?Z.touches[0].clientX:Z.clientX,Ie="touches"in Z?Z.touches[0].clientY:Z.clientY;ee({x:fe-M.x,y:Ie-M.y})},G=Z=>{if(!B)return;const fe="touches"in Z?Z.touches[0].clientX:Z.clientX,Ie="touches"in Z?Z.touches[0].clientY:Z.clientY;k({x:fe-H.x,y:Ie-H.y})},D=()=>q(!1),Fe=async()=>{u("saving");try{await c3(t),u("saved"),navigator.vibrate&&navigator.vibrate(50),setTimeout(()=>u("idle"),2e3)}catch{u("idle"),alert("Error saving settings")}};return w.jsxs("div",{className:"space-y-6 pb-24 animate-in fade-in duration-500",children:[f&&v&&w.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-2xl flex flex-col items-center justify-center p-6 animate-in fade-in duration-300",children:[w.jsxs("div",{className:"w-full max-w-sm space-y-8",children:[w.jsxs("div",{className:"text-center space-y-2",children:[w.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:R.cropTitle}),w.jsx("p",{className:"text-[10px] text-white/30 font-black uppercase tracking-widest",children:R.cropHint})]}),w.jsxs("div",{className:"relative w-full aspect-square bg-white/5 rounded-[2.5rem] overflow-hidden border border-white/10 touch-none cursor-move",onMouseDown:F,onMouseMove:G,onMouseUp:D,onMouseLeave:D,onTouchStart:F,onTouchMove:G,onTouchEnd:D,children:[w.jsx("img",{ref:j,src:v,alt:"Crop preview",className:"absolute pointer-events-none transition-transform duration-75",style:{transform:`translate(-50%, -50%) translate(${M.x}px, ${M.y}px) scale(${S})`,top:"50%",left:"50%",maxWidth:"none"}}),w.jsx("div",{className:"absolute inset-0 border-4 border-primary/50 pointer-events-none rounded-[2.5rem] ring-[1000px] ring-black/60 shadow-[inset_0_0_100px_rgba(0,0,0,0.5)]"})]}),w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-4 bg-white/5 p-4 rounded-2xl border border-white/10",children:[w.jsx(ST,{className:"text-white/30",size:18}),w.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.01",value:S,onChange:Z=>N(parseFloat(Z.target.value)),className:"flex-1 accent-primary h-1.5 bg-white/10 rounded-full appearance-none"})]}),w.jsxs("div",{className:"flex flex-col gap-3",children:[w.jsx("button",{onClick:L,className:"w-full bg-primary text-black py-5 rounded-2xl font-black text-sm tracking-widest active:scale-95 transition-all shadow-lg shadow-primary/20",children:R.cropConfirm}),w.jsx("button",{onClick:()=>{y(!1),E(null)},className:"w-full py-3 text-white/30 font-black text-[10px] uppercase tracking-widest",children:b[n].cancel})]})]})]}),w.jsx("canvas",{ref:te,style:{display:"none"}})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-6",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-primary flex items-center gap-2",children:[w.jsx(k1,{size:14})," ",R.branding]}),w.jsxs("div",{className:"flex flex-col items-center gap-4",children:[w.jsxs("div",{onClick:()=>d.current?.click(),className:"w-28 h-28 rounded-3xl bg-white/5 border-2 border-dashed border-white/10 flex flex-col items-center justify-center cursor-pointer hover:bg-white/10 transition-all overflow-hidden relative group",children:[t.restaurantLogo?w.jsx("img",{src:t.restaurantLogo,className:"w-full h-full object-contain p-2",alt:"Logo"}):w.jsx(wT,{className:"text-white/20",size:32}),w.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:w.jsx(Zm,{size:24,className:"text-primary"})})]}),w.jsx("input",{type:"file",ref:d,hidden:!0,accept:"image/*",onChange:P}),w.jsx("p",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest",children:R.logo})]}),w.jsx("div",{className:"space-y-4",children:w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.name}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold focus:border-primary outline-none transition-all",value:t.restaurantName,onChange:Z=>r({...t,restaurantName:Z.target.value})})]})})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-primary flex items-center gap-2",children:[w.jsx(ET,{size:14})," ",R.contact]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.address}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold",value:t.address,onChange:Z=>r({...t,address:Z.target.value})})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.phone}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold",value:t.phone,onChange:Z=>r({...t,phone:Z.target.value})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.hours}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold text-xs",value:t.openingHours,onChange:Z=>r({...t,openingHours:Z.target.value})})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.closed}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold text-xs",value:t.closedDay,onChange:Z=>r({...t,closedDay:Z.target.value})})]})]})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-6",children:[w.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-primary flex items-center gap-2",children:[w.jsx(P1,{size:14})," ",R.system]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.pin}),w.jsx("input",{maxLength:4,className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 text-center text-xl font-black text-white",value:t.adminPin,onChange:Z=>r({...t,adminPin:Z.target.value})})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.cap}),w.jsx("input",{type:"number",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 text-center text-xl font-black text-white",value:t.maxCapacityPerSlot,onChange:Z=>r({...t,maxCapacityPerSlot:parseInt(Z.target.value)||0})})]})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("label",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest ml-2",children:R.email}),w.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-5 text-white font-bold",value:t.managerEmail,onChange:Z=>r({...t,managerEmail:Z.target.value})})]})]}),w.jsxs("section",{className:"glass p-6 rounded-[2.5rem] space-y-4",children:[w.jsxs("div",{className:"flex items-center gap-3 text-primary",children:[w.jsx(bu,{size:20}),w.jsx("h3",{className:"font-black text-[10px] uppercase tracking-widest",children:R.holidays})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"date",className:"flex-1 bg-white/5 border border-white/10 rounded-xl px-4 text-white [color-scheme:dark] h-12",value:i,onChange:Z=>o(Z.target.value)}),w.jsx("button",{onClick:()=>{i&&(r({...t,holidays:[...t.holidays,i].sort()}),o(""))},className:"bg-primary text-black px-6 rounded-xl font-black active:scale-95 transition-all text-[10px] uppercase tracking-widest",children:R.add})]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:t.holidays.map(Z=>w.jsxs("div",{className:"bg-white/10 px-3 py-2 rounded-xl flex items-center gap-2 text-[9px] font-black border border-white/5",children:[new Date(Z).toLocaleDateString(n==="tr"?"tr-TR":"de-DE"),w.jsx("button",{onClick:()=>r({...t,holidays:t.holidays.filter(fe=>fe!==Z)}),className:"text-red-500 p-1",children:w.jsx(Mu,{size:14})})]},Z))})]}),w.jsxs("button",{onClick:Fe,disabled:l!=="idle",className:`w-full py-6 rounded-3xl font-black text-lg shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 ${l==="saved"?"bg-green-500 text-white":"bg-primary text-black"}`,children:[l==="saving"&&w.jsx(wu,{size:24,className:"animate-spin"}),l==="saved"&&w.jsx(o1,{size:24}),l==="saved"?R.saved:R.save]})]})},b3=({lang:n,settings:e})=>{const t={tr:{title:"letiim & Bilgi",sub:"Bize ulan",address:"Adres",hours:"Al Saatleri",social:"Sosyal Medya",web:"Web Sitemiz",contact:"Hzl letiim",call:"Telefon"},de:{title:"Kontakt & Infos",sub:"Sprechen Sie uns an",address:"Adresse",hours:"ffnungszeiten",social:"Social Media",web:"Webseite",contact:"Direktkontakt",call:"Anrufen"},en:{title:"Contact & Info",sub:"Get in touch",address:"Address",hours:"Opening Hours",social:"Social Media",web:"Website",contact:"Quick Contact",call:"Call Us"},es:{title:"Contacto e Info",sub:"Contctenos",address:"Direccin",hours:"Horario",social:"Redes Sociales",web:"Sitio Web",contact:"Contacto Rpido",call:"Llamar"}},r=t[n]||t.de,i=[{label:"Instagram",value:"@Pastillo_butzbach",icon:w.jsx(g1,{size:18}),url:"https://instagram.com/Pastillo_butzbach",color:"text-pink-500"},{label:"Facebook",value:"Pastillo Butzbach",icon:w.jsx(c1,{size:18}),url:"https://facebook.com/profile.php?id=100086382436854",color:"text-blue-500"},{label:r.web,value:"www.pastillo.de",icon:w.jsx(p1,{size:18}),url:"https://www.pastillo.de",color:"text-primary"}];return w.jsxs("div",{className:"flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-4 duration-700 pb-20 px-1",children:[w.jsxs("div",{className:"text-center space-y-2 mb-2",children:[e.restaurantLogo&&w.jsx("img",{src:e.restaurantLogo,className:"h-10 w-auto mx-auto mb-4 opacity-80",alt:"Logo"}),w.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter",children:e.restaurantName||r.title}),w.jsxs("div",{className:"flex items-center justify-center gap-2",children:[w.jsx("span",{className:"h-[1px] w-8 bg-white/10"}),w.jsx("p",{className:"text-[10px] text-white/30 font-black uppercase tracking-[0.3em]",children:r.sub}),w.jsx("span",{className:"h-[1px] w-8 bg-white/10"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[w.jsxs("div",{className:"glass p-5 rounded-[2rem] border border-white/5 space-y-5",children:[w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"p-2.5 bg-white/5 rounded-xl text-primary",children:w.jsx(ET,{size:20})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-[10px] font-black text-white/20 uppercase tracking-widest",children:r.address}),w.jsx("p",{className:"text-sm font-bold text-white/80 mt-1 leading-snug",children:e.address}),w.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.address)}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-[10px] font-black text-primary uppercase tracking-widest mt-2 hover:opacity-70 transition-opacity",children:["Maps ",w.jsx(u1,{size:10})]})]})]}),w.jsx("div",{className:"h-[1px] bg-white/5 w-full"}),w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"p-2.5 bg-white/5 rounded-xl text-primary",children:w.jsx(vT,{size:20})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-[10px] font-black text-white/20 uppercase tracking-widest",children:r.hours}),w.jsx("p",{className:"text-sm font-bold text-white/80 mt-1",children:e.openingHours}),w.jsx("p",{className:"text-[11px] font-bold text-red-500/60 mt-0.5",children:e.closedDay})]})]})]}),w.jsxs("div",{className:"glass p-5 rounded-[2rem] border border-white/5",children:[w.jsx("h3",{className:"text-[10px] font-black text-white/20 uppercase tracking-widest mb-4 ml-1",children:r.contact}),w.jsxs("a",{href:`tel:${e.phone}`,className:"flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5 hover:bg-white/10 active:scale-[0.98] transition-all",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"p-2 bg-primary/10 rounded-lg text-primary",children:w.jsx(Nh,{size:16})}),w.jsx("span",{className:"text-xs font-bold text-white/70",children:r.call})]}),w.jsx("span",{className:"text-sm font-black text-white tracking-tight",children:e.phone})]})]}),w.jsxs("div",{className:"glass p-5 rounded-[2rem] border border-white/5 space-y-2",children:[w.jsx("h3",{className:"text-[10px] font-black text-white/20 uppercase tracking-widest mb-3 ml-1",children:r.social}),i.map((o,l)=>w.jsxs("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3.5 bg-white/[0.02] hover:bg-white/5 rounded-2xl border border-white/5 transition-all group",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:`p-2 rounded-xl bg-white/5 ${o.color} transition-transform group-hover:scale-110`,children:o.icon}),w.jsxs("div",{children:[w.jsx("p",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest",children:o.label}),w.jsx("p",{className:"text-xs font-bold text-white/70",children:o.value})]})]}),w.jsx(yT,{size:14,className:"text-white/10 group-hover:text-primary transition-colors"})]},l))]})]}),w.jsx("p",{className:"text-center text-[8px] font-black text-white/10 uppercase tracking-[0.5em] mt-4",children:" Pastillo Butzbach"})]})},D3=()=>{const[n,e]=_e.useState("none"),[t,r]=_e.useState("overview"),[i,o]=_e.useState("public"),[l,u]=_e.useState("de"),[d,f]=_e.useState([]),[y,v]=_e.useState([]),[E,S]=_e.useState([]),[N,M]=_e.useState([]),[k,B]=_e.useState({restaurantName:"Pastillo Butzbach",address:"Marktplatz 23, 35510 Butzbach",phone:"06033 974 7771",openingHours:"Her gn: 11:00 - 23:00",closedDay:"Sal: Kapal",adminPin:"0000",maxCapacityPerSlot:20,holidays:[],managerEmail:"info@pastillo.de"});_e.useEffect(()=>{const j=h3(f),b=u3(B),R=g3(v),P=v3(S),L=_3(M);return()=>{j(),b(),R(),P(),L()}},[]);const q={tr:{ovw:"PANEL",res:"REZERVASYON",fin:"FNANS",staff:"PERSONEL",set:"AYARLAR",adminTitle:"YNETM ST",staffTitle:"PERSONEL PANEL",titleMap:{overview:"GENEL BAKI",reservations:"REZERVASYONLAR",finance:"FNANSAL DURUM",personnel:"EKP YNETM",settings:"SSTEM AYARLARI"}},de:{ovw:"BERSICHT",res:"BUCHUNG",fin:"FINANZEN",staff:"PERSONAL",set:"EINSTELL.",adminTitle:"MANAGEMENT SUITE",staffTitle:"PERSONALPANEEL",titleMap:{overview:"BERSICHT",reservations:"BUCHUNGEN",finance:"FINANZEN",personnel:"PERSONAL",settings:"EINSTELLUNGEN"}},en:{ovw:"DASHBOARD",res:"BOOKING",fin:"FINANCE",staff:"STAFF",set:"SETTINGS",adminTitle:"MANAGEMENT SUITE",staffTitle:"STAFF PANEL",titleMap:{overview:"OVERVIEW",reservations:"RESERVATIONS",finance:"FINANCIALS",personnel:"PERSONNEL",settings:"SETTINGS"}},es:{ovw:"PANEL",res:"RESERVA",fin:"FINANZAS",staff:"PERSONAL",set:"AJUSTES",adminTitle:"SUITE DE GESTIN",staffTitle:"PANEL DE PERSONAL",titleMap:{overview:"RESUMEN",reservations:"RESERVAS",finance:"FINANZAS",personnel:"PERSONAL",settings:"AJUSTES"}}},H=q[l]||q.de,ee=()=>i==="public"?"TISCHRESERVIERUNG":n==="staff"?H.staffTitle||"STAFF":H.titleMap&&H.titleMap[t]||H.adminTitle||"ADMIN",te=j=>{e(j),r(j==="admin"?"overview":"reservations")};return i==="admin"&&n==="none"?w.jsx(L1,{onLogin:te,onCancel:()=>o("public"),lang:l,settings:k}):w.jsxs("div",{className:"min-h-screen bg-[#0a0a0a] text-white font-sans pb-32 overflow-x-hidden",children:[w.jsx(P3,{lang:l}),w.jsx("header",{className:"sticky top-0 z-40 px-6 py-6 border-b border-white/5 bg-[#0a0a0a]/90 backdrop-blur-2xl",children:w.jsxs("div",{className:"flex justify-between items-center max-w-7xl mx-auto",children:[w.jsx("div",{className:"flex items-center gap-3",children:w.jsx("h1",{className:"text-xl font-black tracking-tighter uppercase text-primary",children:ee()})}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"hidden sm:flex bg-white/5 rounded-xl p-1 border border-white/10 mr-2",children:["tr","de","en"].map(j=>w.jsx("button",{onClick:()=>u(j),className:`px-2 py-1 rounded-lg text-[9px] font-black uppercase transition-all ${l===j?"bg-primary text-black":"text-white/30"}`,children:j},j))}),i==="public"?w.jsx("button",{onClick:()=>o("admin"),className:"p-2.5 bg-white/5 border border-white/10 rounded-xl text-primary active:scale-90 transition-all",children:w.jsx(M1,{size:20})}):w.jsx("button",{onClick:()=>{e("none"),o("public")},className:"p-2.5 bg-red-500/10 border border-red-500/20 rounded-xl text-red-500 active:scale-90 transition-all",children:w.jsx(w1,{size:20})})]})]})}),w.jsx("main",{className:`mx-auto p-5 animate-in fade-in duration-700 ${i==="admin"&&n==="admin"?"max-w-7xl":"max-w-md"}`,children:i==="public"?w.jsxs("div",{className:"space-y-12",children:[w.jsx(R3,{lang:l,isLoading:!1,onSubmit:async j=>{await d3({...j,status:"confirmed"}),alert(l==="tr"?"Rezervasyonunuz alnd!":l==="en"?"Reservation received!":"Reservierung erfolgreich!")},existingReservations:d,settings:k}),w.jsx(b3,{lang:l,settings:k})]}):w.jsxs("div",{className:"space-y-6",children:[t==="overview"&&n==="admin"&&w.jsx(C3,{lang:l,reservations:d,turnovers:y,expenses:E,personnel:N,settings:k}),t==="reservations"&&w.jsx(A3,{lang:l,reservations:d,onDelete:p3,onStatusUpdate:f3}),n==="admin"&&w.jsxs(w.Fragment,{children:[t==="finance"&&w.jsx(S3,{lang:l,turnovers:y,expenses:E}),t==="personnel"&&w.jsx(N3,{lang:l,staff:N,settings:k}),t==="settings"&&w.jsx(k3,{lang:l,settings:k})]})]})}),i==="admin"&&(n==="admin"||n==="staff")&&w.jsx("nav",{className:"fixed bottom-8 left-6 right-6 z-50 max-w-xl mx-auto",children:w.jsxs("div",{className:"glass bg-[#161616]/95 p-2 rounded-[2.5rem] shadow-2xl flex justify-between items-center border border-white/10",children:[w.jsxs("button",{onClick:()=>r("overview"),className:`flex-1 flex flex-col items-center gap-1 py-3.5 rounded-[2.2rem] transition-all ${t==="overview"||n==="staff"&&t==="reservations"?"bg-primary text-black":"text-white/30"}`,children:[w.jsx(v1,{size:18}),w.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:H.ovw})]}),w.jsxs("button",{onClick:()=>r("reservations"),className:`flex-1 flex flex-col items-center gap-1 py-3.5 rounded-[2.2rem] transition-all ${t==="reservations"?"bg-primary text-black":"text-white/30"}`,children:[w.jsx(bu,{size:18}),w.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:H.res})]}),n==="admin"&&w.jsxs(w.Fragment,{children:[w.jsxs("button",{onClick:()=>r("finance"),className:`flex-1 flex flex-col items-center gap-1 py-3.5 rounded-[2.2rem] transition-all ${t==="finance"?"bg-primary text-black":"text-white/30"}`,children:[w.jsx(th,{size:18}),w.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:H.fin})]}),w.jsxs("button",{onClick:()=>r("personnel"),className:`flex-1 flex flex-col items-center gap-1 py-3.5 rounded-[2.2rem] transition-all ${t==="personnel"?"bg-primary text-black":"text-white/30"}`,children:[w.jsx(ba,{size:18}),w.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:H.staff})]}),w.jsxs("button",{onClick:()=>r("settings"),className:`flex-1 flex flex-col items-center gap-1 py-3.5 rounded-[2.2rem] transition-all ${t==="settings"?"bg-primary text-black":"text-white/30"}`,children:[w.jsx(R1,{size:18}),w.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:H.set})]})]})]})}),i==="admin"&&n==="staff"&&w.jsx("div",{className:"fixed bottom-10 left-0 right-0 text-center animate-in fade-in duration-1000",children:w.jsx("p",{className:"text-[9px] font-black text-white/10 uppercase tracking-[0.4em]",children:"Limited Access Mode"})})]})},bA=document.getElementById("root");if(!bA)throw new Error("Could not find root element to mount to");const M3=jC.createRoot(bA);M3.render(w.jsx(gT.StrictMode,{children:w.jsx(D3,{})}));
